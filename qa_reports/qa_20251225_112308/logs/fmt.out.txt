Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\api\src\lib.rs:39:
             CoreError::Parse(msg) => ApiError::InvalidInput(msg),
             CoreError::Io(msg) => ApiError::CalculationError(format!("IO error: {}", msg)),
             CoreError::Config(msg) => ApiError::CalculationError(format!("Config error: {}", msg)),
[31m-            CoreError::DatabaseError(msg) => ApiError::CalculationError(format!("Database error: {}", msg)),
[0m[32m+            CoreError::DatabaseError(msg) => {
[0m[32m+                ApiError::CalculationError(format!("Database error: {}", msg))
[0m[32m+            }
[0m         }
     }
 }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\api\src\lib.rs:84:
     pub description: String,
     pub category: String,
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\abv.rs:1:
 // ABV calculator from original and final gravity.
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\abv.rs:79:
 }
 
 register_calculator!(AbvCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acerglyn.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 use std::str::FromStr;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acerglyn.rs:29:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
[31m-        let maple_percent = input.get_param("maple_percent")
[0m[32m+        let maple_percent = input
[0m[32m+            .get_param("maple_percent")
[0m             .ok_or_else(|| Error::MissingInput("maple_percent required".into()))?;
 
[31m-        let vol: Decimal = Decimal::from_str(volume)
[0m[31m-            .map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[31m-        let abv: Decimal = Decimal::from_str(target_abv)
[0m[31m-            .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m[32m+        let vol: Decimal =
[0m[32m+            Decimal::from_str(volume).map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[32m+        let abv: Decimal =
[0m[32m+            Decimal::from_str(target_abv).map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m         let maple_pct: Decimal = Decimal::from_str(maple_percent)
             .map_err(|_| Error::Parse("Invalid maple_percent".into()))?;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acerglyn.rs:61:
 }
 
 register_calculator!(AcerglynCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acid_addition.rs:2:
 //! Different acids have different strengths - MUST account for this
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acid_addition.rs:32:
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
         let ph_meas = input.get_measurement(Unit::Ph)?;
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required (in liters)".into()))?;
[31m-        let target_ph = input.get_param("target_ph")
[0m[32m+        let target_ph = input
[0m[32m+            .get_param("target_ph")
[0m             .ok_or_else(|| Error::MissingInput("target_ph required".into()))?;
         let acid_type = input.get_param("acid_type").unwrap_or("tartaric");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acid_addition.rs:41:
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
         let curr_ph = ph_meas.value;
[31m-        let targ_ph: Decimal = target_ph.parse()
[0m[32m+        let targ_ph: Decimal = target_ph
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target_ph".into()))?;
 
         if targ_ph >= curr_ph {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acid_addition.rs:48:
[31m-            return Err(Error::Validation("Target pH must be lower than current pH (acid lowers pH)".into()));
[0m[32m+            return Err(Error::Validation(
[0m[32m+                "Target pH must be lower than current pH (acid lowers pH)".into(),
[0m[32m+            ));
[0m         }
 
         let ph_diff = curr_ph - targ_ph;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acid_addition.rs:53:
         // FIXED: Correct strength factors (g/L per 1.0 pH drop)
         // These are the factors that produce the correct gram amounts
         let acid_strength_factor = match acid_type {
[31m-            "tartaric" => Decimal::new(15, 1),   // 1.5 g/L per 1.0 pH (strongest)
[0m[31m-            "citric" => Decimal::new(17, 1),     // 1.7 g/L per 1.0 pH
[0m[31m-            "malic" => Decimal::new(19, 1),      // 1.9 g/L per 1.0 pH
[0m[31m-            "lactic" => Decimal::new(22, 1),     // 2.2 g/L per 1.0 pH (weakest)
[0m[31m-            _ => Decimal::new(15, 1),            // default to tartaric
[0m[32m+            "tartaric" => Decimal::new(15, 1), // 1.5 g/L per 1.0 pH (strongest)
[0m[32m+            "citric" => Decimal::new(17, 1),   // 1.7 g/L per 1.0 pH
[0m[32m+            "malic" => Decimal::new(19, 1),    // 1.9 g/L per 1.0 pH
[0m[32m+            "lactic" => Decimal::new(22, 1),   // 2.2 g/L per 1.0 pH (weakest)
[0m[32m+            _ => Decimal::new(15, 1),          // default to tartaric
[0m         };
 
         // Acid needed (g) = volume (L) ├ù pH_diff ├ù strength_factor
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acid_addition.rs:77:
         let mut result = CalcResult::new(Measurement::new(acid_needed_g, Unit::Grams));
 
         if ph_diff > Decimal::new(5, 1) {
[31m-            result = result.with_warning("Large pH drop (>0.5) - add in stages and taste between additions");
[0m[32m+            result = result
[0m[32m+                .with_warning("Large pH drop (>0.5) - add in stages and taste between additions");
[0m         }
 
         if ph_diff > Decimal::ONE {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acid_addition.rs:84:
[31m-            result = result.with_warning("Very large pH drop (>1.0) - MUST add in multiple stages over days");
[0m[32m+            result = result
[0m[32m+                .with_warning("Very large pH drop (>1.0) - MUST add in multiple stages over days");
[0m         }
 
         if targ_ph < Decimal::new(30, 1) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acid_addition.rs:88:
             result = result.with_warning("Target pH <3.0 - will taste very tart/sour");
         }
 
[31m-        result = result.with_warning("Always add acid gradually - easy to add, impossible to remove");
[0m[32m+        result =
[0m[32m+            result.with_warning("Always add acid gradually - easy to add, impossible to remove");
[0m 
         result = result
             .with_meta("acid_type", acid_name)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acid_addition.rs:97:
             .with_meta("current_ph", format!("{:.2}", curr_ph))
             .with_meta("target_ph", format!("{:.2}", targ_ph))
             .with_meta("ph_change", format!("{:.2}", ph_diff))
[31m-            .with_meta("strength_factor", format!("{:.2} g/L per pH unit", acid_strength_factor))
[0m[32m+            .with_meta(
[0m[32m+                "strength_factor",
[0m[32m+                format!("{:.2} g/L per pH unit", acid_strength_factor),
[0m[32m+            )
[0m             .with_meta("volume_liters", format!("{:.2} L", vol));
 
         Ok(result)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\acid_addition.rs:116:
 }
 
 register_calculator!(AcidAdditionCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:37:
             "ec-1118" | "ec1118" => (
                 Decimal::from(18),
                 "15-30┬░C",
[31m-                "Champagne yeast, very clean, high tolerance"
[0m[32m+                "Champagne yeast, very clean, high tolerance",
[0m             ),
             "k1-v1116" | "k1v1116" => (
                 Decimal::from(18),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:44:
                 "15-30┬░C",
[31m-                "Strong fermenter, good for meads"
[0m[32m+                "Strong fermenter, good for meads",
[0m             ),
             "71b-1122" | "71b1122" => (
                 Decimal::from(14),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:49:
                 "15-30┬░C",
[31m-                "Fruity, softens acid, good for melomels"
[0m[32m+                "Fruity, softens acid, good for melomels",
[0m             ),
             "d47" => (
                 Decimal::from(15),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:54:
                 "15-20┬░C",
[31m-                "Tropical fruit notes, temperature sensitive"
[0m[32m+                "Tropical fruit notes, temperature sensitive",
[0m             ),
[31m-            "us-05" | "us05" => (
[0m[31m-                Decimal::from(12),
[0m[31m-                "15-24┬░C",
[0m[31m-                "Clean American ale, neutral"
[0m[31m-            ),
[0m[31m-            "s-04" | "s04" => (
[0m[31m-                Decimal::from(11),
[0m[31m-                "15-24┬░C",
[0m[31m-                "English ale, slightly fruity"
[0m[31m-            ),
[0m[31m-            "wy3068" | "wyeast3068" => (
[0m[31m-                Decimal::from(10),
[0m[31m-                "18-24┬░C",
[0m[31m-                "Hefeweizen, banana and clove"
[0m[31m-            ),
[0m[31m-            "safale_be-134" => (
[0m[31m-                Decimal::from(11),
[0m[31m-                "18-28┬░C",
[0m[31m-                "Belgian Saison, peppery"
[0m[31m-            ),
[0m[32m+            "us-05" | "us05" => (Decimal::from(12), "15-24┬░C", "Clean American ale, neutral"),
[0m[32m+            "s-04" | "s04" => (Decimal::from(11), "15-24┬░C", "English ale, slightly fruity"),
[0m[32m+            "wy3068" | "wyeast3068" => {
[0m[32m+                (Decimal::from(10), "18-24┬░C", "Hefeweizen, banana and clove")
[0m[32m+            }
[0m[32m+            "safale_be-134" => (Decimal::from(11), "18-28┬░C", "Belgian Saison, peppery"),
[0m             "qa23" => (
                 Decimal::from(16),
                 "15-30┬░C",
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:80:
[31m-                "Portuguese wine yeast, neutral"
[0m[32m+                "Portuguese wine yeast, neutral",
[0m             ),
             "dv10" => (
                 Decimal::from(16),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:84:
                 "10-35┬░C",
[31m-                "Wide temperature range, champagne-like"
[0m[32m+                "Wide temperature range, champagne-like",
[0m             ),
[31m-            _ => (
[0m[31m-                Decimal::from(12),
[0m[31m-                "18-24┬░C",
[0m[31m-                "Generic strain (estimate)"
[0m[31m-            ),
[0m[32m+            _ => (Decimal::from(12), "18-24┬░C", "Generic strain (estimate)"),
[0m         };
 
         let mut result = CalcResult::new(Measurement::new(tolerance, Unit::Abv));
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:95:
 
         if tolerance < Decimal::from(12) {
[31m-            result = result.with_warning("Low tolerance strain - not suitable for high-gravity brews");
[0m[32m+            result =
[0m[32m+                result.with_warning("Low tolerance strain - not suitable for high-gravity brews");
[0m         }
 
         result = result
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:105:
 
         // If OG provided, calculate estimated FG
         if let Some(og_str) = input.get_param("og") {
[31m-            let og: Decimal = og_str.parse().map_err(|_| Error::Parse("Invalid OG".into()))?;
[0m[32m+            let og: Decimal = og_str
[0m[32m+                .parse()
[0m[32m+                .map_err(|_| Error::Parse("Invalid OG".into()))?;
[0m 
             // Formula: ABV = (OG - FG) ├ù 131.25
             // Rearranging: FG = OG - (ABV / 131.25)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:114:
             result = result
                 .with_meta("original_gravity", format!("{:.3}", og))
                 .with_meta("estimated_fg", format!("{:.3}", estimated_fg))
[31m-                .with_meta("calculation", format!("FG = {:.3} - ({} / 131.25) = {:.3}", og, tolerance, estimated_fg));
[0m[32m+                .with_meta(
[0m[32m+                    "calculation",
[0m[32m+                    format!(
[0m[32m+                        "FG = {:.3} - ({} / 131.25) = {:.3}",
[0m[32m+                        og, tolerance, estimated_fg
[0m[32m+                    ),
[0m[32m+                );
[0m         }
 
[31m-        result = result.with_meta("tip", "Actual tolerance varies with nutrition and fermentation conditions");
[0m[32m+        result = result.with_meta(
[0m[32m+            "tip",
[0m[32m+            "Actual tolerance varies with nutrition and fermentation conditions",
[0m[32m+        );
[0m 
         Ok(result)
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\alcohol_tolerance.rs:131:
 }
 
 register_calculator!(AlcoholToleranceCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\attenuation.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\attenuation.rs:44:
 
         // Apparent Attenuation (AA%)
         // AA% = (OG - FG) / (OG - 1.000) ├ù 100
[31m-        let apparent_attenuation = ((og_val - fg_val) / (og_val - Decimal::ONE)) * Decimal::from(100);
[0m[32m+        let apparent_attenuation =
[0m[32m+            ((og_val - fg_val) / (og_val - Decimal::ONE)) * Decimal::from(100);
[0m 
         // Convert SG to Plato (rough approximation)
         // P Γëê 250 ├ù SG - 250
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\attenuation.rs:51:
[31m-        let p0 = (og_val - Decimal::ONE) * Decimal::from(250);  // Original extract (┬░P)
[0m[31m-        let pf = (fg_val - Decimal::ONE) * Decimal::from(250);  // Apparent extract (┬░P)
[0m[32m+        let p0 = (og_val - Decimal::ONE) * Decimal::from(250); // Original extract (┬░P)
[0m[32m+        let pf = (fg_val - Decimal::ONE) * Decimal::from(250); // Apparent extract (┬░P)
[0m 
         // Real Extract (RE, ┬░P) - ASBC formula
         // RE = 0.1808 ├ù P_0 + 0.8192 ├ù P_f
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\attenuation.rs:66:
         let mut result = CalcResult::new(Measurement::new(apparent_attenuation, Unit::Percent));
 
         if apparent_attenuation < Decimal::from(65) {
[31m-            result = result.with_warning("Low attenuation (<65%) - may be under-attenuated or stuck");
[0m[32m+            result =
[0m[32m+                result.with_warning("Low attenuation (<65%) - may be under-attenuated or stuck");
[0m         }
 
         if apparent_attenuation > Decimal::from(85) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\attenuation.rs:74:
         }
 
         result = result
[31m-            .with_meta("apparent_attenuation", format!("{:.1}%", apparent_attenuation))
[0m[32m+            .with_meta(
[0m[32m+                "apparent_attenuation",
[0m[32m+                format!("{:.1}%", apparent_attenuation),
[0m[32m+            )
[0m             .with_meta("real_attenuation", format!("{:.1}%", real_attenuation))
             .with_meta("real_extract", format!("{:.2}┬░P", re))
             .with_meta("original_extract", format!("{:.2}┬░P", p0))
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\attenuation.rs:97:
 }
 
 register_calculator!(AttenuationCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\backsweetening.rs:2:
 //! UNIT-AGNOSTIC metadata, all units handled in GUI layer
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\backsweetening.rs:32:
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
         let sg_meas = input.get_measurement(Unit::SpecificGravity)?;
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required (in liters)".into()))?;
[31m-        let target_sg = input.get_param("target_sg")
[0m[32m+        let target_sg = input
[0m[32m+            .get_param("target_sg")
[0m             .ok_or_else(|| Error::MissingInput("target_sg required".into()))?;
         let sweetener_type = input.get_param("sweetener").unwrap_or("honey");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\backsweetening.rs:41:
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
         let curr_sg = sg_meas.value;
[31m-        let targ_sg: Decimal = target_sg.parse()
[0m[32m+        let targ_sg: Decimal = target_sg
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target_sg".into()))?;
 
         if targ_sg <= curr_sg {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\backsweetening.rs:48:
[31m-            return Err(Error::Validation("Target SG must be higher than current SG".into()));
[0m[32m+            return Err(Error::Validation(
[0m[32m+                "Target SG must be higher than current SG".into(),
[0m[32m+            ));
[0m         }
 
         let sg_diff = targ_sg - curr_sg;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\backsweetening.rs:52:
 
         // Sugar content by sweetener type
         let sugar_content = match sweetener_type {
[31m-            "honey" => Decimal::new(82, 2),           // 0.82
[0m[31m-            "table_sugar" => Decimal::ONE,             // 1.00
[0m[31m-            "agave" => Decimal::new(76, 2),           // 0.76
[0m[31m-            "maple_syrup" => Decimal::new(67, 2),     // 0.67
[0m[31m-            _ => Decimal::new(82, 2),                 // default to honey
[0m[32m+            "honey" => Decimal::new(82, 2),       // 0.82
[0m[32m+            "table_sugar" => Decimal::ONE,        // 1.00
[0m[32m+            "agave" => Decimal::new(76, 2),       // 0.76
[0m[32m+            "maple_syrup" => Decimal::new(67, 2), // 0.67
[0m[32m+            _ => Decimal::new(82, 2),             // default to honey
[0m         };
 
         // Density of sweetener (kg/L)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\backsweetening.rs:63:
         let sweetener_density = match sweetener_type {
[31m-            "honey" => Decimal::new(142, 2),          // 1.42 kg/L
[0m[31m-            "table_sugar" => Decimal::new(159, 2),    // 1.59 kg/L (granulated)
[0m[31m-            "agave" => Decimal::new(138, 2),          // 1.38 kg/L
[0m[31m-            "maple_syrup" => Decimal::new(132, 2),    // 1.32 kg/L
[0m[32m+            "honey" => Decimal::new(142, 2),       // 1.42 kg/L
[0m[32m+            "table_sugar" => Decimal::new(159, 2), // 1.59 kg/L (granulated)
[0m[32m+            "agave" => Decimal::new(138, 2),       // 1.38 kg/L
[0m[32m+            "maple_syrup" => Decimal::new(132, 2), // 1.32 kg/L
[0m             _ => Decimal::new(142, 2),
         };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\backsweetening.rs:71:
         // Gravity points per kg per liter
[31m-        let points_per_kg_per_L = Decimal::from(383);  // For pure sugar
[0m[32m+        let points_per_kg_per_L = Decimal::from(383); // For pure sugar
[0m         let adjusted_points = points_per_kg_per_L * sugar_content;
 
         // Concentration needed: (kg/L) = gravity_points / points_per_kg_per_L
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\backsweetening.rs:88:
         let mut result = CalcResult::new(Measurement::new(sweetener_needed_g, Unit::Grams));
 
         if sg_diff > Decimal::new(40, 3) {
[31m-            result = result.with_warning("Large gravity increase (>0.040) - consider backsweetening in stages");
[0m[32m+            result = result.with_warning(
[0m[32m+                "Large gravity increase (>0.040) - consider backsweetening in stages",
[0m[32m+            );
[0m         }
 
         if sg_diff > Decimal::new(80, 3) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\backsweetening.rs:95:
[31m-            result = result.with_warning("Very large gravity increase (>0.080) - MUST backsweeten in stages");
[0m[32m+            result = result
[0m[32m+                .with_warning("Very large gravity increase (>0.080) - MUST backsweeten in stages");
[0m         }
 
[31m-        result = result.with_warning("CRITICAL: Stabilize with K-meta + K-sorbate BEFORE backsweetening");
[0m[32m+        result = result
[0m[32m+            .with_warning("CRITICAL: Stabilize with K-meta + K-sorbate BEFORE backsweetening");
[0m 
         // UNIT-AGNOSTIC METADATA - no hardcoded units
         result = result
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\backsweetening.rs:127:
 }
 
 register_calculator!(BacksweeteningCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\batch_cost.rs:1:
 //! Batch cost calculator for ingredient costing
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\batch_cost.rs:42:
         let yeast_cost: Decimal = yeast.parse().unwrap_or(Decimal::ZERO);
         let nutrients_cost: Decimal = nutrients.parse().unwrap_or(Decimal::ZERO);
         let other_cost: Decimal = other.parse().unwrap_or(Decimal::ZERO);
[31m-        let bottle_count: Decimal = bottles.parse()
[0m[32m+        let bottle_count: Decimal = bottles
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid bottle count".into()))?;
 
         if bottle_count <= Decimal::ZERO {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\batch_cost.rs:78:
 }
 
 register_calculator!(BatchCostCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bench_trials.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bench_trials.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let trial_volume = input.get_param("trial_volume")
[0m[32m+        let trial_volume = input
[0m[32m+            .get_param("trial_volume")
[0m             .ok_or_else(|| Error::MissingInput("trial_volume required".into()))?;
[31m-        let trial_addition = input.get_param("trial_addition")
[0m[32m+        let trial_addition = input
[0m[32m+            .get_param("trial_addition")
[0m             .ok_or_else(|| Error::MissingInput("trial_addition required".into()))?;
[31m-        let batch_volume = input.get_param("batch_volume")
[0m[32m+        let batch_volume = input
[0m[32m+            .get_param("batch_volume")
[0m             .ok_or_else(|| Error::MissingInput("batch_volume required".into()))?;
 
[31m-        let trial_vol: Decimal = trial_volume.parse()
[0m[32m+        let trial_vol: Decimal = trial_volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid trial_volume".into()))?;
[31m-        let trial_add: Decimal = trial_addition.parse()
[0m[32m+        let trial_add: Decimal = trial_addition
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid trial_addition".into()))?;
[31m-        let batch_vol: Decimal = batch_volume.parse()
[0m[32m+        let batch_vol: Decimal = batch_volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid batch_volume".into()))?;
 
         if trial_vol <= Decimal::ZERO || batch_vol <= Decimal::ZERO {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bench_trials.rs:62:
             .with_meta("trial_addition_g", format!("{:.2} g", trial_add))
             .with_meta("dosage_rate", format!("{:.3} g/mL", dosage_rate))
             .with_meta("batch_volume_L", format!("{} L", batch_vol))
[31m-            .with_meta("batch_addition_g", format!("{:.1} g ({:.2} kg)", batch_addition, batch_addition / Decimal::from(1000)))
[0m[32m+            .with_meta(
[0m[32m+                "batch_addition_g",
[0m[32m+                format!(
[0m[32m+                    "{:.1} g ({:.2} kg)",
[0m[32m+                    batch_addition,
[0m[32m+                    batch_addition / Decimal::from(1000)
[0m[32m+                ),
[0m[32m+            )
[0m             .with_meta("scale_factor", format!("{}x", scale_factor));
 
         if scale_factor > Decimal::from(100) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bench_trials.rs:69:
[31m-            result = result.with_warning("Large scale factor - consider intermediate trials to verify dosage");
[0m[32m+            result = result
[0m[32m+                .with_warning("Large scale factor - consider intermediate trials to verify dosage");
[0m         }
 
         if trial_vol < Decimal::from(50) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bench_trials.rs:73:
[31m-            result = result.with_warning("Very small trial volume - measurement errors will be amplified");
[0m[32m+            result = result
[0m[32m+                .with_warning("Very small trial volume - measurement errors will be amplified");
[0m         }
 
         Ok(result)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bench_trials.rs:78:
 }
 
 register_calculator!(BenchTrialsCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\blending.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\blending.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let vol1 = input.get_param("volume1").ok_or_else(|| Error::MissingInput("volume1 required".into()))?;
[0m[31m-        let abv1 = input.get_param("abv1").ok_or_else(|| Error::MissingInput("abv1 required".into()))?;
[0m[31m-        let vol2 = input.get_param("volume2").ok_or_else(|| Error::MissingInput("volume2 required".into()))?;
[0m[31m-        let abv2 = input.get_param("abv2").ok_or_else(|| Error::MissingInput("abv2 required".into()))?;
[0m[32m+        let vol1 = input
[0m[32m+            .get_param("volume1")
[0m[32m+            .ok_or_else(|| Error::MissingInput("volume1 required".into()))?;
[0m[32m+        let abv1 = input
[0m[32m+            .get_param("abv1")
[0m[32m+            .ok_or_else(|| Error::MissingInput("abv1 required".into()))?;
[0m[32m+        let vol2 = input
[0m[32m+            .get_param("volume2")
[0m[32m+            .ok_or_else(|| Error::MissingInput("volume2 required".into()))?;
[0m[32m+        let abv2 = input
[0m[32m+            .get_param("abv2")
[0m[32m+            .ok_or_else(|| Error::MissingInput("abv2 required".into()))?;
[0m 
[31m-        let v1: Decimal = vol1.parse().map_err(|_| Error::Parse("Invalid volume1".into()))?;
[0m[31m-        let a1: Decimal = abv1.parse().map_err(|_| Error::Parse("Invalid abv1".into()))?;
[0m[31m-        let v2: Decimal = vol2.parse().map_err(|_| Error::Parse("Invalid volume2".into()))?;
[0m[31m-        let a2: Decimal = abv2.parse().map_err(|_| Error::Parse("Invalid abv2".into()))?;
[0m[32m+        let v1: Decimal = vol1
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid volume1".into()))?;
[0m[32m+        let a1: Decimal = abv1
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid abv1".into()))?;
[0m[32m+        let v2: Decimal = vol2
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid volume2".into()))?;
[0m[32m+        let a2: Decimal = abv2
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid abv2".into()))?;
[0m 
         let total_vol = v1 + v2;
         let blended_abv = (v1 * a1 + v2 * a2) / total_vol;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\blending.rs:48:
 }
 
 register_calculator!(BlendingCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bochet.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 use std::str::FromStr;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bochet.rs:29:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
         let bochet_level = input.get_param("bochet_level").unwrap_or("medium");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bochet.rs:38:
[31m-        let vol: Decimal = Decimal::from_str(volume)
[0m[31m-            .map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[31m-        let abv: Decimal = Decimal::from_str(target_abv)
[0m[31m-            .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m[32m+        let vol: Decimal =
[0m[32m+            Decimal::from_str(volume).map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[32m+        let abv: Decimal =
[0m[32m+            Decimal::from_str(target_abv).map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m 
         let loss_pct = match bochet_level {
             "light" => Decimal::new(5, 2),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bochet.rs:53:
 
         let mut result = CalcResult::new(Measurement::new(honey_before_caramel, Unit::Grams));
 
[31m-        result = result
[0m[31m-            .with_meta("caramel_level", bochet_level)
[0m[31m-            .with_meta("sugar_loss", format!("{:.0}%", loss_pct * Decimal::from(100)));
[0m[32m+        result = result.with_meta("caramel_level", bochet_level).with_meta(
[0m[32m+            "sugar_loss",
[0m[32m+            format!("{:.0}%", loss_pct * Decimal::from(100)),
[0m[32m+        );
[0m 
         Ok(result)
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bochet.rs:62:
 }
 
 register_calculator!(BochetCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bottling.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bottling.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
         let bottle_size = input.get_param("bottle_size").unwrap_or("750");
         let loss_percent = input.get_param("loss_percent").unwrap_or("3");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bottling.rs:35:
 
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
[31m-        let bottle_ml: Decimal = bottle_size.parse()
[0m[32m+        let bottle_ml: Decimal = bottle_size
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid bottle_size".into()))?;
[31m-        let loss_pct: Decimal = loss_percent.parse()
[0m[32m+        let loss_pct: Decimal = loss_percent
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid loss_percent".into()))?;
 
         // Account for losses (racking, lees, sampling, spillage)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bottling.rs:60:
         result = result
             .with_meta("bottle_size_ml", format!("{} mL", bottle_ml))
             .with_meta("bottles_needed", format!("{:.0} bottles", bottles_needed))
[31m-            .with_meta("cases_12", format!("{:.0} cases + {:.0} loose", cases_12, loose_bottles))
[0m[32m+            .with_meta(
[0m[32m+                "cases_12",
[0m[32m+                format!("{:.0} cases + {:.0} loose", cases_12, loose_bottles),
[0m[32m+            )
[0m             .with_meta("usable_volume_L", format!("{:.2} L", usable_volume))
[31m-            .with_meta("loss_L", format!("{:.2} L ({}%)", vol - usable_volume, loss_pct))
[0m[32m+            .with_meta(
[0m[32m+                "loss_L",
[0m[32m+                format!("{:.2} L ({}%)", vol - usable_volume, loss_pct),
[0m[32m+            )
[0m             .with_meta("leftover_ml", format!("{:.0} mL", leftover_ml));
 
         if leftover_ml > Decimal::from(200) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\bottling.rs:78:
 }
 
 register_calculator!(BottlingCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\braggot.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 use std::str::FromStr;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\braggot.rs:29:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
[31m-        let honey_percent = input.get_param("honey_percent")
[0m[32m+        let honey_percent = input
[0m[32m+            .get_param("honey_percent")
[0m             .ok_or_else(|| Error::MissingInput("honey_percent required".into()))?;
         let _malt_weight = input.get_param("malt_weight");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\braggot.rs:40:
[31m-        let vol: Decimal = Decimal::from_str(volume)
[0m[31m-            .map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[31m-        let abv: Decimal = Decimal::from_str(target_abv)
[0m[31m-            .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m[32m+        let vol: Decimal =
[0m[32m+            Decimal::from_str(volume).map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[32m+        let abv: Decimal =
[0m[32m+            Decimal::from_str(target_abv).map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m         let honey_pct: Decimal = Decimal::from_str(honey_percent)
             .map_err(|_| Error::Parse("Invalid honey_percent".into()))?;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\braggot.rs:51:
         let mut result = CalcResult::new(Measurement::new(honey_sugar_g, Unit::Grams));
 
         result = result
[31m-            .with_meta("honey_kg", format!("{:.2} kg", honey_sugar_g / Decimal::from(1000)))
[0m[32m+            .with_meta(
[0m[32m+                "honey_kg",
[0m[32m+                format!("{:.2} kg", honey_sugar_g / Decimal::from(1000)),
[0m[32m+            )
[0m             .with_meta("honey_g", format!("{:.0} g", honey_sugar_g));
 
         Ok(result)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\braggot.rs:59:
 }
 
 register_calculator!(BraggotCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\brix_to_sg.rs:1:
 // Convert degrees Brix to specific gravity using accurate Brew Your Own formula.
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Measurement, Result, Unit,
[0m[31m-    Validator,
[0m[32m+    CalcInput, CalcResult, Calculator, Measurement, Result, Unit, Validator, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\brix_to_sg.rs:40:
         // CORRECT FORMULA (Brew Your Own / Brewer's Friend):
         // SG = (Brix / (258.6 - (Brix/258.2)├ù227.1)) + 1
 
[31m-        let denominator = Decimal::new(2586, 1) - ((brix / Decimal::new(2582, 1)) * Decimal::new(2271, 1));
[0m[32m+        let denominator =
[0m[32m+            Decimal::new(2586, 1) - ((brix / Decimal::new(2582, 1)) * Decimal::new(2271, 1));
[0m         let sg = (brix / denominator) + Decimal::ONE;
 
         let mut result = CalcResult::new(Measurement::sg(sg)?);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\brix_to_sg.rs:53:
             .with_meta("brix", format!("{:.2}┬░Bx", brix))
             .with_meta("sg", format!("{:.4}", sg))
             .with_meta("formula", "Brew Your Own (accurate)")
[31m-            .with_meta("calculation", format!("{}/(258.6 - ({}├╖258.2)├ù227.1) + 1", brix, brix));
[0m[32m+            .with_meta(
[0m[32m+                "calculation",
[0m[32m+                format!("{}/(258.6 - ({}├╖258.2)├ù227.1) + 1", brix, brix),
[0m[32m+            );
[0m 
         Ok(result)
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\brix_to_sg.rs:65:
 }
 
 register_calculator!(BrixToSgCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\capsicumel.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 use std::str::FromStr;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\capsicumel.rs:29:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
 
[31m-        let vol: Decimal = Decimal::from_str(volume)
[0m[31m-            .map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[31m-        let abv: Decimal = Decimal::from_str(target_abv)
[0m[31m-            .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m[32m+        let vol: Decimal =
[0m[32m+            Decimal::from_str(volume).map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[32m+        let abv: Decimal =
[0m[32m+            Decimal::from_str(target_abv).map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m 
         // FIXED: 33 g per L per % ABV
         let honey_needed = vol * abv * Decimal::from(33);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\capsicumel.rs:49:
 }
 
 register_calculator!(CapsicumelCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\carbonation.rs:1:
 // SAFETY-CRITICAL: Carbonation calculator with proper temperature handling
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\carbonation.rs:30:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let temperature = input.get_param("temperature")
[0m[32m+        let temperature = input
[0m[32m+            .get_param("temperature")
[0m             .ok_or_else(|| Error::MissingInput("temperature required".into()))?;
[31m-        let target_co2 = input.get_param("target_co2")
[0m[32m+        let target_co2 = input
[0m[32m+            .get_param("target_co2")
[0m             .ok_or_else(|| Error::MissingInput("target_co2 required".into()))?;
 
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
[31m-        let temp_c: Decimal = temperature.parse()
[0m[32m+        let temp_c: Decimal = temperature
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid temperature".into()))?;
[31m-        let target: Decimal = target_co2.parse()
[0m[32m+        let target: Decimal = target_co2
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target_co2".into()))?;
 
         // CRITICAL: Convert Celsius to Fahrenheit for the residual CO2 formula
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\carbonation.rs:51:
         // Calculate residual CO2 using FAHRENHEIT temperature
         // Standard brewing formula: CO2_residual = 3.0378 - 0.050062├ùT_F + 0.00026555├ùT_F┬▓
         let temp_f_f64 = temp_f.to_string().parse::<f64>().unwrap_or(68.0);
[31m-        let residual_co2_f64 = 3.0378 - (0.050062 * temp_f_f64) + (0.00026555 * temp_f_f64 * temp_f_f64);
[0m[32m+        let residual_co2_f64 =
[0m[32m+            3.0378 - (0.050062 * temp_f_f64) + (0.00026555 * temp_f_f64 * temp_f_f64);
[0m         let residual_co2 = Decimal::from_f64_retain(residual_co2_f64).unwrap_or(Decimal::new(8, 1));
 
         // CO2 that needs to be added
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\carbonation.rs:59:
 
         if co2_needed < Decimal::ZERO {
             return Err(Error::Validation(
[31m-                "Target CO2 already present at this temperature".into()
[0m[32m+                "Target CO2 already present at this temperature".into(),
[0m             ));
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\carbonation.rs:69:
             // Force carbonation PSI calculation (also uses Fahrenheit)
             let t = temp_f_f64;
             let co2 = target.to_string().parse::<f64>().unwrap_or(2.5);
[31m-            let psi_f64 = -16.6999 - (0.0101059 * t) + (0.00116512 * t * t)
[0m[31m-                + (0.173354 * t * co2) + (4.24267 * co2) - (0.0684226 * co2 * co2);
[0m[32m+            let psi_f64 = -16.6999 - (0.0101059 * t)
[0m[32m+                + (0.00116512 * t * t)
[0m[32m+                + (0.173354 * t * co2)
[0m[32m+                + (4.24267 * co2)
[0m[32m+                - (0.0684226 * co2 * co2);
[0m             let psi = Decimal::from_f64_retain(psi_f64.max(0.0)).unwrap_or(Decimal::from(10));
 
             CalcResult::new(Measurement::new(psi, Unit::Grams))
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\carbonation.rs:86:
 
             // CORRECT FACTORS (grams per liter per volume CO2)
             let factor = match sugar_type {
[31m-                "table_sugar" => Decimal::new(40, 1),     // 4.0 g/L/vol (sucrose)
[0m[31m-                "corn_sugar" => Decimal::new(386, 2),     // 3.86 g/L/vol (dextrose)
[0m[31m-                "honey" => Decimal::new(50, 1),           // 5.0 g/L/vol (~80% fermentable)
[0m[31m-                "dme" => Decimal::new(460, 2),            // 4.6 g/L/vol (~87% fermentable)
[0m[32m+                "table_sugar" => Decimal::new(40, 1), // 4.0 g/L/vol (sucrose)
[0m[32m+                "corn_sugar" => Decimal::new(386, 2), // 3.86 g/L/vol (dextrose)
[0m[32m+                "honey" => Decimal::new(50, 1),       // 5.0 g/L/vol (~80% fermentable)
[0m[32m+                "dme" => Decimal::new(460, 2),        // 4.6 g/L/vol (~87% fermentable)
[0m                 _ => Decimal::new(40, 1),
             };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\carbonation.rs:135:
 }
 
 register_calculator!(CarbonationCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\cyser.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 use std::str::FromStr;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\cyser.rs:29:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
[31m-        let juice_percent = input.get_param("juice_percent")
[0m[32m+        let juice_percent = input
[0m[32m+            .get_param("juice_percent")
[0m             .ok_or_else(|| Error::MissingInput("juice_percent required".into()))?;
 
[31m-        let vol: Decimal = Decimal::from_str(volume)
[0m[31m-            .map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[31m-        let abv: Decimal = Decimal::from_str(target_abv)
[0m[31m-            .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m[32m+        let vol: Decimal =
[0m[32m+            Decimal::from_str(volume).map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[32m+        let abv: Decimal =
[0m[32m+            Decimal::from_str(target_abv).map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m         let juice_pct: Decimal = Decimal::from_str(juice_percent)
             .map_err(|_| Error::Parse("Invalid juice_percent".into()))?;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\cyser.rs:59:
         result = result
             .with_meta("juice_volume_L", format!("{:.2} L", juice_volume))
             .with_meta("juice_sugar_g", format!("{:.0} g", juice_sugar_g))
[31m-            .with_meta("honey_kg", format!("{:.2} kg", honey_sugar_g / Decimal::from(1000)));
[0m[32m+            .with_meta(
[0m[32m+                "honey_kg",
[0m[32m+                format!("{:.2} kg", honey_sugar_g / Decimal::from(1000)),
[0m[32m+            );
[0m 
         Ok(result)
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\cyser.rs:66:
 }
 
 register_calculator!(CyserCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\dilution.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\dilution.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("current_volume").ok_or_else(|| Error::MissingInput("current_volume required".into()))?;
[0m[31m-        let current_abv = input.get_param("current_abv").ok_or_else(|| Error::MissingInput("current_abv required".into()))?;
[0m[31m-        let target_abv = input.get_param("target_abv").ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
[0m[32m+        let volume = input
[0m[32m+            .get_param("current_volume")
[0m[32m+            .ok_or_else(|| Error::MissingInput("current_volume required".into()))?;
[0m[32m+        let current_abv = input
[0m[32m+            .get_param("current_abv")
[0m[32m+            .ok_or_else(|| Error::MissingInput("current_abv required".into()))?;
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m[32m+            .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
[0m 
[31m-        let vol: Decimal = volume.parse().map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[31m-        let curr_abv: Decimal = current_abv.parse().map_err(|_| Error::Parse("Invalid current ABV".into()))?;
[0m[31m-        let targ_abv: Decimal = target_abv.parse().map_err(|_| Error::Parse("Invalid target ABV".into()))?;
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[32m+        let curr_abv: Decimal = current_abv
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid current ABV".into()))?;
[0m[32m+        let targ_abv: Decimal = target_abv
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid target ABV".into()))?;
[0m 
         if targ_abv >= curr_abv {
[31m-            return Err(Error::Validation("Target ABV must be less than current ABV".into()));
[0m[32m+            return Err(Error::Validation(
[0m[32m+                "Target ABV must be less than current ABV".into(),
[0m[32m+            ));
[0m         }
 
         let water_needed = vol * ((curr_abv - targ_abv) / targ_abv);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\dilution.rs:44:
 
[31m-        Ok(CalcResult::new(Measurement::new(water_needed, Unit::Liters))
[0m[31m-            .with_meta("current_volume", volume)
[0m[31m-            .with_meta("current_abv", current_abv)
[0m[31m-            .with_meta("target_abv", target_abv))
[0m[32m+        Ok(
[0m[32m+            CalcResult::new(Measurement::new(water_needed, Unit::Liters))
[0m[32m+                .with_meta("current_volume", volume)
[0m[32m+                .with_meta("current_abv", current_abv)
[0m[32m+                .with_meta("target_abv", target_abv),
[0m[32m+        )
[0m     }
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\dilution.rs:52:
 register_calculator!(DilutionCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\efficiency.rs:2:
 //! Calculates mash, lauter, and total efficiency
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\efficiency.rs:31:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let grain_weight = input.get_param("grain_weight")
[0m[32m+        let grain_weight = input
[0m[32m+            .get_param("grain_weight")
[0m             .ok_or_else(|| Error::MissingInput("grain_weight required".into()))?;
[31m-        let ppg = input.get_param("ppg")
[0m[31m-            .ok_or_else(|| Error::MissingInput("ppg (points per pound per gallon) required".into()))?;
[0m[31m-        let measured_gravity = input.get_param("measured_gravity")
[0m[32m+        let ppg = input.get_param("ppg").ok_or_else(|| {
[0m[32m+            Error::MissingInput("ppg (points per pound per gallon) required".into())
[0m[32m+        })?;
[0m[32m+        let measured_gravity = input
[0m[32m+            .get_param("measured_gravity")
[0m             .ok_or_else(|| Error::MissingInput("measured_gravity required".into()))?;
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
 
[31m-        let weight: Decimal = grain_weight.parse()
[0m[32m+        let weight: Decimal = grain_weight
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid grain weight".into()))?;
[31m-        let ppg_val: Decimal = ppg.parse()
[0m[32m+        let ppg_val: Decimal = ppg
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid PPG".into()))?;
[31m-        let gravity: Decimal = measured_gravity.parse()
[0m[32m+        let gravity: Decimal = measured_gravity
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid gravity".into()))?;
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
 
         if weight <= Decimal::ZERO {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\efficiency.rs:128:
 }
 
 register_calculator!(EfficiencyCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles.rs:1:
[31m-use mazerion_core::{Calculator, CalcInput, CalcResult, Error, Measurement, Unit};
[0m[32m+use mazerion_core::{CalcInput, CalcResult, Calculator, Error, Measurement, Unit};
[0m use rust_decimal::Decimal;
 use rust_decimal::prelude::ToPrimitive;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles.rs:25:
     fn calculate(&self, input: CalcInput) -> Result<CalcResult, Error> {
         // input.params is Vec<(String, String)> - iterate to find
         let get_param = |name: &str| -> Result<Decimal, Error> {
[31m-            input.params
[0m[32m+            input
[0m[32m+                .params
[0m                 .iter()
                 .find(|(k, _)| k == name)
                 .map(|(_, v)| v.as_str())
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles.rs:40:
 
         // Validate
         if initial_volume_gal <= Decimal::ZERO {
[31m-            return Err(Error::Calculation("Initial volume must be positive".to_string()));
[0m[32m+            return Err(Error::Calculation(
[0m[32m+                "Initial volume must be positive".to_string(),
[0m[32m+            ));
[0m         }
         if loss_rate_percent < Decimal::ZERO || loss_rate_percent >= Decimal::from(100) {
             return Err(Error::Calculation("Loss rate must be 0-100%".to_string()));
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles.rs:49:
             return Err(Error::Calculation("Rackings must be 1-20".to_string()));
         }
 
[31m-        let num_rackings_u32 = num_rackings.to_u32()
[0m[32m+        let num_rackings_u32 = num_rackings
[0m[32m+            .to_u32()
[0m             .ok_or_else(|| Error::Calculation("Invalid rackings".to_string()))?;
 
         // Constants
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles.rs:72:
         let total_loss_percent = (total_loss_gal / initial_volume_gal) * Decimal::from(100);
 
         let mut metadata = vec![
[31m-            ("Initial".to_string(), format!("{:.3} gal", initial_volume_gal)),
[0m[32m+            (
[0m[32m+                "Initial".to_string(),
[0m[32m+                format!("{:.3} gal", initial_volume_gal),
[0m[32m+            ),
[0m             ("Final".to_string(), format!("{:.3} gal", final_volume_gal)),
[31m-            ("Loss".to_string(), format!("{:.3} gal ({:.2}%)", total_loss_gal, total_loss_percent)),
[0m[32m+            (
[0m[32m+                "Loss".to_string(),
[0m[32m+                format!("{:.3} gal ({:.2}%)", total_loss_gal, total_loss_percent),
[0m[32m+            ),
[0m         ];
 
         let mut current = initial_volume_gal;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles.rs:81:
         for i in 1..=num_rackings_u32 {
             current *= retention_rate;
[31m-            metadata.push((format!("After racking {}", i), format!("{:.3} gal ({:.2} bottles)", current, current * bottles_per_gallon)));
[0m[32m+            metadata.push((
[0m[32m+                format!("After racking {}", i),
[0m[32m+                format!(
[0m[32m+                    "{:.3} gal ({:.2} bottles)",
[0m[32m+                    current,
[0m[32m+                    current * bottles_per_gallon
[0m[32m+                ),
[0m[32m+            ));
[0m         }
 
         let mut warnings = Vec::new();
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles.rs:114:
         assert_eq!(result.output.value.round_dp(2), Decimal::new(2164, 2));
     }
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:1:
[31m-use mazerion_core::{Calculator, CalcInput, CalcResult, Error, Measurement, Unit};
[0m[32m+use mazerion_core::{CalcInput, CalcResult, Calculator, Error, Measurement, Unit};
[0m use rust_decimal::Decimal;
 use rust_decimal::prelude::ToPrimitive;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:40:
     fn calculate(&self, input: CalcInput) -> Result<CalcResult, Error> {
         // Helper function to extract and parse parameters from input
         let get_param = |name: &str| -> Result<Decimal, Error> {
[31m-            input.params
[0m[32m+            input
[0m[32m+                .params
[0m                 .iter()
                 .find(|(k, _)| k == name)
                 .map(|(_, v)| v.as_str())
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:57:
         // Comprehensive input validation
         if initial_volume_gal <= Decimal::ZERO {
             return Err(Error::Calculation(
[31m-                "Initial volume must be greater than zero".to_string()
[0m[32m+                "Initial volume must be greater than zero".to_string(),
[0m             ));
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:64:
         if initial_volume_gal > Decimal::from(1000) {
             return Err(Error::Calculation(
[31m-                "Initial volume seems unreasonably large (max 1000 gallons)".to_string()
[0m[32m+                "Initial volume seems unreasonably large (max 1000 gallons)".to_string(),
[0m             ));
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:70:
         if loss_rate_percent < Decimal::ZERO {
             return Err(Error::Calculation(
[31m-                "Loss rate cannot be negative".to_string()
[0m[32m+                "Loss rate cannot be negative".to_string(),
[0m             ));
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:76:
         if loss_rate_percent >= Decimal::from(100) {
             return Err(Error::Calculation(
[31m-                "Loss rate must be less than 100%".to_string()
[0m[32m+                "Loss rate must be less than 100%".to_string(),
[0m             ));
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:82:
         if num_rackings < Decimal::ONE {
             return Err(Error::Calculation(
[31m-                "Must have at least 1 racking".to_string()
[0m[32m+                "Must have at least 1 racking".to_string(),
[0m             ));
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:88:
         if num_rackings > Decimal::from(20) {
             return Err(Error::Calculation(
[31m-                "Number of rackings seems unreasonably high (max 20)".to_string()
[0m[32m+                "Number of rackings seems unreasonably high (max 20)".to_string(),
[0m             ));
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:131:
         // Build comprehensive metadata with all calculation details
         let mut metadata = vec![
             // Initial conditions
[31m-            ("Initial Volume (gal)".to_string(), format!("{:.3}", initial_volume_gal)),
[0m[31m-            ("Initial Volume (L)".to_string(), format!("{:.3}", initial_volume_gal * liters_per_gallon)),
[0m[31m-            ("Initial Bottles (theoretical)".to_string(), format!("{:.2}", initial_volume_gal * bottles_per_gallon)),
[0m[31m-
[0m[32m+            (
[0m[32m+                "Initial Volume (gal)".to_string(),
[0m[32m+                format!("{:.3}", initial_volume_gal),
[0m[32m+            ),
[0m[32m+            (
[0m[32m+                "Initial Volume (L)".to_string(),
[0m[32m+                format!("{:.3}", initial_volume_gal * liters_per_gallon),
[0m[32m+            ),
[0m[32m+            (
[0m[32m+                "Initial Bottles (theoretical)".to_string(),
[0m[32m+                format!("{:.2}", initial_volume_gal * bottles_per_gallon),
[0m[32m+            ),
[0m             // Loss parameters
[31m-            ("Loss Rate Per Racking".to_string(), format!("{:.2}%", loss_rate_percent)),
[0m[31m-            ("Number of Rackings".to_string(), format!("{}", num_rackings_u32)),
[0m[31m-            ("Retention Rate Per Racking".to_string(), format!("{:.4}", retention_rate)),
[0m[31m-            ("Compounded Retention".to_string(), format!("{:.6}", compounded_retention)),
[0m[31m-
[0m[32m+            (
[0m[32m+                "Loss Rate Per Racking".to_string(),
[0m[32m+                format!("{:.2}%", loss_rate_percent),
[0m[32m+            ),
[0m[32m+            (
[0m[32m+                "Number of Rackings".to_string(),
[0m[32m+                format!("{}", num_rackings_u32),
[0m[32m+            ),
[0m[32m+            (
[0m[32m+                "Retention Rate Per Racking".to_string(),
[0m[32m+                format!("{:.4}", retention_rate),
[0m[32m+            ),
[0m[32m+            (
[0m[32m+                "Compounded Retention".to_string(),
[0m[32m+                format!("{:.6}", compounded_retention),
[0m[32m+            ),
[0m             // Final results
[31m-            ("Final Volume (gal)".to_string(), format!("{:.3}", final_volume_gal)),
[0m[31m-            ("Final Volume (L)".to_string(), format!("{:.3}", final_volume_l)),
[0m[31m-            ("Final Bottles (actual)".to_string(), format!("{:.2}", total_bottles)),
[0m[31m-
[0m[32m+            (
[0m[32m+                "Final Volume (gal)".to_string(),
[0m[32m+                format!("{:.3}", final_volume_gal),
[0m[32m+            ),
[0m[32m+            (
[0m[32m+                "Final Volume (L)".to_string(),
[0m[32m+                format!("{:.3}", final_volume_l),
[0m[32m+            ),
[0m[32m+            (
[0m[32m+                "Final Bottles (actual)".to_string(),
[0m[32m+                format!("{:.2}", total_bottles),
[0m[32m+            ),
[0m             // Loss calculations
[31m-            ("Total Loss (gal)".to_string(), format!("{:.3}", total_loss_gal)),
[0m[32m+            (
[0m[32m+                "Total Loss (gal)".to_string(),
[0m[32m+                format!("{:.3}", total_loss_gal),
[0m[32m+            ),
[0m             ("Total Loss (L)".to_string(), format!("{:.3}", total_loss_l)),
[31m-            ("Total Loss (%)".to_string(), format!("{:.2}%", total_loss_percent)),
[0m[31m-            ("Total Loss (bottles)".to_string(), format!("{:.2}", total_loss_gal * bottles_per_gallon)),
[0m[31m-
[0m[32m+            (
[0m[32m+                "Total Loss (%)".to_string(),
[0m[32m+                format!("{:.2}%", total_loss_percent),
[0m[32m+            ),
[0m[32m+            (
[0m[32m+                "Total Loss (bottles)".to_string(),
[0m[32m+                format!("{:.2}", total_loss_gal * bottles_per_gallon),
[0m[32m+            ),
[0m             // Conversion reference
[31m-            ("Bottles per Gallon".to_string(), format!("{:.4}", bottles_per_gallon)),
[0m[31m-            ("Bottle Size".to_string(), "750ml (standard wine bottle)".to_string()),
[0m[32m+            (
[0m[32m+                "Bottles per Gallon".to_string(),
[0m[32m+                format!("{:.4}", bottles_per_gallon),
[0m[32m+            ),
[0m[32m+            (
[0m[32m+                "Bottle Size".to_string(),
[0m[32m+                "750ml (standard wine bottle)".to_string(),
[0m[32m+            ),
[0m         ];
 
         // Add detailed racking-by-racking breakdown
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:181:
 
         // Add comparison to incorrect additive method
         let wrong_total_loss_percent = loss_rate_percent * Decimal::from(num_rackings_u32);
[31m-        let wrong_final_volume = initial_volume_gal * (Decimal::ONE - (wrong_total_loss_percent / Decimal::from(100)));
[0m[32m+        let wrong_final_volume =
[0m[32m+            initial_volume_gal * (Decimal::ONE - (wrong_total_loss_percent / Decimal::from(100)));
[0m         let wrong_bottles = wrong_final_volume * bottles_per_gallon;
         let difference = total_bottles - wrong_bottles;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:190:
         metadata.push(("ΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇ".to_string(), "".to_string()));
         metadata.push((
             "Correct (Compounding)".to_string(),
[31m-            format!("{:.2} bottles | {:.2}% total loss", total_bottles, total_loss_percent)
[0m[32m+            format!(
[0m[32m+                "{:.2} bottles | {:.2}% total loss",
[0m[32m+                total_bottles, total_loss_percent
[0m[32m+            ),
[0m         ));
         metadata.push((
             "Wrong (Additive)".to_string(),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:197:
[31m-            format!("{:.2} bottles | {:.2}% total loss", wrong_bottles, wrong_total_loss_percent)
[0m[32m+            format!(
[0m[32m+                "{:.2} bottles | {:.2}% total loss",
[0m[32m+                wrong_bottles, wrong_total_loss_percent
[0m[32m+            ),
[0m         ));
         metadata.push((
             "Difference".to_string(),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:201:
[31m-            format!("{:.2} bottles ({:.2}% error)", difference, (difference / total_bottles * Decimal::from(100)).abs())
[0m[32m+            format!(
[0m[32m+                "{:.2} bottles ({:.2}% error)",
[0m[32m+                difference,
[0m[32m+                (difference / total_bottles * Decimal::from(100)).abs()
[0m[32m+            ),
[0m         ));
 
         // Generate comprehensive warnings
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:227:
             warnings.push(format!(
                 "ΓÜá∩╕Å Total loss of {:.1}% is very high. You're losing {:.2} bottles! \
                  Consider reducing the number of rackings or improving technique.",
[31m-                total_loss_percent, total_loss_gal * bottles_per_gallon
[0m[32m+                total_loss_percent,
[0m[32m+                total_loss_gal * bottles_per_gallon
[0m             ));
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:244:
         if num_rackings_u32 == 1 && loss_rate_percent > Decimal::from(8) {
             warnings.push(
                 "ΓÜá∩╕Å Single racking with >8% loss suggests heavy sediment or poor technique. \
[31m-                 Consider cold-crashing before racking to compact sediment.".to_string()
[0m[32m+                 Consider cold-crashing before racking to compact sediment."
[0m[32m+                    .to_string(),
[0m             );
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:251:
         // Informational notes
         if num_rackings_u32 >= 3 && loss_rate_percent <= Decimal::from(5) {
             warnings.push(
[31m-                "Γ£ô Good racking technique! Keeping losses Γëñ5% per racking is excellent practice.".to_string()
[0m[32m+                "Γ£ô Good racking technique! Keeping losses Γëñ5% per racking is excellent practice."
[0m[32m+                    .to_string(),
[0m             );
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:260:
             "Γä╣∩╕Å This calculation assumes standard 750ml wine bottles. \
              For 375ml (half bottles): multiply by 2. \
              For 1.5L (magnums): divide by 2. \
[31m-             For 187ml (splits): multiply by 4.".to_string()
[0m[32m+             For 187ml (splits): multiply by 4."
[0m[32m+                .to_string(),
[0m         );
 
         // Return complete result
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gallons_to_bottles_with_losses.rs:397:
         assert!(has_comparison);
     }
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gravity_from_ingredients.rs:2:
 // Uses CORRECT metric formula with proper unit conversions
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gravity_from_ingredients.rs:31:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let water_volume = input.get_param("water_volume")
[0m[32m+        let water_volume = input
[0m[32m+            .get_param("water_volume")
[0m             .ok_or_else(|| Error::MissingInput("water_volume required".into()))?;
[31m-        let honey_weight = input.get_param("honey_weight")
[0m[32m+        let honey_weight = input
[0m[32m+            .get_param("honey_weight")
[0m             .ok_or_else(|| Error::MissingInput("honey_weight required".into()))?;
         let ingredient_type = input.get_param("ingredient_type").unwrap_or("honey");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gravity_from_ingredients.rs:40:
[31m-        let water_l: Decimal = water_volume.parse()
[0m[32m+        let water_l: Decimal = water_volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid water_volume".into()))?;
[31m-        let honey_kg: Decimal = honey_weight.parse()
[0m[32m+        let honey_kg: Decimal = honey_weight
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid honey_weight".into()))?;
 
         // CORRECT METRIC FORMULA: gravity_points = (kg/L) ├ù points_per_kg_per_L
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gravity_from_ingredients.rs:48:
         // Metric points = Imperial ppg ├ù 8.345
 
         let points_per_kg_per_L = match ingredient_type {
[31m-            "honey" => Decimal::from(292),          // 35 ppg ├ù 8.345 = 292
[0m[31m-            "table_sugar" => Decimal::from(384),     // 46 ppg ├ù 8.345 = 384
[0m[31m-            "dme" => Decimal::from(367),             // 44 ppg ├ù 8.345 = 367 (dry malt extract)
[0m[31m-            "maple_syrup" => Decimal::from(250),     // 30 ppg ├ù 8.345 = 250
[0m[32m+            "honey" => Decimal::from(292),       // 35 ppg ├ù 8.345 = 292
[0m[32m+            "table_sugar" => Decimal::from(384), // 46 ppg ├ù 8.345 = 384
[0m[32m+            "dme" => Decimal::from(367),         // 44 ppg ├ù 8.345 = 367 (dry malt extract)
[0m[32m+            "maple_syrup" => Decimal::from(250), // 30 ppg ├ù 8.345 = 250
[0m             _ => Decimal::from(292),
         };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gravity_from_ingredients.rs:75:
             .with_meta("water_L", format!("{:.2} L", water_l))
             .with_meta("honey_volume_L", format!("{:.2} L", honey_volume_l))
             .with_meta("total_volume", format!("{:.2} L", total_volume))
[31m-            .with_meta("concentration", format!("{:.3} kg/L", concentration_kg_per_L))
[0m[32m+            .with_meta(
[0m[32m+                "concentration",
[0m[32m+                format!("{:.3} kg/L", concentration_kg_per_L),
[0m[32m+            )
[0m             .with_meta("gravity_points", format!("{:.1} points", gravity_points))
             .with_meta("estimated_sg", format!("{:.3}", calculated_sg))
             .with_meta("formula", "Metric: (kg/L) ├ù points_per_kg_per_L");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gravity_from_ingredients.rs:82:
 
         if calculated_sg > Decimal::new(1120, 3) {
[31m-            result = result.with_warning("Very high gravity (>1.120) - may stress yeast, consider stepped feeding");
[0m[32m+            result = result.with_warning(
[0m[32m+                "Very high gravity (>1.120) - may stress yeast, consider stepped feeding",
[0m[32m+            );
[0m         }
 
         if calculated_sg < Decimal::new(1040, 3) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\gravity_from_ingredients.rs:103:
 }
 
 register_calculator!(GravityFromIngredientsCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\great_mead.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\great_mead.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
 
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
[31m-        let abv: Decimal = target_abv.parse()
[0m[32m+        let abv: Decimal = target_abv
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
 
         if abv < Decimal::from(5) || abv > Decimal::from(20) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\great_mead.rs:42:
[31m-            return Err(Error::OutOfRange("ABV should be 5-20% for traditional mead".into()));
[0m[32m+            return Err(Error::OutOfRange(
[0m[32m+                "ABV should be 5-20% for traditional mead".into(),
[0m[32m+            ));
[0m         }
 
         // FIXED: 33 g honey per liter per % ABV
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\great_mead.rs:51:
         result = result
             .with_meta("volume", format!("{} L", vol))
             .with_meta("target_abv", format!("{}%", abv))
[31m-            .with_meta("honey_kg", format!("{:.2} kg", honey_needed / Decimal::from(1000)))
[0m[31m-            .with_meta("honey_lbs", format!("{:.2} lbs", honey_needed / Decimal::new(45359, 2)))
[0m[32m+            .with_meta(
[0m[32m+                "honey_kg",
[0m[32m+                format!("{:.2} kg", honey_needed / Decimal::from(1000)),
[0m[32m+            )
[0m[32m+            .with_meta(
[0m[32m+                "honey_lbs",
[0m[32m+                format!("{:.2} lbs", honey_needed / Decimal::new(45359, 2)),
[0m[32m+            )
[0m             .with_meta("formula", "33 g honey/L/%ABV");
 
         if abv < Decimal::from(8) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\great_mead.rs:67:
 }
 
 register_calculator!(GreatMeadCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\hydromel.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\hydromel.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
 
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
[31m-        let abv: Decimal = target_abv.parse()
[0m[32m+        let abv: Decimal = target_abv
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
 
         // FIXED: 33 g honey per liter per % ABV
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\hydromel.rs:43:
 
         let mut result = CalcResult::new(Measurement::new(honey_needed, Unit::Grams));
 
[31m-        result = result
[0m[31m-            .with_meta("honey_kg", format!("{:.2} kg", honey_needed / Decimal::from(1000)));
[0m[32m+        result = result.with_meta(
[0m[32m+            "honey_kg",
[0m[32m+            format!("{:.2} kg", honey_needed / Decimal::from(1000)),
[0m[32m+        );
[0m 
         if abv < Decimal::new(35, 1) {
             result = result.with_warning("Very low ABV - may have fermentation issues");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\hydromel.rs:58:
 }
 
 register_calculator!(HydromelCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\hydrometer_correction.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\hydrometer_correction.rs:55:
         let tc_f64 = t_c.to_string().parse::<f64>().unwrap_or(68.0);
 
         // Calculate numerator (for reading temperature)
[31m-        let numerator = 1.00130346
[0m[31m-            - (0.000134722124 * tr_f64)
[0m[32m+        let numerator = 1.00130346 - (0.000134722124 * tr_f64)
[0m             + (0.00000204052596 * tr_f64 * tr_f64)
             - (0.00000000232820948 * tr_f64 * tr_f64 * tr_f64);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\hydrometer_correction.rs:63:
         // Calculate denominator (for calibration temperature)
[31m-        let denominator = 1.00130346
[0m[31m-            - (0.000134722124 * tc_f64)
[0m[32m+        let denominator = 1.00130346 - (0.000134722124 * tc_f64)
[0m             + (0.00000204052596 * tc_f64 * tc_f64)
             - (0.00000000232820948 * tc_f64 * tc_f64 * tc_f64);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\hydrometer_correction.rs:85:
             .with_meta("sample_temp", format!("{}┬░F", t_r))
             .with_meta("calibration_temp", format!("{}┬░F", t_c))
             .with_meta("correction", format!("{:+.5}", correction))
[31m-            .with_meta("formula", "General polynomial (accurate for any calibration temp)");
[0m[32m+            .with_meta(
[0m[32m+                "formula",
[0m[32m+                "General polynomial (accurate for any calibration temp)",
[0m[32m+            );
[0m 
         Ok(result)
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\hydrometer_correction.rs:102:
 }
 
 register_calculator!(HydrometerCorrectionCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\ibu.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\ibu.rs:44:
             .get_param("boil_gravity")
             .ok_or_else(|| Error::MissingInput("boil_gravity required (SG)".into()))?;
 
[31m-        let weight: Decimal = hop_weight_g.parse().map_err(|_| Error::Parse("Invalid hop_weight_g".into()))?;
[0m[31m-        let aa: Decimal = alpha_acid.parse().map_err(|_| Error::Parse("Invalid alpha_acid".into()))?;
[0m[31m-        let time_min: Decimal = boil_time.parse().map_err(|_| Error::Parse("Invalid boil_time".into()))?;
[0m[31m-        let volume: Decimal = volume_l.parse().map_err(|_| Error::Parse("Invalid volume_l".into()))?;
[0m[31m-        let sg: Decimal = boil_gravity.parse().map_err(|_| Error::Parse("Invalid boil_gravity".into()))?;
[0m[32m+        let weight: Decimal = hop_weight_g
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid hop_weight_g".into()))?;
[0m[32m+        let aa: Decimal = alpha_acid
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid alpha_acid".into()))?;
[0m[32m+        let time_min: Decimal = boil_time
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid boil_time".into()))?;
[0m[32m+        let volume: Decimal = volume_l
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid volume_l".into()))?;
[0m[32m+        let sg: Decimal = boil_gravity
[0m[32m+            .parse()
[0m[32m+            .map_err(|_| Error::Parse("Invalid boil_gravity".into()))?;
[0m 
         // Tinseth formula:
         // B = 1.65 ├ù 0.000125^(SG_boil - 1.0)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\ibu.rs:57:
         // IBU = (W_g ├ù AA% ├ù U ├ù 1000) / V_L
 
         // Convert to f64 for exponential calculations
[31m-        let sg_f64 = (sg - Decimal::ONE).to_string().parse::<f64>().unwrap_or(0.05);
[0m[32m+        let sg_f64 = (sg - Decimal::ONE)
[0m[32m+            .to_string()
[0m[32m+            .parse::<f64>()
[0m[32m+            .unwrap_or(0.05);
[0m         let time_f64 = time_min.to_string().parse::<f64>().unwrap_or(60.0);
 
         // Bigness factor (gravity correction)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\ibu.rs:86:
 
         result = result
             .with_meta("ibu", format!("{:.1}", ibu))
[31m-            .with_meta("utilization", format!("{:.1}%", util_decimal * Decimal::from(100)))
[0m[32m+            .with_meta(
[0m[32m+                "utilization",
[0m[32m+                format!("{:.1}%", util_decimal * Decimal::from(100)),
[0m[32m+            )
[0m             .with_meta("bigness_factor", format!("{:.4}", bigness))
             .with_meta("boil_factor", format!("{:.4}", boil_factor))
             .with_meta("formula", "Tinseth")
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\ibu.rs:118:
 }
 
 register_calculator!(IbuCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lactomel.rs:1:
 //! Lactomel calculator - milk/lactose mead
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lactomel.rs:30:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
         let lactose_level = input.get_param("lactose_level").unwrap_or("medium");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lactomel.rs:39:
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
[31m-        let abv: Decimal = target_abv.parse()
[0m[32m+        let abv: Decimal = target_abv
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
 
         // Formula: 33 g honey per L per % ABV
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lactomel.rs:67:
         }
 
         if lactose_gpl > Decimal::from(120) {
[31m-            result = result.with_warning("High lactose (>120 g/L) - may be overly sweet and creamy");
[0m[32m+            result =
[0m[32m+                result.with_warning("High lactose (>120 g/L) - may be overly sweet and creamy");
[0m         }
 
         let honey_kg = honey_g / Decimal::from(1000);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lactomel.rs:99:
 }
 
 register_calculator!(LactomelCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lib.rs:9:
 // BASIC CALCULATORS
 pub mod abv;
 pub mod brix_to_sg;
[31m-pub mod sg_to_brix;
[0m[31m-pub mod sg_correction;
[0m[31m-pub mod plato_to_sg;
[0m[31m-pub mod hydrometer_correction;
[0m[31m-pub mod gravity_from_ingredients;
[0m pub mod dilution;
[32m+pub mod gravity_from_ingredients;
[0m[32m+pub mod hydrometer_correction;
[0m[32m+pub mod plato_to_sg;
[0m[32m+pub mod sg_correction;
[0m[32m+pub mod sg_to_brix;
[0m 
 pub use abv::AbvCalculator;
 pub use brix_to_sg::BrixToSgCalculator;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lib.rs:21:
[31m-pub use sg_to_brix::SgToBrixCalculator;
[0m[31m-pub use sg_correction::SgCorrectionCalculator;
[0m[31m-pub use plato_to_sg::PlatoToSgCalculator;
[0m[31m-pub use hydrometer_correction::HydrometerCorrectionCalculator;
[0m[31m-pub use gravity_from_ingredients::GravityFromIngredientsCalculator;
[0m pub use dilution::DilutionCalculator;
[32m+pub use gravity_from_ingredients::GravityFromIngredientsCalculator;
[0m[32m+pub use hydrometer_correction::HydrometerCorrectionCalculator;
[0m[32m+pub use plato_to_sg::PlatoToSgCalculator;
[0m[32m+pub use sg_correction::SgCorrectionCalculator;
[0m[32m+pub use sg_to_brix::SgToBrixCalculator;
[0m 
 // ADVANCED CALCULATORS
[32m+pub mod alcohol_tolerance;
[0m[32m+pub mod attenuation;
[0m[32m+pub mod bench_trials;
[0m pub mod blending;
 pub mod refractometer;
[31m-pub mod attenuation;
[0m pub mod volume_adjustment;
[31m-pub mod bench_trials;
[0m[31m-pub mod alcohol_tolerance;
[0m 
[32m+pub use alcohol_tolerance::AlcoholToleranceCalculator;
[0m[32m+pub use attenuation::AttenuationCalculator;
[0m[32m+pub use bench_trials::BenchTrialsCalculator;
[0m pub use blending::BlendingCalculator;
 pub use refractometer::RefractometerCalculator;
[31m-pub use attenuation::AttenuationCalculator;
[0m pub use volume_adjustment::VolumeAdjustmentCalculator;
[31m-pub use bench_trials::BenchTrialsCalculator;
[0m[31m-pub use alcohol_tolerance::AlcoholToleranceCalculator;
[0m 
 // BREWING CALCULATORS
[31m-pub mod nutrition;
[0m pub mod carbonation;
[32m+pub mod nutrition;
[0m pub mod yeast_pitch;
 pub mod yeast_starter;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lib.rs:49:
[31m-pub use nutrition::NutritionCalculator;
[0m pub use carbonation::CarbonationCalculator;
[32m+pub use nutrition::NutritionCalculator;
[0m pub use yeast_pitch::YeastPitchCalculator;
 pub use yeast_starter::YeastStarterCalculator;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lib.rs:54:
 // BEER CALCULATORS
[32m+pub mod efficiency;
[0m pub mod ibu;
[31m-pub mod srm;
[0m pub mod mash;
[31m-pub mod efficiency;
[0m[32m+pub mod srm;
[0m 
[32m+pub use efficiency::EfficiencyCalculator;
[0m pub use ibu::IbuCalculator;
[31m-pub use srm::SrmCalculator;
[0m pub use mash::MashCalculator;
[31m-pub use efficiency::EfficiencyCalculator;
[0m[32m+pub use srm::SrmCalculator;
[0m 
 // FINISHING CALCULATORS
[31m-pub mod backsweetening;
[0m[31m-pub mod sulfite;
[0m pub mod acid_addition;
[32m+pub mod backsweetening;
[0m[32m+pub mod bottling;
[0m pub mod stabilization;
[32m+pub mod sulfite;
[0m pub mod tannin;
[31m-pub mod bottling;
[0m 
[31m-pub use backsweetening::BacksweeteningCalculator;
[0m[31m-pub use sulfite::SulfiteCalculator;
[0m pub use acid_addition::AcidAdditionCalculator;
[31m-pub use stabilization::StabilizationCalculator;
[0m[31m-pub use tannin::TanninCalculator;
[0m[32m+pub use backsweetening::BacksweeteningCalculator;
[0m pub use bottling::BottlingCalculator;
 pub use pasteurization::PasteurizationCalculator;
[32m+pub use stabilization::StabilizationCalculator;
[0m[32m+pub use sulfite::SulfiteCalculator;
[0m[32m+pub use tannin::TanninCalculator;
[0m 
 // MEAD STYLE CALCULATORS
[32m+pub mod acerglyn;
[0m[32m+pub mod bochet;
[0m[32m+pub mod braggot;
[0m[32m+pub mod capsicumel;
[0m[32m+pub mod cyser;
[0m pub mod great_mead;
 pub mod hydromel;
[31m-pub mod sack;
[0m pub mod melomel;
[31m-pub mod cyser;
[0m[31m-pub mod bochet;
[0m[31m-pub mod braggot;
[0m pub mod metheglin;
[31m-pub mod acerglyn;
[0m[31m-pub mod capsicumel;
[0m[32m+pub mod sack;
[0m 
[31m-pub use pyment::PymentCalculator;
[0m[32m+pub use acerglyn::AcerglynCalculator;
[0m[32m+pub use bochet::BochetCalculator;
[0m[32m+pub use braggot::BraggotCalculator;
[0m[32m+pub use capsicumel::CapsicumelCalculator;
[0m[32m+pub use cyser::CyserCalculator;
[0m pub use great_mead::GreatMeadCalculator;
 pub use hydromel::HydromelCalculator;
[31m-pub use sack::SackCalculator;
[0m pub use melomel::MelomelCalculator;
[31m-pub use cyser::CyserCalculator;
[0m[31m-pub use bochet::BochetCalculator;
[0m[31m-pub use braggot::BraggotCalculator;
[0m pub use metheglin::MetheglinCalculator;
[31m-pub use acerglyn::AcerglynCalculator;
[0m[31m-pub use capsicumel::CapsicumelCalculator;
[0m[32m+pub use pyment::PymentCalculator;
[0m[32m+pub use sack::SackCalculator;
[0m pub mod pasteurization;
 
 pub use lactomel::LactomelCalculator;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lib.rs:107:
 pub use oxymel::OxymelCalculator;
 // UTILITIES CALCULATORS
 pub mod batch_cost;
[31m-pub mod water_chemistry;
[0m[31m-pub mod priming_alternatives;
[0m[31m-pub mod upscaling;
[0m mod gallons_to_bottles;
[31m-mod waste;
[0m mod gallons_to_bottles_with_losses;
[31m-mod pyment;
[0m mod lactomel;
 mod oxymel;
[32m+pub mod priming_alternatives;
[0m[32m+mod pyment;
[0m[32m+pub mod upscaling;
[0m[32m+mod waste;
[0m[32m+pub mod water_chemistry;
[0m 
 pub use upscaling::UpscalingCalculator;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\lib.rs:122:
 pub use batch_cost::BatchCostCalculator;
[31m-pub use water_chemistry::WaterChemistryCalculator;
[0m pub use priming_alternatives::PrimingAlternativesCalculator;
 pub use waste::WasteCalculator;
[32m+pub use water_chemistry::WaterChemistryCalculator;
[0m[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\mash.rs:2:
 //! Uses standard brewing equations
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\mash.rs:31:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let target_temp = input.get_param("target_temp")
[0m[32m+        let target_temp = input
[0m[32m+            .get_param("target_temp")
[0m             .ok_or_else(|| Error::MissingInput("target_temp required".into()))?;
[31m-        let grain_temp = input.get_param("grain_temp")
[0m[32m+        let grain_temp = input
[0m[32m+            .get_param("grain_temp")
[0m             .ok_or_else(|| Error::MissingInput("grain_temp required".into()))?;
[31m-        let grain_weight = input.get_param("grain_weight")
[0m[32m+        let grain_weight = input
[0m[32m+            .get_param("grain_weight")
[0m             .ok_or_else(|| Error::MissingInput("grain_weight required".into()))?;
[31m-        let ratio = input.get_param("ratio")
[0m[32m+        let ratio = input
[0m[32m+            .get_param("ratio")
[0m             .ok_or_else(|| Error::MissingInput("ratio required".into()))?;
 
[31m-        let target: Decimal = target_temp.parse()
[0m[32m+        let target: Decimal = target_temp
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target temp".into()))?;
[31m-        let grain_t: Decimal = grain_temp.parse()
[0m[32m+        let grain_t: Decimal = grain_temp
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid grain temp".into()))?;
[31m-        let weight: Decimal = grain_weight.parse()
[0m[32m+        let weight: Decimal = grain_weight
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid grain weight".into()))?;
[31m-        let ratio_val: Decimal = ratio.parse()
[0m[32m+        let ratio_val: Decimal = ratio
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid ratio".into()))?;
 
         if weight <= Decimal::ZERO {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\mash.rs:66:
         let strike_temp = target + (thermal_constant * temp_diff);
 
         let mut result = CalcResult::new(Measurement::new(strike_temp, Unit::Celsius))
[31m-            .with_meta("strike_temperature", format!("{:.1}┬░C / {:.1}┬░F",
[0m[31m-                                                     strike_temp, strike_temp * Decimal::new(9, 0) / Decimal::new(5, 0) + Decimal::from(32)))
[0m[31m-            .with_meta("water_volume", format!("{:.2} L / {:.2} gal",
[0m[31m-                                               water_volume, water_volume * Decimal::new(264172, 6)))
[0m[32m+            .with_meta(
[0m[32m+                "strike_temperature",
[0m[32m+                format!(
[0m[32m+                    "{:.1}┬░C / {:.1}┬░F",
[0m[32m+                    strike_temp,
[0m[32m+                    strike_temp * Decimal::new(9, 0) / Decimal::new(5, 0) + Decimal::from(32)
[0m[32m+                ),
[0m[32m+            )
[0m[32m+            .with_meta(
[0m[32m+                "water_volume",
[0m[32m+                format!(
[0m[32m+                    "{:.2} L / {:.2} gal",
[0m[32m+                    water_volume,
[0m[32m+                    water_volume * Decimal::new(264172, 6)
[0m[32m+                ),
[0m[32m+            )
[0m             .with_meta("mash_ratio", format!("{:.2} L/kg", ratio_val))
             .with_meta("target_mash_temp", format!("{:.1}┬░C", target))
             .with_meta("grain_temperature", format!("{:.1}┬░C", grain_t));
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\mash.rs:108:
 }
 
 register_calculator!(MashCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\melomel.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 use std::str::FromStr;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\melomel.rs:29:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
[31m-        let fruit_weight = input.get_param("fruit_weight")
[0m[32m+        let fruit_weight = input
[0m[32m+            .get_param("fruit_weight")
[0m             .ok_or_else(|| Error::MissingInput("fruit_weight required".into()))?;
         let fruit_type = input.get_param("fruit_type").unwrap_or("strawberry");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\melomel.rs:40:
[31m-        let vol: Decimal = Decimal::from_str(volume)
[0m[31m-            .map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[31m-        let abv: Decimal = Decimal::from_str(target_abv)
[0m[31m-            .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m[32m+        let vol: Decimal =
[0m[32m+            Decimal::from_str(volume).map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[32m+        let abv: Decimal =
[0m[32m+            Decimal::from_str(target_abv).map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m         let fruit_kg: Decimal = Decimal::from_str(fruit_weight)
             .map_err(|_| Error::Parse("Invalid fruit_weight".into()))?;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\melomel.rs:74:
             .with_meta("fruit_weight_kg", format!("{:.2} kg", fruit_kg))
             .with_meta("fruit_sugar_g", format!("{:.0} g", fruit_sugar_g))
             .with_meta("fruit_abv", format!("{:.1}%", fruit_abv))
[31m-            .with_meta("honey_kg", format!("{:.2} kg", honey_sugar_g / Decimal::from(1000)));
[0m[32m+            .with_meta(
[0m[32m+                "honey_kg",
[0m[32m+                format!("{:.2} kg", honey_sugar_g / Decimal::from(1000)),
[0m[32m+            );
[0m 
         if fruit_kg / vol < Decimal::new(5, 1) {
             result = result.with_warning("Low fruit ratio - may have weak fruit character");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\melomel.rs:85:
 }
 
 register_calculator!(MelomelCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\metheglin.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 use std::str::FromStr;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\metheglin.rs:29:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
         let spice_level = input.get_param("spice_level").unwrap_or("medium");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\metheglin.rs:38:
[31m-        let vol: Decimal = Decimal::from_str(volume)
[0m[31m-            .map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[31m-        let abv: Decimal = Decimal::from_str(target_abv)
[0m[31m-            .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m[32m+        let vol: Decimal =
[0m[32m+            Decimal::from_str(volume).map_err(|_| Error::Parse("Invalid volume".into()))?;
[0m[32m+        let abv: Decimal =
[0m[32m+            Decimal::from_str(target_abv).map_err(|_| Error::Parse("Invalid target_abv".into()))?;
[0m 
         // FIXED: 33 g per L per % ABV
         let honey_needed = vol * abv * Decimal::from(33);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\metheglin.rs:55:
         let mut result = CalcResult::new(Measurement::new(honey_needed, Unit::Grams));
 
         result = result
[31m-            .with_meta("honey_kg", format!("{:.2} kg", honey_needed / Decimal::from(1000)))
[0m[32m+            .with_meta(
[0m[32m+                "honey_kg",
[0m[32m+                format!("{:.2} kg", honey_needed / Decimal::from(1000)),
[0m[32m+            )
[0m             .with_meta("spice_g", format!("{:.1} g", spice_needed))
             .with_meta("spice_level", spice_level)
             .with_meta("dosage", format!("{:.1} g/L", spice_per_liter));
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\metheglin.rs:62:
 
[31m-        result = result.with_warning("Dosage varies by spice - start conservative, can always add more");
[0m[32m+        result =
[0m[32m+            result.with_warning("Dosage varies by spice - start conservative, can always add more");
[0m 
         Ok(result)
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\metheglin.rs:67:
 }
 
 register_calculator!(MetheglinCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:1:
 // TOSNA Nutrition Calculator - FIXED with calculated sugar breaks
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:30:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
         let yn_requirement = input.get_param("yn_requirement").unwrap_or("medium");
         let protocol = input.get_param("protocol").unwrap_or("tosna_2");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:39:
 
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
[31m-        let abv: Decimal = target_abv.parse()
[0m[32m+        let abv: Decimal = target_abv
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
 
         // Estimate OG from target ABV (assuming ~85% attenuation)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:47:
         let gravity_points = (estimated_og - Decimal::ONE) * Decimal::from(1000);
 
         // CALCULATE ACTUAL SUGAR BREAK GRAVITIES
[31m-        let break_1_3 = estimated_og - (gravity_points * Decimal::new(333, 3)) / Decimal::from(1000);
[0m[31m-        let break_2_3 = estimated_og - (gravity_points * Decimal::new(667, 3)) / Decimal::from(1000);
[0m[32m+        let break_1_3 =
[0m[32m+            estimated_og - (gravity_points * Decimal::new(333, 3)) / Decimal::from(1000);
[0m[32m+        let break_2_3 =
[0m[32m+            estimated_og - (gravity_points * Decimal::new(667, 3)) / Decimal::from(1000);
[0m 
         // Pre-format strings for meta_keys (avoids lifetime issues)
         let break_1_3_str = format!("1/3 sugar break (~{:.3})", break_1_3);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:73:
                 let a2 = total_fermaid_o * Decimal::new(333, 3);
                 let a3 = total_fermaid_o - a1 - a2;
                 (
[31m-                    a1, a2, a3, Decimal::ZERO,
[0m[32m+                    a1,
[0m[32m+                    a2,
[0m[32m+                    a3,
[0m[32m+                    Decimal::ZERO,
[0m                     "TOSNA 1.0",
                     vec![
                         ("addition_1_24hrs", "33%", "At pitch + 24 hours"),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:80:
                         ("addition_2_day_3", "33%", "Day 3"),
[31m-                        ("addition_3_day_7", "34%", "Day 7")
[0m[31m-                    ]
[0m[32m+                        ("addition_3_day_7", "34%", "Day 7"),
[0m[32m+                    ],
[0m                 )
[31m-            },
[0m[32m+            }
[0m             "tosna_3" => {
                 let a1 = total_fermaid_o * Decimal::new(5, 2);
                 let a2 = total_fermaid_o * Decimal::new(20, 2);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:88:
                 let a3 = total_fermaid_o * Decimal::new(50, 2);
                 let a4 = total_fermaid_o * Decimal::new(25, 2);
                 (
[31m-                    a1, a2, a3, a4,
[0m[32m+                    a1,
[0m[32m+                    a2,
[0m[32m+                    a3,
[0m[32m+                    a4,
[0m                     "TOSNA 3.0",
                     vec![
                         ("addition_1_24hrs", "5%", "24 hours after pitch"),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:95:
                         ("addition_2_48hrs", "20%", "48 hours after pitch"),
                         ("addition_3_1/3_break", "50%", break_1_3_str.as_str()),
[31m-                        ("addition_4_2/3_break", "25%", break_2_3_str.as_str())
[0m[31m-                    ]
[0m[32m+                        ("addition_4_2/3_break", "25%", break_2_3_str.as_str()),
[0m[32m+                    ],
[0m                 )
[31m-            },
[0m[32m+            }
[0m             _ => {
                 // TOSNA 2.0 (default): 25%-50%-25%
                 let a1 = total_fermaid_o * Decimal::new(25, 2);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:104:
                 let a2 = total_fermaid_o * Decimal::new(50, 2);
                 let a3 = total_fermaid_o * Decimal::new(25, 2);
                 (
[31m-                    a1, a2, a3, Decimal::ZERO,
[0m[32m+                    a1,
[0m[32m+                    a2,
[0m[32m+                    a3,
[0m[32m+                    Decimal::ZERO,
[0m                     "TOSNA 2.0",
                     vec![
                         ("addition_1_24hrs", "25%", "24 hours after pitch"),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:111:
                         ("addition_2_1/3_break", "50%", break_1_3_str.as_str()),
[31m-                        ("addition_3_2/3_break", "25%", break_2_3_str.as_str())
[0m[31m-                    ]
[0m[32m+                        ("addition_3_2/3_break", "25%", break_2_3_str.as_str()),
[0m[32m+                    ],
[0m                 )
             }
         };
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:133:
             };
 
             if amount > Decimal::ZERO {
[31m-                result = result.with_meta(
[0m[31m-                    *key,
[0m[31m-                    format!("{:.2} g ({}) - {}", amount, pct, timing)
[0m[31m-                );
[0m[32m+                result = result.with_meta(*key, format!("{:.2} g ({}) - {}", amount, pct, timing));
[0m             }
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:144:
 
         // Warnings
         if protocol == "tosna_3" && estimated_og < Decimal::new(1100, 3) {
[31m-            result = result.with_warning("TOSNA 3.0 designed for high-gravity (OG >1.100) - consider TOSNA 2.0");
[0m[32m+            result = result.with_warning(
[0m[32m+                "TOSNA 3.0 designed for high-gravity (OG >1.100) - consider TOSNA 2.0",
[0m[32m+            );
[0m         }
         if protocol == "tosna_1" {
[31m-            result = result.with_warning("TOSNA 1.0 is older protocol - TOSNA 2.0 or 3.0 recommended for better results");
[0m[32m+            result = result.with_warning(
[0m[32m+                "TOSNA 1.0 is older protocol - TOSNA 2.0 or 3.0 recommended for better results",
[0m[32m+            );
[0m         }
         if abv > Decimal::from(18) {
             result = result.with_warning("ABV >18% - consider staggered yeast pitch or TOSNA 3.0");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\nutrition.rs:183:
 }
 
 register_calculator!(NutritionCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\oxymel.rs:1:
 //! Oxymel calculator - vinegar/honey beverage
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\oxymel.rs:30:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let vinegar_percent = input.get_param("vinegar_percent")
[0m[32m+        let vinegar_percent = input
[0m[32m+            .get_param("vinegar_percent")
[0m             .ok_or_else(|| Error::MissingInput("vinegar_percent required".into()))?;
[31m-        let honey_percent = input.get_param("honey_percent")
[0m[32m+        let honey_percent = input
[0m[32m+            .get_param("honey_percent")
[0m             .ok_or_else(|| Error::MissingInput("honey_percent required".into()))?;
 
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
[31m-        let vin_pct: Decimal = vinegar_percent.parse()
[0m[32m+        let vin_pct: Decimal = vinegar_percent
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid vinegar_percent".into()))?;
[31m-        let hon_pct: Decimal = honey_percent.parse()
[0m[32m+        let hon_pct: Decimal = honey_percent
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid honey_percent".into()))?;
 
         // Traditional oxymel: 1 part honey to 4 parts vinegar (20% honey, 80% vinegar)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\oxymel.rs:61:
         // Validate ratios
         if vin_pct + hon_pct > Decimal::from(100) {
             return Err(Error::Validation(
[31m-                "Vinegar + honey percentages cannot exceed 100%".into()
[0m[32m+                "Vinegar + honey percentages cannot exceed 100%".into(),
[0m             ));
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\oxymel.rs:128:
 }
 
 register_calculator!(OxymelCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:1:
 //! Pasteurization calculator - PU-based bottle pasteurization
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 use rust_decimal::prelude::ToPrimitive;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:31:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let temp_c = input.get_param("temperature")
[0m[32m+        let temp_c = input
[0m[32m+            .get_param("temperature")
[0m             .ok_or_else(|| Error::MissingInput("temperature required (Celsius)".into()))?;
         let target_pu = input.get_param("target_pu").unwrap_or("50");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:38:
[31m-        let temp: Decimal = temp_c.parse()
[0m[32m+        let temp: Decimal = temp_c
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid temperature".into()))?;
[31m-        let pu_target: Decimal = target_pu.parse()
[0m[32m+        let pu_target: Decimal = target_pu
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target_pu".into()))?;
 
         // Validate temperature range
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:44:
         if temp < Decimal::from(60) {
             return Err(Error::Validation(
[31m-                "Temperature too low for pasteurization (min 60┬░C / 140┬░F)".into()
[0m[32m+                "Temperature too low for pasteurization (min 60┬░C / 140┬░F)".into(),
[0m             ));
         }
         if temp > Decimal::from(75) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:50:
             return Err(Error::Validation(
[31m-                "Temperature too high - risk of flavor damage and bottle bombs (max 75┬░C / 167┬░F)".into()
[0m[32m+                "Temperature too high - risk of flavor damage and bottle bombs (max 75┬░C / 167┬░F)"
[0m[32m+                    .into(),
[0m             ));
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:61:
         let base_f64 = base.to_f64().unwrap_or(1.393);
         let exp_f64 = exponent.to_f64().unwrap_or(0.0);
         let lethal_rate_f64 = base_f64.powf(exp_f64);
[31m-        let lethal_rate = Decimal::from_f64_retain(lethal_rate_f64)
[0m[31m-            .unwrap_or(Decimal::ONE);
[0m[32m+        let lethal_rate = Decimal::from_f64_retain(lethal_rate_f64).unwrap_or(Decimal::ONE);
[0m 
         // Calculate hold time: t = target_PU / lethal_rate
         let hold_time_min = pu_target / lethal_rate;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:74:
 
         result = result
             .with_meta("hold_time_min", format!("{:.2} minutes", hold_time_min))
[31m-            .with_meta("hold_time_sec", format!("{:.0} seconds", hold_time_min * Decimal::from(60)))
[0m[32m+            .with_meta(
[0m[32m+                "hold_time_sec",
[0m[32m+                format!("{:.0} seconds", hold_time_min * Decimal::from(60)),
[0m[32m+            )
[0m             .with_meta("temperature_c", format!("{:.1}┬░C", temp))
             .with_meta("temperature_f", format!("{:.1}┬░F", temp_f))
             .with_meta("target_pu", format!("{} PU", pu_target))
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:81:
             .with_meta("lethal_rate", format!("{:.2} PU/min", lethal_rate))
[31m-            .with_meta("method", "In-bottle pasteurization (PU-based hot water bath)")
[0m[31m-            .with_meta("calculation", format!("PU = t ├ù 1.393^(T-60) = {:.1} ├ù {:.2} = {:.1}",
[0m[31m-                                              hold_time_min, lethal_rate, hold_time_min * lethal_rate));
[0m[32m+            .with_meta(
[0m[32m+                "method",
[0m[32m+                "In-bottle pasteurization (PU-based hot water bath)",
[0m[32m+            )
[0m[32m+            .with_meta(
[0m[32m+                "calculation",
[0m[32m+                format!(
[0m[32m+                    "PU = t ├ù 1.393^(T-60) = {:.1} ├ù {:.2} = {:.1}",
[0m[32m+                    hold_time_min,
[0m[32m+                    lethal_rate,
[0m[32m+                    hold_time_min * lethal_rate
[0m[32m+                ),
[0m[32m+            );
[0m 
         // Critical warnings
         result = result.with_warning("ΓÜá∩╕Å CRITICAL: Hold time starts when INTERNAL LIQUID reaches target temp (use sacrificial/probed bottle)");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:90:
 
         // Purpose clarification
         result = result.with_meta("purpose", "Beverage stabilization: primarily yeast control to prevent refermentation/over-carbonation");
[31m-        result = result.with_meta("safety_note", "Reduces spoilage microbes (NOT sterilization)");
[0m[32m+        result = result.with_meta(
[0m[32m+            "safety_note",
[0m[32m+            "Reduces spoilage microbes (NOT sterilization)",
[0m[32m+        );
[0m 
         // Common PU targets
         if pu_target == Decimal::from(30) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:97:
[31m-            result = result.with_meta("pu_level", "30 PU: Light pasteurization (minimal yeast control)");
[0m[32m+            result = result.with_meta(
[0m[32m+                "pu_level",
[0m[32m+                "30 PU: Light pasteurization (minimal yeast control)",
[0m[32m+            );
[0m         } else if pu_target == Decimal::from(50) {
[31m-            result = result.with_meta("pu_level", "50 PU: Standard pasteurization (good yeast control)");
[0m[32m+            result = result.with_meta(
[0m[32m+                "pu_level",
[0m[32m+                "50 PU: Standard pasteurization (good yeast control)",
[0m[32m+            );
[0m         } else if pu_target >= Decimal::from(76) {
[31m-            result = result.with_meta("pu_level", "76+ PU: Heavy pasteurization (maximum yeast kill)");
[0m[32m+            result = result.with_meta(
[0m[32m+                "pu_level",
[0m[32m+                "76+ PU: Heavy pasteurization (maximum yeast kill)",
[0m[32m+            );
[0m         }
 
         // Temperature-specific warnings
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:105:
         if temp >= Decimal::from(70) {
[31m-            result = result.with_warning("High temperature (ΓëÑ70┬░C) - watch for caramelization and off-flavors");
[0m[32m+            result = result.with_warning(
[0m[32m+                "High temperature (ΓëÑ70┬░C) - watch for caramelization and off-flavors",
[0m[32m+            );
[0m         }
 
         if hold_time_min > Decimal::from(30) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:110:
[31m-            result = result.with_warning("Long hold time - consider higher temperature for shorter duration");
[0m[32m+            result = result
[0m[32m+                .with_warning("Long hold time - consider higher temperature for shorter duration");
[0m         } else if hold_time_min < Decimal::from(5) {
[31m-            result = result.with_warning("Very short hold time - ensure accurate temperature control");
[0m[32m+            result =
[0m[32m+                result.with_warning("Very short hold time - ensure accurate temperature control");
[0m         }
 
         Ok(result)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:117:
 
     fn validate(&self, input: &CalcInput) -> Result<()> {
         if input.get_param("temperature").is_none() {
[31m-            return Err(Error::MissingInput("temperature required (in Celsius)".into()));
[0m[32m+            return Err(Error::MissingInput(
[0m[32m+                "temperature required (in Celsius)".into(),
[0m[32m+            ));
[0m         }
         Ok(())
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pasteurization.rs:124:
 }
 
 register_calculator!(PasteurizationCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\plato_to_sg.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Measurement, Result, Unit, Validator,
[0m[32m+    CalcInput, CalcResult, Calculator, Measurement, Result, Unit, Validator, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\plato_to_sg.rs:37:
 }
 
 register_calculator!(PlatoToSgCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\priming_alternatives.rs:1:
 //! Priming sugar alternatives calculator
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\priming_alternatives.rs:33:
         let sugar_type = input.get_param("sugar_type").unwrap_or("corn_sugar");
         let amount = input.get_param("amount").unwrap_or("100");
 
[31m-        let amt: Decimal = amount.parse()
[0m[32m+        let amt: Decimal = amount
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid amount".into()))?;
 
         if amt <= Decimal::ZERO {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\priming_alternatives.rs:42:
 
         // Conversion factors relative to corn sugar (dextrose = 1.0)
         let from_factor = match sugar_type {
[31m-            "table_sugar" => Decimal::new(91, 2),  // 0.91x (sucrose more fermentable)
[0m[31m-            "dme" => Decimal::new(135, 2),          // 1.35x (less fermentable)
[0m[31m-            "honey" => Decimal::new(125, 2),        // 1.25x
[0m[31m-            _ => Decimal::ONE,                      // corn_sugar default
[0m[32m+            "table_sugar" => Decimal::new(91, 2), // 0.91x (sucrose more fermentable)
[0m[32m+            "dme" => Decimal::new(135, 2),        // 1.35x (less fermentable)
[0m[32m+            "honey" => Decimal::new(125, 2),      // 1.25x
[0m[32m+            _ => Decimal::ONE,                    // corn_sugar default
[0m         };
 
         // Convert input to corn sugar equivalent
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\priming_alternatives.rs:77:
 }
 
 register_calculator!(PrimingAlternativesCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pyment.rs:1:
 //! Pyment calculator - grape-honey wine (wine-mead hybrid)
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pyment.rs:36:
         let target_abv = input
             .get_param("target_abv")
             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
[31m-        let juice_percent = input
[0m[31m-            .get_param("juice_percent")
[0m[31m-            .unwrap_or("40"); // Default 40% grape juice
[0m[32m+        let juice_percent = input.get_param("juice_percent").unwrap_or("40"); // Default 40% grape juice
[0m 
         let vol: Decimal = volume
             .parse()
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pyment.rs:74:
         let mut result = CalcResult::new(Measurement::new(honey_needed_g, Unit::Grams));
 
         if abv < Decimal::from(8) {
[31m-            result = result.with_warning("Low ABV (<8%) - consider increasing target or juice percentage");
[0m[32m+            result = result
[0m[32m+                .with_warning("Low ABV (<8%) - consider increasing target or juice percentage");
[0m         }
 
         if abv > Decimal::from(18) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pyment.rs:100:
             .with_meta("abv_from_honey", format!("{:.1}%", abv_from_honey))
             .with_meta("total_abv", format!("{:.1}%", abv))
             .with_meta("volume", format!("{:.2} L", vol))
[31m-            .with_meta("tip", "Use quality grape juice or wine must. Red or white grapes both work.");
[0m[32m+            .with_meta(
[0m[32m+                "tip",
[0m[32m+                "Use quality grape juice or wine must. Red or white grapes both work.",
[0m[32m+            );
[0m 
         Ok(result)
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\pyment.rs:117:
 }
 
 register_calculator!(PymentCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\refractometer.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\refractometer.rs:29:
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
         let orig_brix_meas = input.get_measurement(Unit::Brix)?;
[31m-        let current_brix = input.get_param("current_brix")
[0m[32m+        let current_brix = input
[0m[32m+            .get_param("current_brix")
[0m             .ok_or_else(|| Error::MissingInput("current_brix required".into()))?;
 
         let ob = orig_brix_meas.value;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\refractometer.rs:36:
[31m-        let cb: Decimal = current_brix.parse()
[0m[32m+        let cb: Decimal = current_brix
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid current_brix".into()))?;
 
         let ob_f64 = ob.to_string().parse::<f64>().unwrap_or(0.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\refractometer.rs:40:
         let cb_f64 = cb.to_string().parse::<f64>().unwrap_or(0.0);
 
[31m-        let fg_f64 = 1.0000
[0m[31m-            - (0.0044993 * ob_f64)
[0m[31m-            + (0.011774 * cb_f64)
[0m[31m-            + (0.00027581 * ob_f64 * ob_f64)
[0m[31m-            - (0.0012717 * cb_f64 * cb_f64)
[0m[31m-            - (0.0000072800 * ob_f64 * ob_f64 * ob_f64)
[0m[31m-            + (0.000063293 * cb_f64 * cb_f64 * cb_f64);
[0m[32m+        let fg_f64 =
[0m[32m+            1.0000 - (0.0044993 * ob_f64) + (0.011774 * cb_f64) + (0.00027581 * ob_f64 * ob_f64)
[0m[32m+                - (0.0012717 * cb_f64 * cb_f64)
[0m[32m+                - (0.0000072800 * ob_f64 * ob_f64 * ob_f64)
[0m[32m+                + (0.000063293 * cb_f64 * cb_f64 * cb_f64);
[0m 
         let fg = Decimal::from_f64_retain(fg_f64).unwrap_or(Decimal::ONE);
         let abv = (ob - cb) * Decimal::new(55, 2);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\refractometer.rs:62:
             .with_meta("formula", "Terrill Cubic");
 
         if cb > ob {
[31m-            result = result.with_warning("Current Brix higher than original - fermentation may not have started");
[0m[32m+            result = result.with_warning(
[0m[32m+                "Current Brix higher than original - fermentation may not have started",
[0m[32m+            );
[0m         }
         if abv > Decimal::from(18) {
             result = result.with_warning("ABV >18% - equation accuracy decreases");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\refractometer.rs:84:
 }
 
 register_calculator!(RefractometerCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sack.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sack.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target_abv = input.get_param("target_abv")
[0m[32m+        let target_abv = input
[0m[32m+            .get_param("target_abv")
[0m             .ok_or_else(|| Error::MissingInput("target_abv required".into()))?;
 
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
[31m-        let abv: Decimal = target_abv.parse()
[0m[32m+        let abv: Decimal = target_abv
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target_abv".into()))?;
 
         // FIXED: 33 g honey per liter per % ABV
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sack.rs:43:
 
         let mut result = CalcResult::new(Measurement::new(honey_needed, Unit::Grams));
 
[31m-        result = result.with_meta("honey_kg", format!("{:.2} kg", honey_needed / Decimal::from(1000)));
[0m[32m+        result = result.with_meta(
[0m[32m+            "honey_kg",
[0m[32m+            format!("{:.2} kg", honey_needed / Decimal::from(1000)),
[0m[32m+        );
[0m 
         if abv < Decimal::from(14) {
             result = result.with_warning("Below typical sack mead range (14-18%)");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sack.rs:57:
 }
 
 register_calculator!(SackCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sg_correction.rs:1:
 // Temperature correction for specific gravity readings.
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sg_correction.rs:67:
 }
 
 register_calculator!(SgCorrectionCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sg_to_brix.rs:1:
 // Convert specific gravity to degrees Brix using cubic polynomial.
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Measurement, Result, Unit,
[0m[31m-    Validator,
[0m[32m+    CalcInput, CalcResult, Calculator, Measurement, Result, Unit, Validator, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sg_to_brix.rs:43:
         // Convert to f64 for polynomial calculation
         let sg_f64 = sg.to_string().parse::<f64>().unwrap_or(1.0);
 
[31m-        let brix_f64 = -676.67
[0m[31m-            + (1286.4 * sg_f64)
[0m[31m-            - (800.47 * sg_f64 * sg_f64)
[0m[32m+        let brix_f64 = -676.67 + (1286.4 * sg_f64) - (800.47 * sg_f64 * sg_f64)
[0m             + (190.74 * sg_f64 * sg_f64 * sg_f64);
 
         let brix = Decimal::from_f64_retain(brix_f64).unwrap_or(Decimal::ZERO);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sg_to_brix.rs:60:
             .with_meta("sg", format!("{:.4}", sg))
             .with_meta("brix", format!("{:.2}┬░Bx", brix))
             .with_meta("formula", "Cubic polynomial (accurate)")
[31m-            .with_meta("calculation", "ΓêÆ676.67 + 1286.4┬╖SG ΓêÆ 800.47┬╖SG┬▓ + 190.74┬╖SG┬│");
[0m[32m+            .with_meta(
[0m[32m+                "calculation",
[0m[32m+                "ΓêÆ676.67 + 1286.4┬╖SG ΓêÆ 800.47┬╖SG┬▓ + 190.74┬╖SG┬│",
[0m[32m+            );
[0m 
         Ok(result)
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sg_to_brix.rs:72:
 }
 
 register_calculator!(SgToBrixCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\srm.rs:2:
 //! Morey equation: SRM = 1.4922 ├ù (MCU^0.6859)
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\srm.rs:31:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let grain_weight = input.get_param("grain_weight")
[0m[32m+        let grain_weight = input
[0m[32m+            .get_param("grain_weight")
[0m             .ok_or_else(|| Error::MissingInput("grain_weight required".into()))?;
[31m-        let lovibond = input.get_param("lovibond")
[0m[32m+        let lovibond = input
[0m[32m+            .get_param("lovibond")
[0m             .ok_or_else(|| Error::MissingInput("lovibond required".into()))?;
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
 
[31m-        let weight: Decimal = grain_weight.parse()
[0m[32m+        let weight: Decimal = grain_weight
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid grain weight".into()))?;
[31m-        let color: Decimal = lovibond.parse()
[0m[32m+        let color: Decimal = lovibond
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid lovibond".into()))?;
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
 
         if weight <= Decimal::ZERO {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\srm.rs:104:
 }
 
 register_calculator!(SrmCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\stabilization.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\stabilization.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
         let ph_meas = input.get_measurement(Unit::Ph);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\stabilization.rs:35:
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
 
         // K-meta (potassium metabisulfite): 0.5 g/L standard dose
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\stabilization.rs:45:
 
         result = result
             .with_meta("kmeta_g", format!("{:.1} g", kmeta))
[31m-            .with_meta("kmeta_tsp", format!("{:.2} tsp", kmeta / Decimal::new(5, 0)))
[0m[32m+            .with_meta(
[0m[32m+                "kmeta_tsp",
[0m[32m+                format!("{:.2} tsp", kmeta / Decimal::new(5, 0)),
[0m[32m+            )
[0m             .with_meta("sorbate_g", format!("{:.1} g", sorbate))
[31m-            .with_meta("sorbate_tsp", format!("{:.2} tsp", sorbate / Decimal::new(5, 0)))
[0m[32m+            .with_meta(
[0m[32m+                "sorbate_tsp",
[0m[32m+                format!("{:.2} tsp", sorbate / Decimal::new(5, 0)),
[0m[32m+            )
[0m             .with_meta("volume_L", format!("{} L", vol));
 
         // pH-dependent warning
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\stabilization.rs:54:
         if let Ok(ph) = ph_meas {
             if ph.value > Decimal::new(36, 1) {
[31m-                result = result.with_warning("pH > 3.6 - sorbate less effective, may produce geranium off-flavor");
[0m[32m+                result = result.with_warning(
[0m[32m+                    "pH > 3.6 - sorbate less effective, may produce geranium off-flavor",
[0m[32m+                );
[0m             }
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\stabilization.rs:60:
[31m-        result = result.with_warning("CRITICAL: Add K-meta 24 hours before sorbate to kill remaining yeast");
[0m[32m+        result = result
[0m[32m+            .with_warning("CRITICAL: Add K-meta 24 hours before sorbate to kill remaining yeast");
[0m         result = result.with_warning("Stabilization prevents re-fermentation for backsweetening");
 
         Ok(result)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\stabilization.rs:65:
 }
 
 register_calculator!(StabilizationCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sulfite.rs:2:
 //! FIXED: Now returns correct grams value
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sulfite.rs:32:
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
         let ph_meas = input.get_measurement(Unit::Ph)?;
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let target = input.get_param("target_free_so2")
[0m[32m+        let target = input
[0m[32m+            .get_param("target_free_so2")
[0m             .ok_or_else(|| Error::MissingInput("target_free_so2 required".into()))?;
 
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
[31m-        let targ: Decimal = target.parse()
[0m[32m+        let targ: Decimal = target
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target".into()))?;
         let ph = ph_meas.value;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sulfite.rs:63:
 
         result = result
             .with_meta("kmeta_g", format!("{:.2} g", kmeta_g))
[31m-            .with_meta("kmeta_tsp", format!("{:.2} tsp", kmeta_g / Decimal::from(5)))
[0m[32m+            .with_meta(
[0m[32m+                "kmeta_tsp",
[0m[32m+                format!("{:.2} tsp", kmeta_g / Decimal::from(5)),
[0m[32m+            )
[0m             .with_meta("volume_L", format!("{:.2} L", vol))
             .with_meta("target_so2_ppm", format!("{} ppm", targ))
             .with_meta("ph", format!("{:.2}", ph))
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sulfite.rs:70:
             .with_meta("effectiveness", effectiveness)
[31m-            .with_meta("tip", "Add K-meta 24 hours before sorbate. Dissolve in small amount of water first.");
[0m[32m+            .with_meta(
[0m[32m+                "tip",
[0m[32m+                "Add K-meta 24 hours before sorbate. Dissolve in small amount of water first.",
[0m[32m+            );
[0m 
         if ph > Decimal::new(38, 1) {
[31m-            result = result.with_warning("High pH reduces sulfite effectiveness - consider adjusting pH first");
[0m[32m+            result = result.with_warning(
[0m[32m+                "High pH reduces sulfite effectiveness - consider adjusting pH first",
[0m[32m+            );
[0m         }
 
         if targ > Decimal::from(80) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\sulfite.rs:94:
 }
 
 register_calculator!(SulfiteCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\tannin.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\tannin.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
         let tannin_level = input.get_param("tannin_level").unwrap_or("medium");
         let tannin_type = input.get_param("tannin_type").unwrap_or("wine_tannin");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\tannin.rs:35:
 
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
 
         // Tannin dosage per liter
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\tannin.rs:40:
         let dosage_per_liter = match tannin_level {
[31m-            "low" => Decimal::new(5, 2),       // 0.05 g/L
[0m[31m-            "medium" => Decimal::new(10, 2),   // 0.10 g/L
[0m[31m-            "high" => Decimal::new(15, 2),     // 0.15 g/L
[0m[32m+            "low" => Decimal::new(5, 2),     // 0.05 g/L
[0m[32m+            "medium" => Decimal::new(10, 2), // 0.10 g/L
[0m[32m+            "high" => Decimal::new(15, 2),   // 0.15 g/L
[0m             _ => Decimal::new(10, 2),
         };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\tannin.rs:58:
 
         result = result
             .with_meta("tannin_g", format!("{:.2} g", tannin_needed))
[31m-            .with_meta("tannin_tsp", format!("{:.3} tsp", tannin_needed / Decimal::new(5, 0)))
[0m[32m+            .with_meta(
[0m[32m+                "tannin_tsp",
[0m[32m+                format!("{:.3} tsp", tannin_needed / Decimal::new(5, 0)),
[0m[32m+            )
[0m             .with_meta("tannin_type", tannin_description)
             .with_meta("tannin_level", tannin_level)
             .with_meta("dosage", format!("{:.2} g/L", dosage_per_liter));
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\tannin.rs:65:
 
         result = result.with_warning("Add gradually, taste after 24 hours - easy to over-tannin");
[31m-        result = result.with_warning("Tannin adds astringency/dryness - use sparingly in sweet meads");
[0m[32m+        result =
[0m[32m+            result.with_warning("Tannin adds astringency/dryness - use sparingly in sweet meads");
[0m 
         Ok(result)
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\tannin.rs:71:
 }
 
 register_calculator!(TanninCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\upscaling.rs:2:
 //! Scale recipes up or down while maintaining proportions
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\upscaling.rs:32:
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
         // Required parameters
[31m-        let current_vol = input.get_param("current_volume")
[0m[32m+        let current_vol = input
[0m[32m+            .get_param("current_volume")
[0m             .ok_or_else(|| Error::MissingInput("current_volume required".into()))?;
[31m-        let target_vol = input.get_param("target_volume")
[0m[32m+        let target_vol = input
[0m[32m+            .get_param("target_volume")
[0m             .ok_or_else(|| Error::MissingInput("target_volume required".into()))?;
 
[31m-        let current: Decimal = current_vol.parse()
[0m[32m+        let current: Decimal = current_vol
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid current_volume".into()))?;
[31m-        let target: Decimal = target_vol.parse()
[0m[32m+        let target: Decimal = target_vol
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid target_volume".into()))?;
 
         if current <= Decimal::ZERO || target <= Decimal::ZERO {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\upscaling.rs:113:
 
         // Add scaled ingredients to metadata
         for (name, original, scaled) in &scaled_ingredients {
[31m-            result = result.with_meta(
[0m[31m-                &format!("{}_original", name),
[0m[31m-                format!("{:.2}", original)
[0m[31m-            ).with_meta(
[0m[31m-                &format!("{}_scaled", name),
[0m[31m-                format!("{:.2}", scaled)
[0m[31m-            );
[0m[32m+            result = result
[0m[32m+                .with_meta(&format!("{}_original", name), format!("{:.2}", original))
[0m[32m+                .with_meta(&format!("{}_scaled", name), format!("{:.2}", scaled));
[0m         }
 
         // Warnings
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\upscaling.rs:140:
 }
 
 register_calculator!(UpscalingCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\volume_adjustment.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\volume_adjustment.rs:64:
         let mut result = CalcResult::new(Measurement::new(water_to_add, Unit::Liters));
 
         if water_to_add > vol {
[31m-            result = result.with_warning("Adding more water than original volume - double-check target");
[0m[32m+            result =
[0m[32m+                result.with_warning("Adding more water than original volume - double-check target");
[0m         }
 
         result = result
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\volume_adjustment.rs:91:
 }
 
 register_calculator!(VolumeAdjustmentCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:2:
 //! Track losses through entire brewing process - racking, lees, clarification, filtration
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:31:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let initial_volume = input.get_param("initial_volume")
[0m[32m+        let initial_volume = input
[0m[32m+            .get_param("initial_volume")
[0m             .ok_or_else(|| Error::MissingInput("initial_volume required".into()))?;
 
[31m-        let num_rackings = input.get_param("num_rackings")
[0m[31m-            .unwrap_or("3"); // Default 3 rackings
[0m[32m+        let num_rackings = input.get_param("num_rackings").unwrap_or("3"); // Default 3 rackings
[0m 
[31m-        let vessel_type = input.get_param("vessel_type")
[0m[31m-            .unwrap_or("carboy"); // carboy, bucket, keg, barrel
[0m[32m+        let vessel_type = input.get_param("vessel_type").unwrap_or("carboy"); // carboy, bucket, keg, barrel
[0m 
[31m-        let process_type = input.get_param("process_type")
[0m[31m-            .unwrap_or("standard"); // standard, filtered, fined, none
[0m[32m+        let process_type = input.get_param("process_type").unwrap_or("standard"); // standard, filtered, fined, none
[0m 
[31m-        let vol_l: Decimal = initial_volume.parse()
[0m[32m+        let vol_l: Decimal = initial_volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
 
[31m-        let rackings: i32 = num_rackings.parse()
[0m[32m+        let rackings: i32 = num_rackings
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid number of rackings".into()))?;
 
         if vol_l <= Decimal::ZERO {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:62:
 
         // Gross lees (primary fermentation) - highest loss
         let gross_lees_loss_l = match vessel_type {
[31m-            "bucket" => vol_l * Decimal::new(8, 2),    // 8% - wide bottom
[0m[31m-            "carboy" => vol_l * Decimal::new(6, 2),    // 6% - narrow neck
[0m[31m-            "keg" => vol_l * Decimal::new(5, 2),       // 5% - conical
[0m[31m-            "barrel" => vol_l * Decimal::new(7, 2),    // 7% - wood absorption
[0m[32m+            "bucket" => vol_l * Decimal::new(8, 2), // 8% - wide bottom
[0m[32m+            "carboy" => vol_l * Decimal::new(6, 2), // 6% - narrow neck
[0m[32m+            "keg" => vol_l * Decimal::new(5, 2),    // 5% - conical
[0m[32m+            "barrel" => vol_l * Decimal::new(7, 2), // 7% - wood absorption
[0m             _ => vol_l * Decimal::new(6, 2),
         };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:72:
         // Fine lees (secondary+ rackings) - lower loss per racking
         let fine_lees_loss_per_racking_l = match vessel_type {
[31m-            "bucket" => vol_l * Decimal::new(3, 2),    // 3% per racking
[0m[31m-            "carboy" => vol_l * Decimal::new(2, 2),    // 2% per racking
[0m[31m-            "keg" => vol_l * Decimal::new(15, 3),      // 1.5% per racking
[0m[31m-            "barrel" => vol_l * Decimal::new(25, 3),   // 2.5% per racking
[0m[32m+            "bucket" => vol_l * Decimal::new(3, 2),  // 3% per racking
[0m[32m+            "carboy" => vol_l * Decimal::new(2, 2),  // 2% per racking
[0m[32m+            "keg" => vol_l * Decimal::new(15, 3),    // 1.5% per racking
[0m[32m+            "barrel" => vol_l * Decimal::new(25, 3), // 2.5% per racking
[0m             _ => vol_l * Decimal::new(2, 2),
         };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:81:
         // Process losses
         let clarification_loss_l = match process_type {
[31m-            "filtered" => vol_l * Decimal::new(4, 2),   // 4% - filter pads absorb
[0m[31m-            "fined" => vol_l * Decimal::new(2, 2),      // 2% - fining agents settle
[0m[31m-            "standard" => vol_l * Decimal::new(1, 2),   // 1% - natural settling
[0m[32m+            "filtered" => vol_l * Decimal::new(4, 2), // 4% - filter pads absorb
[0m[32m+            "fined" => vol_l * Decimal::new(2, 2),    // 2% - fining agents settle
[0m[32m+            "standard" => vol_l * Decimal::new(1, 2), // 1% - natural settling
[0m             "none" => Decimal::ZERO,
             _ => vol_l * Decimal::new(1, 2),
         };
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:97:
             gross_lees_loss_l + transfer_loss_per_racking_l
         } else {
             // First racking is gross lees, rest are fine lees
[31m-            gross_lees_loss_l +
[0m[31m-                (fine_lees_loss_per_racking_l * Decimal::from(rackings - 1)) +
[0m[31m-                (transfer_loss_per_racking_l * Decimal::from(rackings))
[0m[32m+            gross_lees_loss_l
[0m[32m+                + (fine_lees_loss_per_racking_l * Decimal::from(rackings - 1))
[0m[32m+                + (transfer_loss_per_racking_l * Decimal::from(rackings))
[0m         };
 
         let total_loss_l = total_racking_loss_l + clarification_loss_l;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:121:
         let mut result = CalcResult::new(Measurement::new(final_volume_l, Unit::Grams))
             .with_meta("initial_volume", format!("{:.2} L", vol_l))
             .with_meta("final_volume", format!("{:.2} L", final_volume_l))
[31m-            .with_meta("total_loss", format!("{:.2} L ({:.1}%)", total_loss_l, loss_percent))
[0m[32m+            .with_meta(
[0m[32m+                "total_loss",
[0m[32m+                format!("{:.2} L ({:.1}%)", total_loss_l, loss_percent),
[0m[32m+            )
[0m             .with_meta("num_rackings", format!("{}", rackings))
             .with_meta("vessel_type", vessel_type)
             .with_meta("process_type", process_type);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:128:
 
         // Detailed breakdown
         if rackings > 0 {
[31m-            result = result.with_meta("loss_gross_lees", format!("{:.2} L ({:.1}%) - Primary fermentation sediment", gross_lees_loss_l, gross_lees_percent));
[0m[32m+            result = result.with_meta(
[0m[32m+                "loss_gross_lees",
[0m[32m+                format!(
[0m[32m+                    "{:.2} L ({:.1}%) - Primary fermentation sediment",
[0m[32m+                    gross_lees_loss_l, gross_lees_percent
[0m[32m+                ),
[0m[32m+            );
[0m         }
 
         if rackings > 1 {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:135:
[31m-            result = result.with_meta("loss_fine_lees", format!("{:.2} L ({:.1}%) - {} secondary rackings", fine_lees_total_l, fine_lees_percent, rackings - 1));
[0m[32m+            result = result.with_meta(
[0m[32m+                "loss_fine_lees",
[0m[32m+                format!(
[0m[32m+                    "{:.2} L ({:.1}%) - {} secondary rackings",
[0m[32m+                    fine_lees_total_l,
[0m[32m+                    fine_lees_percent,
[0m[32m+                    rackings - 1
[0m[32m+                ),
[0m[32m+            );
[0m         }
 
         if rackings > 0 {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:139:
[31m-            result = result.with_meta("loss_transfers", format!("{:.2} L ({:.1}%) - Hose deadspace & spillage", transfer_total_l, transfer_percent));
[0m[32m+            result = result.with_meta(
[0m[32m+                "loss_transfers",
[0m[32m+                format!(
[0m[32m+                    "{:.2} L ({:.1}%) - Hose deadspace & spillage",
[0m[32m+                    transfer_total_l, transfer_percent
[0m[32m+                ),
[0m[32m+            );
[0m         }
 
         if clarification_loss_l > Decimal::ZERO {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:143:
[31m-            result = result.with_meta("loss_clarification", format!("{:.2} L ({:.1}%) - {}", clarification_loss_l, clarification_percent, process_type));
[0m[32m+            result = result.with_meta(
[0m[32m+                "loss_clarification",
[0m[32m+                format!(
[0m[32m+                    "{:.2} L ({:.1}%) - {}",
[0m[32m+                    clarification_loss_l, clarification_percent, process_type
[0m[32m+                ),
[0m[32m+            );
[0m         }
 
         // Per-racking details
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:147:
         if rackings > 0 {
[31m-            result = result.with_meta("racking_1", format!("Primary ΓåÆ Secondary: {:.2} L loss (gross lees + transfer)", gross_lees_loss_l + transfer_loss_per_racking_l));
[0m[32m+            result = result.with_meta(
[0m[32m+                "racking_1",
[0m[32m+                format!(
[0m[32m+                    "Primary ΓåÆ Secondary: {:.2} L loss (gross lees + transfer)",
[0m[32m+                    gross_lees_loss_l + transfer_loss_per_racking_l
[0m[32m+                ),
[0m[32m+            );
[0m         }
 
         for i in 2..=rackings {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:152:
             let loss = fine_lees_loss_per_racking_l + transfer_loss_per_racking_l;
             result = result.with_meta(
                 format!("racking_{}", i),
[31m-                format!("Racking {}: {:.2} L loss (fine lees + transfer)", i, loss)
[0m[32m+                format!("Racking {}: {:.2} L loss (fine lees + transfer)", i, loss),
[0m             );
         }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:159:
         // Warnings
         if loss_percent > Decimal::from(25) {
[31m-            result = result.with_warning("ΓÜá∩╕Å High loss rate (>25%) - consider fewer rackings or different vessel");
[0m[32m+            result = result.with_warning(
[0m[32m+                "ΓÜá∩╕Å High loss rate (>25%) - consider fewer rackings or different vessel",
[0m[32m+            );
[0m         }
 
         if rackings > 4 {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:166:
         }
 
         if final_volume_l < vol_l * Decimal::new(6, 1) {
[31m-            result = result.with_warning("ΓÜá∩╕Å Less than 60% recovery - process may be too aggressive");
[0m[32m+            result =
[0m[32m+                result.with_warning("ΓÜá∩╕Å Less than 60% recovery - process may be too aggressive");
[0m         }
 
         Ok(result)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\waste.rs:181:
 }
 
 register_calculator!(WasteCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\water_chemistry.rs:1:
 //! Water chemistry calculator for mineral adjustments
 
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\water_chemistry.rs:107:
 }
 
 register_calculator!(WaterChemistryCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_pitch.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_pitch.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let volume = input.get_param("volume")
[0m[32m+        let volume = input
[0m[32m+            .get_param("volume")
[0m             .ok_or_else(|| Error::MissingInput("volume required".into()))?;
[31m-        let og = input.get_param("og")
[0m[32m+        let og = input
[0m[32m+            .get_param("og")
[0m             .ok_or_else(|| Error::MissingInput("og required".into()))?;
         let yeast_type = input.get_param("yeast_type").unwrap_or("ale");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_pitch.rs:37:
[31m-        let vol: Decimal = volume.parse()
[0m[32m+        let vol: Decimal = volume
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid volume".into()))?;
[31m-        let gravity: Decimal = og.parse()
[0m[31m-            .map_err(|_| Error::Parse("Invalid og".into()))?;
[0m[32m+        let gravity: Decimal = og.parse().map_err(|_| Error::Parse("Invalid og".into()))?;
[0m 
         // Convert volume to mL
         let vol_ml = vol * Decimal::from(1000);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_pitch.rs:47:
 
         // Pitch rate (million cells per mL per degree Plato)
         let pitch_rate = match yeast_type {
[31m-            "ale" => Decimal::new(75, 2),      // 0.75 million cells/mL/┬░P
[0m[31m-            "lager" => Decimal::new(15, 1),    // 1.5 million cells/mL/┬░P
[0m[31m-            "mead" => Decimal::new(5, 1),      // 0.5 million cells/mL/┬░P (lower)
[0m[32m+            "ale" => Decimal::new(75, 2),   // 0.75 million cells/mL/┬░P
[0m[32m+            "lager" => Decimal::new(15, 1), // 1.5 million cells/mL/┬░P
[0m[32m+            "mead" => Decimal::new(5, 1),   // 0.5 million cells/mL/┬░P (lower)
[0m             _ => Decimal::new(75, 2),
         };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_pitch.rs:63:
 
         result = result
             .with_meta("yeast_type", yeast_type)
[31m-            .with_meta("cells_billion", format!("{:.0} billion cells", cells_needed))
[0m[31m-            .with_meta("packets_5g", format!("{:.1} packets (5g ea)", packets_needed))
[0m[31m-            .with_meta("grams_dry", format!("{:.1} g", packets_needed * Decimal::from(5)))
[0m[32m+            .with_meta(
[0m[32m+                "cells_billion",
[0m[32m+                format!("{:.0} billion cells", cells_needed),
[0m[32m+            )
[0m[32m+            .with_meta(
[0m[32m+                "packets_5g",
[0m[32m+                format!("{:.1} packets (5g ea)", packets_needed),
[0m[32m+            )
[0m[32m+            .with_meta(
[0m[32m+                "grams_dry",
[0m[32m+                format!("{:.1} g", packets_needed * Decimal::from(5)),
[0m[32m+            )
[0m             .with_meta("pitch_rate", format!("{:.2} M cells/mL/┬░P", pitch_rate))
             .with_meta("plato", format!("{:.1}┬░P", plato));
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_pitch.rs:78:
 }
 
 register_calculator!(YeastPitchCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_starter.rs:1:
 use mazerion_core::{
[31m-    register_calculator, CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit,
[0m[32m+    CalcInput, CalcResult, Calculator, Error, Measurement, Result, Unit, register_calculator,
[0m };
 use rust_decimal::Decimal;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_starter.rs:28:
     }
 
     fn calculate(&self, input: CalcInput) -> Result<CalcResult> {
[31m-        let cells_needed = input.get_param("cells_needed")
[0m[32m+        let cells_needed = input
[0m[32m+            .get_param("cells_needed")
[0m             .ok_or_else(|| Error::MissingInput("cells_needed required (billions)".into()))?;
         let cells_available = input.get_param("cells_available").unwrap_or("100");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_starter.rs:35:
[31m-        let target_cells: Decimal = cells_needed.parse()
[0m[32m+        let target_cells: Decimal = cells_needed
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid cells_needed".into()))?;
[31m-        let starting_cells: Decimal = cells_available.parse()
[0m[32m+        let starting_cells: Decimal = cells_available
[0m[32m+            .parse()
[0m             .map_err(|_| Error::Parse("Invalid cells_available".into()))?;
 
         // Growth rate: ~3x in optimal conditions (1.040 SG starter)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_starter.rs:44:
         let cells_to_grow = target_cells - starting_cells;
 
         if cells_to_grow <= Decimal::ZERO {
[31m-            return Err(Error::Validation("Already have enough cells, no starter needed".into()));
[0m[32m+            return Err(Error::Validation(
[0m[32m+                "Already have enough cells, no starter needed".into(),
[0m[32m+            ));
[0m         }
 
         // Starter volume: ~1L per 100 billion cells to grow
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_starter.rs:56:
         // Expected cell count after growth
         let final_cells = starting_cells * growth_factor;
 
[31m-        let mut result = CalcResult::new(Measurement::new(starter_volume * Decimal::from(1000), Unit::Milliliters));
[0m[32m+        let mut result = CalcResult::new(Measurement::new(
[0m[32m+            starter_volume * Decimal::from(1000),
[0m[32m+            Unit::Milliliters,
[0m[32m+        ));
[0m 
         result = result
             .with_meta("starter_volume_L", format!("{:.1} L", starter_volume))
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_starter.rs:63:
[31m-            .with_meta("dme_needed_g", format!("{:.0} g ({:.2} oz)", dme_needed, dme_needed / Decimal::new(2835, 2)))
[0m[32m+            .with_meta(
[0m[32m+                "dme_needed_g",
[0m[32m+                format!(
[0m[32m+                    "{:.0} g ({:.2} oz)",
[0m[32m+                    dme_needed,
[0m[32m+                    dme_needed / Decimal::new(2835, 2)
[0m[32m+                ),
[0m[32m+            )
[0m             .with_meta("starting_cells", format!("{} billion", starting_cells))
             .with_meta("target_cells", format!("{} billion", target_cells))
             .with_meta("expected_final", format!("{:.0} billion", final_cells))
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_starter.rs:67:
             .with_meta("target_sg", "1.040");
 
         if final_cells < target_cells {
[31m-            result = result.with_warning("May need multiple starter steps to reach target cell count");
[0m[32m+            result =
[0m[32m+                result.with_warning("May need multiple starter steps to reach target cell count");
[0m         }
 
         if starter_volume > Decimal::from(5) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_starter.rs:74:
[31m-            result = result.with_warning("Large starter volume - consider stepped starter approach");
[0m[32m+            result =
[0m[32m+                result.with_warning("Large starter volume - consider stepped starter approach");
[0m         }
 
         Ok(result)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\src\yeast_starter.rs:79:
 }
 
 register_calculator!(YeastStarterCalculator);
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\advanced_tests.rs:161:
     let result = calc.calculate(input);
     assert!(result.is_err() || !result.unwrap().warnings.is_empty());
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\basic_tests.rs:31:
 fn test_brix_to_sg() {
     let calc = BrixToSgCalculator::default();
     let brix_measurement = Measurement::brix(Decimal::from_str("20.0").unwrap()).unwrap();
[31m-    let input = CalcInput::new()
[0m[31m-        .add_measurement(brix_measurement);
[0m[32m+    let input = CalcInput::new().add_measurement(brix_measurement);
[0m 
     let result = calc.calculate(input).unwrap();
     let expected = Decimal::from_str("1.083").unwrap();
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\basic_tests.rs:43:
 fn test_sg_to_brix() {
     let calc = SgToBrixCalculator::default();
     let sg_measurement = Measurement::sg(Decimal::from_str("1.083").unwrap()).unwrap();
[31m-    let input = CalcInput::new()
[0m[31m-        .add_measurement(sg_measurement);
[0m[32m+    let input = CalcInput::new().add_measurement(sg_measurement);
[0m 
     let result = calc.calculate(input).unwrap();
     let expected = Decimal::from_str("20.0").unwrap();
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\basic_tests.rs:91:
 #[test]
 fn test_abv_missing_params() {
     let calc = AbvCalculator::default();
[31m-    let input = CalcInput::new()
[0m[31m-        .add_param("og", "1.090");
[0m[32m+    let input = CalcInput::new().add_param("og", "1.090");
[0m 
     let result = calc.calculate(input);
     assert!(result.is_err());
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\basic_tests.rs:109:
     let result = calc.calculate(input);
     assert!(result.is_err());
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\beer_tests.rs:131:
     let result = calc.calculate(input).unwrap();
     assert!(!result.warnings.is_empty());
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\brewing_tests.rs:85:
 
     let result = calc.calculate(input).unwrap();
     assert!(result.output.value > Decimal::ZERO);
[31m-    assert!(result.metadata.iter().any(|(key, _)| key == "cells_billion"));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(key, _)| key == "cells_billion")
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\brewing_tests.rs:134:
     let result = calc.calculate(input);
     assert!(result.is_err());
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\finishing_tests.rs:145:
 fn test_bottling_calculator() {
     let calc = BottlingCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")         // Total batch volume in liters
[0m[31m-        .add_param("bottle_size", "750");  // Standard 750 mL wine bottle
[0m[32m+        .add_param("volume", "19") // Total batch volume in liters
[0m[32m+        .add_param("bottle_size", "750"); // Standard 750 mL wine bottle
[0m 
     let result = calc.calculate(input).unwrap();
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\finishing_tests.rs:166:
     let input = CalcInput::new()
         .add_measurement(current_ph)
         .add_param("volume", "19")
[31m-        .add_param("target_ph", "3.8");  // Higher than current - INVALID
[0m[32m+        .add_param("target_ph", "3.8"); // Higher than current - INVALID
[0m 
     let result = calc.calculate(input);
     // Should either error or give negative result (invalid)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\finishing_tests.rs:173:
     assert!(result.is_err() || result.unwrap().output.value < Decimal::ZERO);
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\mead_styles_tests.rs:93:
         .add_param("malt_weight", "3.0");
 
     let result = calc.calculate(input).unwrap();
[31m-    assert!(result.metadata.iter().any(|(k, _)| k == "honey_kg" || k == "honey_g"));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k == "honey_kg" || k == "honey_g")
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\mead_styles_tests.rs:140:
     let result = calc.calculate(input);
     assert!(result.is_ok());
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\advanced_tests.rs:161:
     let result = calc.calculate(input);
     assert!(result.is_err() || !result.unwrap().warnings.is_empty());
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\basic_tests.rs:31:
 fn test_brix_to_sg() {
     let calc = BrixToSgCalculator::default();
     let brix_measurement = Measurement::brix(Decimal::from_str("20.0").unwrap()).unwrap();
[31m-    let input = CalcInput::new()
[0m[31m-        .add_measurement(brix_measurement);
[0m[32m+    let input = CalcInput::new().add_measurement(brix_measurement);
[0m 
     let result = calc.calculate(input).unwrap();
     let expected = Decimal::from_str("1.083").unwrap();
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\basic_tests.rs:43:
 fn test_sg_to_brix() {
     let calc = SgToBrixCalculator::default();
     let sg_measurement = Measurement::sg(Decimal::from_str("1.083").unwrap()).unwrap();
[31m-    let input = CalcInput::new()
[0m[31m-        .add_measurement(sg_measurement);
[0m[32m+    let input = CalcInput::new().add_measurement(sg_measurement);
[0m 
     let result = calc.calculate(input).unwrap();
     let expected = Decimal::from_str("20.0").unwrap();
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\basic_tests.rs:91:
 #[test]
 fn test_abv_missing_params() {
     let calc = AbvCalculator::default();
[31m-    let input = CalcInput::new()
[0m[31m-        .add_param("og", "1.090");
[0m[32m+    let input = CalcInput::new().add_param("og", "1.090");
[0m 
     let result = calc.calculate(input);
     assert!(result.is_err());
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\basic_tests.rs:109:
     let result = calc.calculate(input);
     assert!(result.is_err());
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\beer_tests.rs:131:
     let result = calc.calculate(input).unwrap();
     assert!(!result.warnings.is_empty());
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\brewing_tests.rs:85:
 
     let result = calc.calculate(input).unwrap();
     assert!(result.output.value > Decimal::ZERO);
[31m-    assert!(result.metadata.iter().any(|(key, _)| key == "cells_billion"));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(key, _)| key == "cells_billion")
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\brewing_tests.rs:134:
     let result = calc.calculate(input);
     assert!(result.is_err());
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\finishing_tests.rs:145:
 fn test_bottling_calculator() {
     let calc = BottlingCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")         // Total batch volume in liters
[0m[31m-        .add_param("bottle_size", "750");  // Standard 750 mL wine bottle
[0m[32m+        .add_param("volume", "19") // Total batch volume in liters
[0m[32m+        .add_param("bottle_size", "750"); // Standard 750 mL wine bottle
[0m 
     let result = calc.calculate(input).unwrap();
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\finishing_tests.rs:166:
     let input = CalcInput::new()
         .add_measurement(current_ph)
         .add_param("volume", "19")
[31m-        .add_param("target_ph", "3.8");  // Higher than current - INVALID
[0m[32m+        .add_param("target_ph", "3.8"); // Higher than current - INVALID
[0m 
     let result = calc.calculate(input);
     // Should either error or give negative result (invalid)
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\finishing_tests.rs:173:
     assert!(result.is_err() || result.unwrap().output.value < Decimal::ZERO);
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\mead_styles_tests.rs:93:
         .add_param("malt_weight", "3.0");
 
     let result = calc.calculate(input).unwrap();
[31m-    assert!(result.metadata.iter().any(|(k, _)| k == "honey_kg" || k == "honey_g"));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k == "honey_kg" || k == "honey_g")
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\mead_styles_tests.rs:140:
     let result = calc.calculate(input);
     assert!(result.is_ok());
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\mod.rs:1:
 // Test module declarations
[31m-mod basic_tests;
[0m mod advanced_tests;
[31m-mod brewing_tests;
[0m[32m+mod basic_tests;
[0m mod beer_tests;
[32m+mod brewing_tests;
[0m mod finishing_tests;
 mod mead_styles_tests;
 mod utilities_tests;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:9:
 fn test_cost_calculator_basic() {
     let calc = BatchCostCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")              // FIXED: was "batch_size"
[0m[31m-        .add_param("honey_cost", "90")          // Total honey cost
[0m[31m-        .add_param("honey_kg", "3.6");          // Honey amount
[0m[32m+        .add_param("volume", "19") // FIXED: was "batch_size"
[0m[32m+        .add_param("honey_cost", "90") // Total honey cost
[0m[32m+        .add_param("honey_kg", "3.6"); // Honey amount
[0m 
     let result = calc.calculate(input).unwrap();
     assert!(result.output.value > Decimal::ZERO);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:21:
 fn test_cost_calculator_with_extras() {
     let calc = BatchCostCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")              // FIXED: was "batch_size"
[0m[32m+        .add_param("volume", "19") // FIXED: was "batch_size"
[0m         .add_param("honey_cost", "90")
         .add_param("honey_kg", "3.6")
[31m-        .add_param("fruit_cost", "20")          // Optional extras
[0m[32m+        .add_param("fruit_cost", "20") // Optional extras
[0m         .add_param("yeast_cost", "10")
         .add_param("nutrient_cost", "8")
         .add_param("other_cost", "12");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:32:
     let result = calc.calculate(input).unwrap();
     assert!(result.output.value > Decimal::from(100));
     // Check for any cost-related metadata (flexible assertion)
[31m-    assert!(result.metadata.iter().any(|(k, _)| k.contains("cost") || k.contains("total")));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k.contains("cost") || k.contains("total"))
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:39:
 fn test_priming_alternatives_corn_sugar() {
     let calc = PrimingAlternativesCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")              // FIXED: Added required params
[0m[32m+        .add_param("volume", "19") // FIXED: Added required params
[0m         .add_param("target_co2", "2.5")
         .add_param("temperature", "20");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:54:
 fn test_priming_alternatives_table_sugar() {
     let calc = PrimingAlternativesCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")              // FIXED: Added required params
[0m[32m+        .add_param("volume", "19") // FIXED: Added required params
[0m         .add_param("target_co2", "2.5")
         .add_param("temperature", "20");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:68:
     let calc = WaterChemistryCalculator::default();
     let input = CalcInput::new()
         .add_param("volume", "19")
[31m-        .add_param("adjustment", "gypsum")      // Mineral type
[0m[31m-        .add_param("target_ppm", "50");         // Target mineral level
[0m[32m+        .add_param("adjustment", "gypsum") // Mineral type
[0m[32m+        .add_param("target_ppm", "50"); // Target mineral level
[0m 
     let result = calc.calculate(input).unwrap();
     assert!(result.output.value > Decimal::ZERO);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:76:
     // Metadata keys match actual calculator output
[31m-    assert!(result.metadata.iter().any(|(k, _)| k == "mineral" || k == "grams_needed"));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k == "mineral" || k == "grams_needed")
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:87:
 
     let result = calc.calculate(input).unwrap();
     // Check for actual metadata keys from calculator
[31m-    assert!(result.metadata.iter().any(|(k, _)| k == "mineral" || k == "ion_contribution"));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k == "mineral" || k == "ion_contribution")
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:106:
 #[test]
 fn test_bench_trials_validation() {
     let calc = BenchTrialsCalculator::default();
[31m-    let input = CalcInput::new()
[0m[31m-        .add_param("trial_volume", "100");
[0m[32m+    let input = CalcInput::new().add_param("trial_volume", "100");
[0m 
     let result = calc.calculate(input);
     assert!(result.is_err());
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:117:
 fn test_cost_per_bottle() {
     let calc = BatchCostCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")              // FIXED: was "batch_size"
[0m[32m+        .add_param("volume", "19") // FIXED: was "batch_size"
[0m         .add_param("honey_cost", "90")
         .add_param("honey_kg", "3.6")
[31m-        .add_param("bottle_cost", "1.0")        // Cost per bottle
[0m[32m+        .add_param("bottle_cost", "1.0") // Cost per bottle
[0m         .add_param("bottle_size", "750");
 
     let result = calc.calculate(input).unwrap();
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:127:
[31m-    assert!(result.metadata.iter().any(|(k, _)| k.contains("bottle") || k.contains("cost")));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k.contains("bottle") || k.contains("cost"))
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:137:
 
     let result = calc.calculate(input).unwrap();
     // Check for actual calculator output - mineral and ion info
[31m-    assert!(result.metadata.iter().any(|(k, _)| k == "mineral" || k == "ion_contribution"));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k == "mineral" || k == "ion_contribution")
[0m[32m+    );
[0m }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:9:
 fn test_cost_calculator_basic() {
     let calc = BatchCostCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")              // FIXED: was "batch_size"
[0m[31m-        .add_param("honey_cost", "90")          // Total honey cost
[0m[31m-        .add_param("honey_kg", "3.6");          // Honey amount
[0m[32m+        .add_param("volume", "19") // FIXED: was "batch_size"
[0m[32m+        .add_param("honey_cost", "90") // Total honey cost
[0m[32m+        .add_param("honey_kg", "3.6"); // Honey amount
[0m 
     let result = calc.calculate(input).unwrap();
     assert!(result.output.value > Decimal::ZERO);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:21:
 fn test_cost_calculator_with_extras() {
     let calc = BatchCostCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")              // FIXED: was "batch_size"
[0m[32m+        .add_param("volume", "19") // FIXED: was "batch_size"
[0m         .add_param("honey_cost", "90")
         .add_param("honey_kg", "3.6")
[31m-        .add_param("fruit_cost", "20")          // Optional extras
[0m[32m+        .add_param("fruit_cost", "20") // Optional extras
[0m         .add_param("yeast_cost", "10")
         .add_param("nutrient_cost", "8")
         .add_param("other_cost", "12");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:32:
     let result = calc.calculate(input).unwrap();
     assert!(result.output.value > Decimal::from(100));
     // Check for any cost-related metadata (flexible assertion)
[31m-    assert!(result.metadata.iter().any(|(k, _)| k.contains("cost") || k.contains("total")));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k.contains("cost") || k.contains("total"))
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:39:
 fn test_priming_alternatives_corn_sugar() {
     let calc = PrimingAlternativesCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")              // FIXED: Added required params
[0m[32m+        .add_param("volume", "19") // FIXED: Added required params
[0m         .add_param("target_co2", "2.5")
         .add_param("temperature", "20");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:54:
 fn test_priming_alternatives_table_sugar() {
     let calc = PrimingAlternativesCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")              // FIXED: Added required params
[0m[32m+        .add_param("volume", "19") // FIXED: Added required params
[0m         .add_param("target_co2", "2.5")
         .add_param("temperature", "20");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:68:
     let calc = WaterChemistryCalculator::default();
     let input = CalcInput::new()
         .add_param("volume", "19")
[31m-        .add_param("adjustment", "gypsum")      // Mineral type
[0m[31m-        .add_param("target_ppm", "50");         // Target mineral level
[0m[32m+        .add_param("adjustment", "gypsum") // Mineral type
[0m[32m+        .add_param("target_ppm", "50"); // Target mineral level
[0m 
     let result = calc.calculate(input).unwrap();
     assert!(result.output.value > Decimal::ZERO);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:76:
     // Metadata keys match actual calculator output
[31m-    assert!(result.metadata.iter().any(|(k, _)| k == "mineral" || k == "grams_needed"));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k == "mineral" || k == "grams_needed")
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:87:
 
     let result = calc.calculate(input).unwrap();
     // Check for actual metadata keys from calculator
[31m-    assert!(result.metadata.iter().any(|(k, _)| k == "mineral" || k == "ion_contribution"));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k == "mineral" || k == "ion_contribution")
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:106:
 #[test]
 fn test_bench_trials_validation() {
     let calc = BenchTrialsCalculator::default();
[31m-    let input = CalcInput::new()
[0m[31m-        .add_param("trial_volume", "100");
[0m[32m+    let input = CalcInput::new().add_param("trial_volume", "100");
[0m 
     let result = calc.calculate(input);
     assert!(result.is_err());
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:117:
 fn test_cost_per_bottle() {
     let calc = BatchCostCalculator::default();
     let input = CalcInput::new()
[31m-        .add_param("volume", "19")              // FIXED: was "batch_size"
[0m[32m+        .add_param("volume", "19") // FIXED: was "batch_size"
[0m         .add_param("honey_cost", "90")
         .add_param("honey_kg", "3.6")
[31m-        .add_param("bottle_cost", "1.0")        // Cost per bottle
[0m[32m+        .add_param("bottle_cost", "1.0") // Cost per bottle
[0m         .add_param("bottle_size", "750");
 
     let result = calc.calculate(input).unwrap();
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:127:
[31m-    assert!(result.metadata.iter().any(|(k, _)| k.contains("bottle") || k.contains("cost")));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k.contains("bottle") || k.contains("cost"))
[0m[32m+    );
[0m }
 
 #[test]
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\calculators\tests\utilities_tests.rs:137:
 
     let result = calc.calculate(input).unwrap();
     // Check for actual calculator output - mineral and ion info
[31m-    assert!(result.metadata.iter().any(|(k, _)| k == "mineral" || k == "ion_contribution"));
[0m[32m+    assert!(
[0m[32m+        result
[0m[32m+            .metadata
[0m[32m+            .iter()
[0m[32m+            .any(|(k, _)| k == "mineral" || k == "ion_contribution")
[0m[32m+    );
[0m }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\cli\src\main.rs:1:
 //! Production CLI with automatic MCL integration
 
[32m+use mazerion_core::{CalcInput, VALID_CATEGORIES, get_calculator, get_calculators_by_category};
[0m use mazerion_gui::run;
[31m-use mazerion_core::{CalcInput, get_calculator, get_calculators_by_category, VALID_CATEGORIES};
[0m use std::env;
 
 fn main() {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\cli\src\main.rs:176:
     println!("  mazerion calc carbonation volume=19 temperature=20 target_co2=2.5 method=priming");
     println!();
     println!("MCL VERSION: Production v1.0");
[31m-    println!("Total Calculators: {}", mazerion_core::traits::calculator_count());
[0m[32m+    println!(
[0m[32m+        "Total Calculators: {}",
[0m[32m+        mazerion_core::traits::calculator_count()
[0m[32m+    );
[0m     println!("ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ");
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\calc_input_tests.rs:1:
[32m+
[0m[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\calc_result_tests.rs:1:
[32m+
[0m[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\lib.rs:3:
 
 use rust_decimal::Decimal;
 use serde::{Deserialize, Serialize};
[31m-use std::fmt;
[0m use std::collections::HashMap;
[32m+use std::fmt;
[0m 
 pub mod error;
 pub mod traits;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\lib.rs:21:
 mod validation_tests;
 
 pub use error::{Error, Result};
[31m-pub use traits::{Calculator, get_calculator, get_all_calculators, list_calculator_ids, calculator_count};
[0m[32m+pub use traits::{
[0m[32m+    Calculator, calculator_count, get_all_calculators, get_calculator, list_calculator_ids,
[0m[32m+};
[0m pub use units::*;
 pub use validation::*;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\lib.rs:165:
         self.measurements
             .iter()
             .find(|m| m.unit == unit)
[31m-            .ok_or(Error::MissingInput(format!("No measurement with unit {}", unit)))
[0m[32m+            .ok_or(Error::MissingInput(format!(
[0m[32m+                "No measurement with unit {}",
[0m[32m+                unit
[0m[32m+            )))
[0m     }
 
     pub fn get_param(&self, key: &str) -> Option<&str> {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\lib.rs:225:
 pub fn fahrenheit_to_celsius(fahrenheit: Decimal) -> Decimal {
     (fahrenheit - Decimal::from(32)) * Decimal::new(5, 0) / Decimal::new(9, 0)
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\traits.rs:22:
     /// Validate inputs before calculation.
     fn validate(&self, input: &CalcInput) -> Result<()> {
         if input.measurements.is_empty() && input.params.is_empty() {
[31m-            return Err(Error::MissingInput("No measurements or parameters provided".into()));
[0m[32m+            return Err(Error::MissingInput(
[0m[32m+                "No measurements or parameters provided".into(),
[0m[32m+            ));
[0m         }
         Ok(())
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\traits.rs:97:
 macro_rules! register_calculator {
     ($calc:ty) => {
         #[::linkme::distributed_slice($crate::traits::CALCULATORS)]
[31m-        static ENTRY: $crate::traits::CalculatorEntry = $crate::traits::CalculatorEntry::new(
[0m[31m-            <$calc>::ID,
[0m[31m-            || Box::new(<$calc>::default()),
[0m[31m-        );
[0m[32m+        static ENTRY: $crate::traits::CalculatorEntry =
[0m[32m+            $crate::traits::CalculatorEntry::new(<$calc>::ID, || Box::new(<$calc>::default()));
[0m     };
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\units_tests.rs:1:
[32m+
[0m[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\validation.rs:11:
         let min = Decimal::new(6000, 4);
         let max = Decimal::new(20000, 4);
         if value < min || value > max {
[31m-            return Err(Error::OutOfRange(format!("SG {} outside range 0.6000ΓÇô2.0000", value)));
[0m[32m+            return Err(Error::OutOfRange(format!(
[0m[32m+                "SG {} outside range 0.6000ΓÇô2.0000",
[0m[32m+                value
[0m[32m+            )));
[0m         }
         Ok(())
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\validation.rs:20:
         let min = Decimal::new(150, 2);
         let max = Decimal::new(850, 2);
         if value < min || value > max {
[31m-            return Err(Error::OutOfRange(format!("pH {} outside range 1.50ΓÇô8.50", value)));
[0m[32m+            return Err(Error::OutOfRange(format!(
[0m[32m+                "pH {} outside range 1.50ΓÇô8.50",
[0m[32m+                value
[0m[32m+            )));
[0m         }
         Ok(())
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\validation.rs:27:
 
     pub fn brix(value: Decimal) -> Result<()> {
         if value < Decimal::ZERO || value > Decimal::from(70) {
[31m-            return Err(Error::OutOfRange(format!("Brix {} outside range 0ΓÇô70", value)));
[0m[32m+            return Err(Error::OutOfRange(format!(
[0m[32m+                "Brix {} outside range 0ΓÇô70",
[0m[32m+                value
[0m[32m+            )));
[0m         }
         Ok(())
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\validation.rs:42:
 
     pub fn plato(value: Decimal) -> Result<()> {
         if value < Decimal::ZERO || value > Decimal::from(70) {
[31m-            return Err(Error::OutOfRange(format!("Plato {} outside range 0ΓÇô70", value)));
[0m[32m+            return Err(Error::OutOfRange(format!(
[0m[32m+                "Plato {} outside range 0ΓÇô70",
[0m[32m+                value
[0m[32m+            )));
[0m         }
         Ok(())
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\validation.rs:57:
 
     pub fn temp_c(value: Decimal) -> Result<()> {
         if value < Decimal::from(-5) || value > Decimal::from(100) {
[31m-            return Err(Error::OutOfRange(format!("Temperature {} ┬░C outside range ΓêÆ5ΓÇô100", value)));
[0m[32m+            return Err(Error::OutOfRange(format!(
[0m[32m+                "Temperature {} ┬░C outside range ΓêÆ5ΓÇô100",
[0m[32m+                value
[0m[32m+            )));
[0m         }
         Ok(())
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\validation.rs:64:
 
     pub fn temp_f(value: Decimal) -> Result<()> {
         if value < Decimal::from(23) || value > Decimal::from(212) {
[31m-            return Err(Error::OutOfRange(format!("Temperature {} ┬░F outside range 23ΓÇô212", value)));
[0m[32m+            return Err(Error::OutOfRange(format!(
[0m[32m+                "Temperature {} ┬░F outside range 23ΓÇô212",
[0m[32m+                value
[0m[32m+            )));
[0m         }
         Ok(())
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\validation.rs:71:
 
     pub fn percent(value: Decimal) -> Result<()> {
         if value < Decimal::ZERO || value > Decimal::from(100) {
[31m-            return Err(Error::OutOfRange(format!("Percentage {} outside range 0ΓÇô100", value)));
[0m[32m+            return Err(Error::OutOfRange(format!(
[0m[32m+                "Percentage {} outside range 0ΓÇô100",
[0m[32m+                value
[0m[32m+            )));
[0m         }
         Ok(())
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\core\src\validation_tests.rs:61:
         }
     }
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\ffi\src\lib.rs:22:
     fn new(code: c_int, message: &str) -> Self {
         let msg = match CString::new(message) {
             Ok(s) => s.into_raw(),
[31m-            Err(_) => {
[0m[31m-                CString::new("Error creating error message")
[0m[31m-                    .unwrap_or_else(|_| CString::new("").unwrap_or_default())
[0m[31m-                    .into_raw()
[0m[31m-            }
[0m[32m+            Err(_) => CString::new("Error creating error message")
[0m[32m+                .unwrap_or_else(|_| CString::new("").unwrap_or_default())
[0m[32m+                .into_raw(),
[0m         };
         Self { code, message: msg }
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\ffi\src\lib.rs:58:
                 return Self {
                     error: MazerionError::json_error("Invalid JSON output"),
                     json_output: ptr::null_mut(),
[31m-                }
[0m[32m+                };
[0m             }
         };
         Self {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\ffi\src\lib.rs:121:
 ) -> MazerionResult {
     let result = panic::catch_unwind(|| {
         if calculator_id.is_null() {
[31m-            return MazerionResult::error(MazerionError::new(
[0m[31m-                1,
[0m[31m-                "Calculator ID pointer is null",
[0m[31m-            ));
[0m[32m+            return MazerionResult::error(MazerionError::new(1, "Calculator ID pointer is null"));
[0m         }
         if json_input.is_null() {
             return MazerionResult::error(MazerionError::new(2, "JSON input pointer is null"));
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\ffi\src\lib.rs:137:
                 return MazerionResult::error(MazerionError::new(
                     3,
                     "Invalid UTF-8 in calculator ID",
[31m-                ))
[0m[32m+                ));
[0m             }
         };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\ffi\src\lib.rs:145:
         let json_str = match unsafe { CStr::from_ptr(json_input) }.to_str() {
             Ok(s) => s,
             Err(_) => {
[31m-                return MazerionResult::error(MazerionError::new(
[0m[31m-                    4,
[0m[31m-                    "Invalid UTF-8 in JSON input",
[0m[31m-                ))
[0m[32m+                return MazerionResult::error(MazerionError::new(4, "Invalid UTF-8 in JSON input"));
[0m             }
         };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\ffi\src\lib.rs:158:
                 return MazerionResult::error(MazerionError::json_error(&format!(
                     "Failed to parse JSON input: {}",
                     e
[31m-                )))
[0m[32m+                )));
[0m             }
         };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\ffi\src\lib.rs:242:
         Err(_) => ptr::null_mut(),
     }
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:1:
 //! Mazerion GUI - Main application
 
[31m-use eframe::egui::{self, RichText, Color32, CornerRadius};
[0m[32m+use eframe::egui::{self, Color32, CornerRadius, RichText};
[0m 
 mod state;
 mod tabs;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:253:
             waste_vessel_type: "carboy".to_string(),
             waste_num_rackings: String::new(),
             waste_process_type: "standard".to_string(),
[31m-            utility_calc: tabs::utilities::UtilityCalculator::RecipeUpscaling,        }
[0m[32m+            utility_calc: tabs::utilities::UtilityCalculator::RecipeUpscaling,
[0m[32m+        }
[0m     }
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:265:
             .show(ctx, |ui| {
                 ui.add_space(10.0);
 
[31m-                ui.heading(RichText::new("≡ƒì» Mazerion - Brewing Calculator Suite")
[0m[31m-                    .size(28.0)
[0m[31m-                    .color(c.honey_gold));
[0m[32m+                ui.heading(
[0m[32m+                    RichText::new("≡ƒì» Mazerion - Brewing Calculator Suite")
[0m[32m+                        .size(28.0)
[0m[32m+                        .color(c.honey_gold),
[0m[32m+                );
[0m 
                 ui.add_space(15.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:275:
                     if tab_button(ui, "≡ƒôè Basic", self.state.current_tab == TabView::Basic, &c) {
                         self.state.current_tab = TabView::Basic;
                     }
[31m-                    if tab_button(ui, "≡ƒö¼ Advanced", self.state.current_tab == TabView::Advanced, &c) {
[0m[32m+                    if tab_button(
[0m[32m+                        ui,
[0m[32m+                        "≡ƒö¼ Advanced",
[0m[32m+                        self.state.current_tab == TabView::Advanced,
[0m[32m+                        &c,
[0m[32m+                    ) {
[0m                         self.state.current_tab = TabView::Advanced;
                     }
[31m-                    if tab_button(ui, "≡ƒì║ Brewing", self.state.current_tab == TabView::Brewing, &c) {
[0m[32m+                    if tab_button(
[0m[32m+                        ui,
[0m[32m+                        "≡ƒì║ Brewing",
[0m[32m+                        self.state.current_tab == TabView::Brewing,
[0m[32m+                        &c,
[0m[32m+                    ) {
[0m                         self.state.current_tab = TabView::Brewing;
                     }
                     if tab_button(ui, "≡ƒì╗ Beer", self.state.current_tab == TabView::Beer, &c) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:285:
                         self.state.current_tab = TabView::Beer;
                     }
[31m-                    if tab_button(ui, "Γ£¿ Finishing", self.state.current_tab == TabView::Finishing, &c) {
[0m[32m+                    if tab_button(
[0m[32m+                        ui,
[0m[32m+                        "Γ£¿ Finishing",
[0m[32m+                        self.state.current_tab == TabView::Finishing,
[0m[32m+                        &c,
[0m[32m+                    ) {
[0m                         self.state.current_tab = TabView::Finishing;
                     }
                     if tab_button(ui, "≡ƒì» Meads", self.state.current_tab == TabView::Meads, &c) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:291:
                         self.state.current_tab = TabView::Meads;
                     }
[31m-                    if tab_button(ui, "≡ƒöº Utilities", self.state.current_tab == TabView::Utilities, &c) {
[0m[32m+                    if tab_button(
[0m[32m+                        ui,
[0m[32m+                        "≡ƒöº Utilities",
[0m[32m+                        self.state.current_tab == TabView::Utilities,
[0m[32m+                        &c,
[0m[32m+                    ) {
[0m                         self.state.current_tab = TabView::Utilities;
                     }
[31m-                    if tab_button(ui, "ΓÜÖ∩╕Å Settings", self.state.current_tab == TabView::Settings, &c) {
[0m[32m+                    if tab_button(
[0m[32m+                        ui,
[0m[32m+                        "ΓÜÖ∩╕Å Settings",
[0m[32m+                        self.state.current_tab == TabView::Settings,
[0m[32m+                        &c,
[0m[32m+                    ) {
[0m                         self.state.current_tab = TabView::Settings;
                     }
                 });
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:320:
                             .corner_radius(CornerRadius::same(8))
                             .inner_margin(15.0)
                             .show(ui, |ui| {
[31m-                                ui.label(RichText::new(result_text)
[0m[31m-                                    .size(28.0)
[0m[31m-                                    .color(Color32::BLACK));
[0m[32m+                                ui.label(
[0m[32m+                                    RichText::new(result_text).size(28.0).color(Color32::BLACK),
[0m[32m+                                );
[0m 
                                 if !self.warnings.is_empty() {
                                     ui.add_space(10.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:329:
                                     for warning in &self.warnings {
[31m-                                        ui.label(RichText::new(format!("ΓÜá∩╕Å {}", warning))
[0m[31m-                                            .color(c.sunset_orange));
[0m[32m+                                        ui.label(
[0m[32m+                                            RichText::new(format!("ΓÜá∩╕Å {}", warning))
[0m[32m+                                                .color(c.sunset_orange),
[0m[32m+                                        );
[0m                                     }
                                 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:335:
                                 if !self.metadata.is_empty() {
                                     ui.add_space(10.0);
                                     for (key, value) in &self.metadata {
[31m-                                        ui.label(RichText::new(format!("{}: {}", key, value))
[0m[31m-                                            .size(14.0)
[0m[31m-                                            .color(c.dark_text));
[0m[32m+                                        ui.label(
[0m[32m+                                            RichText::new(format!("{}: {}", key, value))
[0m[32m+                                                .size(14.0)
[0m[32m+                                                .color(c.dark_text),
[0m[32m+                                        );
[0m                                     }
                                 }
                             });
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:349:
 
 fn tab_button(ui: &mut egui::Ui, text: &str, selected: bool, c: &state::CustomColors) -> bool {
     let button = egui::Button::new(RichText::new(text).size(14.0))
[31m-        .fill(if selected { c.honey_gold } else { c.light_cream })
[0m[32m+        .fill(if selected {
[0m[32m+            c.honey_gold
[0m[32m+        } else {
[0m[32m+            c.light_cream
[0m[32m+        })
[0m         .stroke(egui::Stroke::new(1.0, c.dark_text));
     ui.add(button).clicked()
 }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\lib.rs:379:
         Box::new(|_cc| Ok(Box::new(MazerionApp::default()))),
     )
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\state.rs:9:
     Brewing,
     Beer,
     Finishing,
[31m-    Meads,  // CHANGED FROM MeadStyles
[0m[32m+    Meads, // CHANGED FROM MeadStyles
[0m     Utilities,
     Settings,
 }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\state.rs:339:
     pub const SADDLE_BROWN: Color32 = Color32::from_rgb(139, 69, 19);
     pub const GOLDENROD: Color32 = Color32::from_rgb(218, 165, 32);
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\advanced.rs:1:
 //! Advanced calculators tab
 
[31m-use crate::{MazerionApp, state::{AdvancedCalculator, colors}};
[0m[31m-use eframe::egui::{self, RichText, CornerRadius};
[0m[32m+use crate::{
[0m[32m+    MazerionApp,
[0m[32m+    state::{AdvancedCalculator, colors},
[0m[32m+};
[0m[32m+use eframe::egui::{self, CornerRadius, RichText};
[0m use mazerion_core::{CalcInput, Measurement};
[31m-use std::str::FromStr;
[0m use rust_decimal::Decimal;
[32m+use std::str::FromStr;
[0m 
 pub fn render(app: &mut MazerionApp, ui: &mut egui::Ui) {
     ui.horizontal(|ui| {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\advanced.rs:12:
         egui::ComboBox::from_id_salt("advanced_calc")
             .selected_text(get_calc_name(app.state.advanced_calc))
             .show_ui(ui, |ui| {
[31m-                ui.selectable_value(&mut app.state.advanced_calc, AdvancedCalculator::Blending, "Blending Calculator");
[0m[31m-                ui.selectable_value(&mut app.state.advanced_calc, AdvancedCalculator::Refractometer, "Refractometer Correction");
[0m[31m-                ui.selectable_value(&mut app.state.advanced_calc, AdvancedCalculator::SgCorrection, "SG Temperature Correction");
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.advanced_calc,
[0m[32m+                    AdvancedCalculator::Blending,
[0m[32m+                    "Blending Calculator",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.advanced_calc,
[0m[32m+                    AdvancedCalculator::Refractometer,
[0m[32m+                    "Refractometer Correction",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.advanced_calc,
[0m[32m+                    AdvancedCalculator::SgCorrection,
[0m[32m+                    "SG Temperature Correction",
[0m[32m+                );
[0m             });
     });
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\advanced.rs:25:
         .stroke(egui::Stroke::new(1.5, colors::HONEY_GOLD))
         .corner_radius(CornerRadius::same(8))
         .inner_margin(15.0)
[31m-        .show(ui, |ui| {
[0m[31m-            match app.state.advanced_calc {
[0m[31m-                AdvancedCalculator::Blending => render_blending(app, ui),
[0m[31m-                AdvancedCalculator::Refractometer => render_refractometer(app, ui),
[0m[31m-                AdvancedCalculator::SgCorrection => render_sg_correction(app, ui),
[0m[31m-            }
[0m[32m+        .show(ui, |ui| match app.state.advanced_calc {
[0m[32m+            AdvancedCalculator::Blending => render_blending(app, ui),
[0m[32m+            AdvancedCalculator::Refractometer => render_refractometer(app, ui),
[0m[32m+            AdvancedCalculator::SgCorrection => render_sg_correction(app, ui),
[0m         });
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\advanced.rs:47:
     ui.label("Calculate final properties when mixing two batches");
     ui.add_space(10.0);
 
[31m-    let vol_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) { "L" } else { "gal" };
[0m[32m+    let vol_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) {
[0m[32m+        "L"
[0m[32m+    } else {
[0m[32m+        "gal"
[0m[32m+    };
[0m 
     ui.label(RichText::new("Batch 1:").strong().color(colors::GOLDENROD));
[31m-    crate::input_field(ui, &format!("Volume ({}):", vol_unit), &mut app.vol1, "Volume of first batch");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Volume ({}):", vol_unit),
[0m[32m+        &mut app.vol1,
[0m[32m+        "Volume of first batch",
[0m[32m+    );
[0m     crate::input_field(ui, "ABV (%):", &mut app.abv1, "ABV of first batch");
 
     ui.add_space(8.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\advanced.rs:57:
     ui.label(RichText::new("Batch 2:").strong().color(colors::GOLDENROD));
[31m-    crate::input_field(ui, &format!("Volume ({}):", vol_unit), &mut app.vol2, "Volume of second batch");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Volume ({}):", vol_unit),
[0m[32m+        &mut app.vol2,
[0m[32m+        "Volume of second batch",
[0m[32m+    );
[0m     crate::input_field(ui, "ABV (%):", &mut app.abv2, "ABV of second batch");
 
     ui.add_space(10.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\advanced.rs:70:
     ui.label("Correct refractometer readings for alcohol presence (Terrill cubic)");
     ui.add_space(10.0);
 
[31m-    crate::input_field(ui, "Original Brix (┬░Bx):", &mut app.orig_brix, "Original reading before fermentation");
[0m[31m-    crate::input_field(ui, "Current Brix (┬░Bx):", &mut app.curr_brix, "Current reading during/after fermentation");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Original Brix (┬░Bx):",
[0m[32m+        &mut app.orig_brix,
[0m[32m+        "Original reading before fermentation",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Current Brix (┬░Bx):",
[0m[32m+        &mut app.curr_brix,
[0m[32m+        "Current reading during/after fermentation",
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\advanced.rs:85:
     ui.label("Correct gravity readings for temperature (calibrated at 20┬░C)");
     ui.add_space(10.0);
 
[31m-    let temp_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) { "┬░C" } else { "┬░F" };
[0m[32m+    let temp_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) {
[0m[32m+        "┬░C"
[0m[32m+    } else {
[0m[32m+        "┬░F"
[0m[32m+    };
[0m 
     crate::input_field(ui, "Measured SG:", &mut app.sg, "Specific gravity reading");
[31m-    crate::input_field(ui, &format!("Temperature ({}):", temp_unit), &mut app.temp, "Temperature at measurement");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Temperature ({}):", temp_unit),
[0m[32m+        &mut app.temp,
[0m[32m+        "Temperature at measurement",
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\advanced.rs:195:
     };
 
     let is_metric = matches!(app.state.unit_system, crate::state::UnitSystem::Metric);
[31m-    let temp_celsius = if is_metric { temp_val } else { mazerion_core::fahrenheit_to_celsius(temp_val) };
[0m[32m+    let temp_celsius = if is_metric {
[0m[32m+        temp_val
[0m[32m+    } else {
[0m[32m+        mazerion_core::fahrenheit_to_celsius(temp_val)
[0m[32m+    };
[0m 
     let sg_meas = match Measurement::sg(sg_val) {
         Ok(m) => m,
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\advanced.rs:221:
         Ok(res) => {
             app.result = Some(format!("Corrected SG: {:.4}", res.output.value));
             app.warnings = res.warnings;
[31m-            app.metadata = res.metadata.into_iter().map(|(k, v)| {
[0m[31m-                if k == "temperature" {
[0m[31m-                    if is_metric { (k, v) } else { (k, format!("{:.1} ┬░F", mazerion_core::celsius_to_fahrenheit(temp_celsius))) }
[0m[31m-                } else if k == "calibration" {
[0m[31m-                    (k, if is_metric { v } else { "68┬░F".to_string() })
[0m[31m-                } else {
[0m[31m-                    (k, v)
[0m[31m-                }
[0m[31m-            }).collect();
[0m[32m+            app.metadata = res
[0m[32m+                .metadata
[0m[32m+                .into_iter()
[0m[32m+                .map(|(k, v)| {
[0m[32m+                    if k == "temperature" {
[0m[32m+                        if is_metric {
[0m[32m+                            (k, v)
[0m[32m+                        } else {
[0m[32m+                            (
[0m[32m+                                k,
[0m[32m+                                format!(
[0m[32m+                                    "{:.1} ┬░F",
[0m[32m+                                    mazerion_core::celsius_to_fahrenheit(temp_celsius)
[0m[32m+                                ),
[0m[32m+                            )
[0m[32m+                        }
[0m[32m+                    } else if k == "calibration" {
[0m[32m+                        (k, if is_metric { v } else { "68┬░F".to_string() })
[0m[32m+                    } else {
[0m[32m+                        (k, v)
[0m[32m+                    }
[0m[32m+                })
[0m[32m+                .collect();
[0m         }
         Err(e) => {
             app.result = Some(format!("Error: {}", e));
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\advanced.rs:238:
         }
     }
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\basic.rs:2:
 //! ABV, BrixΓåöSG bidirectional, Dilution with Fl Oz
 
 use crate::{MazerionApp, state::BasicCalculator};
[31m-use eframe::egui::{self, RichText, CornerRadius};
[0m[32m+use eframe::egui::{self, CornerRadius, RichText};
[0m use mazerion_core::CalcInput;
[31m-use std::str::FromStr;
[0m use rust_decimal::Decimal;
[32m+use std::str::FromStr;
[0m 
 pub fn render(app: &mut MazerionApp, ui: &mut egui::Ui) {
     let c = app.state.custom_colors;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\basic.rs:15:
         egui::ComboBox::from_id_salt("basic_calc")
             .selected_text(get_calc_name(app.state.basic_calc))
             .show_ui(ui, |ui| {
[31m-                ui.selectable_value(&mut app.state.basic_calc, BasicCalculator::Abv, "ABV Calculator");
[0m[31m-                ui.selectable_value(&mut app.state.basic_calc, BasicCalculator::BrixSgConverter, "Brix Γåö SG Converter");
[0m[31m-                ui.selectable_value(&mut app.state.basic_calc, BasicCalculator::Dilution, "Dilution Calculator");
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.basic_calc,
[0m[32m+                    BasicCalculator::Abv,
[0m[32m+                    "ABV Calculator",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.basic_calc,
[0m[32m+                    BasicCalculator::BrixSgConverter,
[0m[32m+                    "Brix Γåö SG Converter",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.basic_calc,
[0m[32m+                    BasicCalculator::Dilution,
[0m[32m+                    "Dilution Calculator",
[0m[32m+                );
[0m             });
     });
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\basic.rs:28:
         .stroke(egui::Stroke::new(1.5, c.honey_gold))
         .corner_radius(CornerRadius::same(8))
         .inner_margin(15.0)
[31m-        .show(ui, |ui| {
[0m[31m-            match app.state.basic_calc {
[0m[31m-                BasicCalculator::Abv => render_abv(app, ui, c),
[0m[31m-                BasicCalculator::BrixSgConverter => render_brix_converter(app, ui, c),
[0m[31m-                BasicCalculator::Dilution => render_dilution(app, ui, c),
[0m[31m-            }
[0m[32m+        .show(ui, |ui| match app.state.basic_calc {
[0m[32m+            BasicCalculator::Abv => render_abv(app, ui, c),
[0m[32m+            BasicCalculator::BrixSgConverter => render_brix_converter(app, ui, c),
[0m[32m+            BasicCalculator::Dilution => render_dilution(app, ui, c),
[0m         });
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\basic.rs:50:
     ui.label("Calculate alcohol by volume from gravity readings");
     ui.add_space(10.0);
 
[31m-    crate::input_field(ui, "Original Gravity (OG):", &mut app.og, "Starting specific gravity (e.g., 1.090)");
[0m[31m-    crate::input_field(ui, "Final Gravity (FG):", &mut app.fg, "Ending specific gravity (e.g., 1.010)");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Original Gravity (OG):",
[0m[32m+        &mut app.og,
[0m[32m+        "Starting specific gravity (e.g., 1.090)",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Final Gravity (FG):",
[0m[32m+        &mut app.fg,
[0m[32m+        "Ending specific gravity (e.g., 1.010)",
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\basic.rs:67:
 
     // Brix to SG
     ui.label(RichText::new("Brix ΓåÆ SG:").strong());
[31m-    crate::input_field(ui, "Brix (┬░Bx):", &mut app.brix, "Degrees Brix to convert to SG");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Brix (┬░Bx):",
[0m[32m+        &mut app.brix,
[0m[32m+        "Degrees Brix to convert to SG",
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\basic.rs:74:
     // SG to Brix
     ui.label(RichText::new("SG ΓåÆ Brix:").strong());
[31m-    crate::input_field(ui, "Specific Gravity:", &mut app.sg_for_brix, "SG to convert to Brix (e.g., 1.083)");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Specific Gravity:",
[0m[32m+        &mut app.sg_for_brix,
[0m[32m+        "SG to convert to Brix (e.g., 1.083)",
[0m[32m+    );
[0m 
     ui.add_space(5.0);
[31m-    ui.label(RichText::new("≡ƒÆí Tip: Fill in either Brix OR SG, leave the other empty").size(12.0).weak());
[0m[32m+    ui.label(
[0m[32m+        RichText::new("≡ƒÆí Tip: Fill in either Brix OR SG, leave the other empty")
[0m[32m+            .size(12.0)
[0m[32m+            .weak(),
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\basic.rs:90:
     ui.label("Calculate water needed to reduce ABV");
     ui.add_space(10.0);
 
[31m-    let vol_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) { "L" } else { "gal" };
[0m[31m-    crate::input_field(ui, &format!("Current Volume ({}):", vol_unit), &mut app.current_vol, "Current volume");
[0m[31m-    crate::input_field(ui, "Current ABV (%):", &mut app.current_abv, "Current alcohol percentage");
[0m[31m-    crate::input_field(ui, "Target ABV (%):", &mut app.target_abv, "Desired alcohol percentage");
[0m[32m+    let vol_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) {
[0m[32m+        "L"
[0m[32m+    } else {
[0m[32m+        "gal"
[0m[32m+    };
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Current Volume ({}):", vol_unit),
[0m[32m+        &mut app.current_vol,
[0m[32m+        "Current volume",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Current ABV (%):",
[0m[32m+        &mut app.current_abv,
[0m[32m+        "Current alcohol percentage",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Target ABV (%):",
[0m[32m+        &mut app.target_abv,
[0m[32m+        "Desired alcohol percentage",
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\basic.rs:275:
         }
     }
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:2:
 //! All 5 calculators fully functional with unit system support
 
 pub(crate) use crate::state::BeerCalculator;
[31m-use crate::{state::{colors, UnitSystem}, MazerionApp};
[0m[31m-use eframe::egui::{self, CornerRadius, RichText, Color32, ScrollArea};
[0m[32m+use crate::{
[0m[32m+    MazerionApp,
[0m[32m+    state::{UnitSystem, colors},
[0m[32m+};
[0m[32m+use eframe::egui::{self, Color32, CornerRadius, RichText, ScrollArea};
[0m use rust_decimal::Decimal;
 use std::str::FromStr;
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:13:
         egui::ComboBox::from_id_salt("beer_calc")
             .selected_text(get_calc_name(app.state.beer_calc))
             .show_ui(ui, |ui| {
[31m-                ui.selectable_value(&mut app.state.beer_calc, BeerCalculator::Ibu, "IBU Calculator");
[0m[31m-                ui.selectable_value(&mut app.state.beer_calc, BeerCalculator::Srm, "SRM Color Calculator");
[0m[31m-                ui.selectable_value(&mut app.state.beer_calc, BeerCalculator::Mash, "Mash Water Calculator");
[0m[31m-                ui.selectable_value(&mut app.state.beer_calc, BeerCalculator::Efficiency, "Brewhouse Efficiency");
[0m[31m-                ui.selectable_value(&mut app.state.beer_calc, BeerCalculator::StyleGuide, "Beer Style Guide");
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.beer_calc,
[0m[32m+                    BeerCalculator::Ibu,
[0m[32m+                    "IBU Calculator",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.beer_calc,
[0m[32m+                    BeerCalculator::Srm,
[0m[32m+                    "SRM Color Calculator",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.beer_calc,
[0m[32m+                    BeerCalculator::Mash,
[0m[32m+                    "Mash Water Calculator",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.beer_calc,
[0m[32m+                    BeerCalculator::Efficiency,
[0m[32m+                    "Brewhouse Efficiency",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.beer_calc,
[0m[32m+                    BeerCalculator::StyleGuide,
[0m[32m+                    "Beer Style Guide",
[0m[32m+                );
[0m             });
     });
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:28:
         .stroke(egui::Stroke::new(1.5, colors::HONEY_GOLD))
         .corner_radius(CornerRadius::same(8))
         .inner_margin(15.0)
[31m-        .show(ui, |ui| {
[0m[31m-            match app.state.beer_calc {
[0m[31m-                BeerCalculator::Ibu => render_ibu(app, ui),
[0m[31m-                BeerCalculator::Srm => render_srm(app, ui),
[0m[31m-                BeerCalculator::Mash => render_mash(app, ui),
[0m[31m-                BeerCalculator::Efficiency => render_efficiency(app, ui),
[0m[31m-                BeerCalculator::StyleGuide => render_style_guide(ui),
[0m[31m-            }
[0m[32m+        .show(ui, |ui| match app.state.beer_calc {
[0m[32m+            BeerCalculator::Ibu => render_ibu(app, ui),
[0m[32m+            BeerCalculator::Srm => render_srm(app, ui),
[0m[32m+            BeerCalculator::Mash => render_mash(app, ui),
[0m[32m+            BeerCalculator::Efficiency => render_efficiency(app, ui),
[0m[32m+            BeerCalculator::StyleGuide => render_style_guide(ui),
[0m         });
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:60:
     };
 
     crate::input_field(ui, weight_label, &mut app.hop_weight, "Weight of hops");
[31m-    crate::input_field(ui, "Alpha Acid (%):", &mut app.alpha_acid, "Alpha acid percentage (5-15% typical)");
[0m[31m-    crate::input_field(ui, "Boil Time (min):", &mut app.boil_time, "Boil duration in minutes (0-120)");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Alpha Acid (%):",
[0m[32m+        &mut app.alpha_acid,
[0m[32m+        "Alpha acid percentage (5-15% typical)",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Boil Time (min):",
[0m[32m+        &mut app.boil_time,
[0m[32m+        "Boil duration in minutes (0-120)",
[0m[32m+    );
[0m     crate::input_field(ui, volume_label, &mut app.beer_volume, "Batch volume");
[31m-    crate::input_field(ui, "Boil Gravity:", &mut app.boil_gravity, "Specific gravity during boil (e.g., 1.050)");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Boil Gravity:",
[0m[32m+        &mut app.boil_gravity,
[0m[32m+        "Specific gravity during boil (e.g., 1.050)",
[0m[32m+    );
[0m 
     ui.add_space(5.0);
[31m-    ui.label(RichText::new("≡ƒÆí Tip: Higher gravity reduces utilization. Longer boils increase bitterness.").size(12.0));
[0m[32m+    ui.label(
[0m[32m+        RichText::new(
[0m[32m+            "≡ƒÆí Tip: Higher gravity reduces utilization. Longer boils increase bitterness.",
[0m[32m+        )
[0m[32m+        .size(12.0),
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:85:
         UnitSystem::Imperial => ("Grain Weight (lb):", "Batch Volume (gal):"),
     };
 
[31m-    crate::input_field(ui, weight_label, &mut app.grain_weight, "Total grain weight");
[0m[31m-    crate::input_field(ui, "Lovibond:", &mut app.grain_lovibond, "Grain color in Lovibond (2-500)");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        weight_label,
[0m[32m+        &mut app.grain_weight,
[0m[32m+        "Total grain weight",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Lovibond:",
[0m[32m+        &mut app.grain_lovibond,
[0m[32m+        "Grain color in Lovibond (2-500)",
[0m[32m+    );
[0m     crate::input_field(ui, volume_label, &mut app.beer_volume, "Batch volume");
 
     ui.add_space(5.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:93:
[31m-    ui.label(RichText::new("≡ƒÆí Common: Pale Malt ~2┬░L, Crystal ~60┬░L, Chocolate ~350┬░L, Black ~500┬░L").size(12.0));
[0m[32m+    ui.label(
[0m[32m+        RichText::new("≡ƒÆí Common: Pale Malt ~2┬░L, Crystal ~60┬░L, Chocolate ~350┬░L, Black ~500┬░L")
[0m[32m+            .size(12.0),
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:109:
             "Grain Weight (kg):",
             "Target Mash Temp (┬░C):",
             "Water Ratio (L/kg):",
[31m-            "Water-to-grain ratio (1.25-2.0 L/kg typical)"
[0m[32m+            "Water-to-grain ratio (1.25-2.0 L/kg typical)",
[0m         ),
         UnitSystem::Imperial => (
             "Grain Weight (lb):",
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:116:
             "Target Mash Temp (┬░F):",
             "Water Ratio (qt/lb):",
[31m-            "Water-to-grain ratio (1.0-2.0 qt/lb typical)"
[0m[32m+            "Water-to-grain ratio (1.0-2.0 qt/lb typical)",
[0m         ),
     };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:122:
[31m-    crate::input_field(ui, weight_label, &mut app.grain_weight, "Total grain weight");
[0m[31m-    crate::input_field(ui, temp_label, &mut app.mash_target_temp, "Desired mash temperature (65-68┬░C / 149-154┬░F)");
[0m[31m-    crate::input_field(ui, "Grain Temp:", &mut app.grain_temp, "Initial grain temperature (usually room temp)");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        weight_label,
[0m[32m+        &mut app.grain_weight,
[0m[32m+        "Total grain weight",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        temp_label,
[0m[32m+        &mut app.mash_target_temp,
[0m[32m+        "Desired mash temperature (65-68┬░C / 149-154┬░F)",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Grain Temp:",
[0m[32m+        &mut app.grain_temp,
[0m[32m+        "Initial grain temperature (usually room temp)",
[0m[32m+    );
[0m     crate::input_field(ui, ratio_label, &mut app.mash_ratio, ratio_hint);
 
     ui.add_space(5.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:128:
[31m-    ui.label(RichText::new("≡ƒÆí Typical: 66┬░C (151┬░F) for balanced, 68┬░C (154┬░F) for maltier beer").size(12.0));
[0m[32m+    ui.label(
[0m[32m+        RichText::new("≡ƒÆí Typical: 66┬░C (151┬░F) for balanced, 68┬░C (154┬░F) for maltier beer")
[0m[32m+            .size(12.0),
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:144:
         UnitSystem::Imperial => ("Grain Weight (lb):", "Final Volume (gal):"),
     };
 
[31m-    crate::input_field(ui, weight_label, &mut app.grain_weight, "Total grain weight");
[0m[31m-    crate::input_field(ui, "Grain PPG:", &mut app.grain_ppg, "Points per pound per gallon (35-40 typical for base malt)");
[0m[31m-    crate::input_field(ui, "Measured OG:", &mut app.measured_gravity, "Actual original gravity measured (e.g., 1.050)");
[0m[31m-    crate::input_field(ui, volume_label, &mut app.beer_volume, "Final volume into fermenter");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        weight_label,
[0m[32m+        &mut app.grain_weight,
[0m[32m+        "Total grain weight",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Grain PPG:",
[0m[32m+        &mut app.grain_ppg,
[0m[32m+        "Points per pound per gallon (35-40 typical for base malt)",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Measured OG:",
[0m[32m+        &mut app.measured_gravity,
[0m[32m+        "Actual original gravity measured (e.g., 1.050)",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        volume_label,
[0m[32m+        &mut app.beer_volume,
[0m[32m+        "Final volume into fermenter",
[0m[32m+    );
[0m 
     ui.add_space(5.0);
     ui.label(RichText::new("≡ƒÆí Good brewhouse efficiency: 70-80%").size(12.0));
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:160:
 }
 
 fn render_style_guide(ui: &mut egui::Ui) {
[31m-    ui.heading(RichText::new("≡ƒôû BJCP Beer Style Guide").color(colors::SADDLE_BROWN).size(20.0));
[0m[32m+    ui.heading(
[0m[32m+        RichText::new("≡ƒôû BJCP Beer Style Guide")
[0m[32m+            .color(colors::SADDLE_BROWN)
[0m[32m+            .size(20.0),
[0m[32m+    );
[0m     ui.label("Complete specifications for 29 classic beer styles");
     ui.add_space(15.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:229:
     });
 }
 
[31m-fn style_section(ui: &mut egui::Ui, title: &str, styles: &[(&str, &str, &str, &str, &str, &str, &str)]) {
[0m[31m-    ui.label(RichText::new(title).size(18.0).color(colors::SADDLE_BROWN).strong());
[0m[32m+fn style_section(
[0m[32m+    ui: &mut egui::Ui,
[0m[32m+    title: &str,
[0m[32m+    styles: &[(&str, &str, &str, &str, &str, &str, &str)],
[0m[32m+) {
[0m[32m+    ui.label(
[0m[32m+        RichText::new(title)
[0m[32m+            .size(18.0)
[0m[32m+            .color(colors::SADDLE_BROWN)
[0m[32m+            .strong(),
[0m[32m+    );
[0m     ui.add_space(5.0);
 
     for (name, og, fg, ibu, srm, abv, desc) in styles {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:241:
             .inner_margin(10.0)
             .show(ui, |ui| {
                 ui.heading(RichText::new(*name).color(colors::SADDLE_BROWN).size(14.0));
[31m-                ui.label(RichText::new(format!("OG: {} | FG: {} | IBU: {} | SRM: {} | ABV: {}", og, fg, ibu, srm, abv))
[0m[31m-                    .color(Color32::from_rgb(0, 100, 0)).size(11.0).strong());
[0m[32m+                ui.label(
[0m[32m+                    RichText::new(format!(
[0m[32m+                        "OG: {} | FG: {} | IBU: {} | SRM: {} | ABV: {}",
[0m[32m+                        og, fg, ibu, srm, abv
[0m[32m+                    ))
[0m[32m+                    .color(Color32::from_rgb(0, 100, 0))
[0m[32m+                    .size(11.0)
[0m[32m+                    .strong(),
[0m[32m+                );
[0m                 ui.add_space(5.0);
                 ui.label(*desc);
             });
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:309:
     };
 
     // Tinseth formula calculations
[31m-    let sg_diff = (gravity_val - Decimal::ONE).to_string().parse::<f64>().unwrap_or(0.05);
[0m[32m+    let sg_diff = (gravity_val - Decimal::ONE)
[0m[32m+        .to_string()
[0m[32m+        .parse::<f64>()
[0m[32m+        .unwrap_or(0.05);
[0m     let time_f64 = boil_time_val.to_string().parse::<f64>().unwrap_or(60.0);
 
     let bigness = 1.65 * 0.000125_f64.powf(sg_diff);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:323:
     app.result = Some(format!("IBU: {:.1}", ibu));
     app.warnings.clear();
     app.metadata.clear();
[31m-    app.metadata.push(("Formula".to_string(), "Tinseth".to_string()));
[0m[31m-    app.metadata.push(("Utilization".to_string(), format!("{:.1}%", util_decimal * Decimal::from(100))));
[0m[31m-    app.metadata.push(("Bigness Factor".to_string(), format!("{:.4}", bigness)));
[0m[31m-    app.metadata.push(("Boil Factor".to_string(), format!("{:.4}", boil_factor)));
[0m[32m+    app.metadata
[0m[32m+        .push(("Formula".to_string(), "Tinseth".to_string()));
[0m[32m+    app.metadata.push((
[0m[32m+        "Utilization".to_string(),
[0m[32m+        format!("{:.1}%", util_decimal * Decimal::from(100)),
[0m[32m+    ));
[0m[32m+    app.metadata
[0m[32m+        .push(("Bigness Factor".to_string(), format!("{:.4}", bigness)));
[0m[32m+    app.metadata
[0m[32m+        .push(("Boil Factor".to_string(), format!("{:.4}", boil_factor)));
[0m 
     if ibu > Decimal::from(100) {
[31m-        app.warnings.push("IBU > 100 is extremely bitter".to_string());
[0m[32m+        app.warnings
[0m[32m+            .push("IBU > 100 is extremely bitter".to_string());
[0m     }
     if alpha_acid_val > Decimal::from(20) {
[31m-        app.warnings.push("Alpha acid > 20% is unusually high - verify value".to_string());
[0m[32m+        app.warnings
[0m[32m+            .push("Alpha acid > 20% is unusually high - verify value".to_string());
[0m     }
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:400:
     app.result = Some(format!("SRM: {:.1}", srm));
     app.warnings.clear();
     app.metadata.clear();
[31m-    app.metadata.push(("Formula".to_string(), "Morey".to_string()));
[0m[31m-    app.metadata.push(("MCU".to_string(), format!("{:.1}", mcu)));
[0m[31m-    app.metadata.push(("Color Description".to_string(), color_desc.to_string()));
[0m[32m+    app.metadata
[0m[32m+        .push(("Formula".to_string(), "Morey".to_string()));
[0m[32m+    app.metadata
[0m[32m+        .push(("MCU".to_string(), format!("{:.1}", mcu)));
[0m[32m+    app.metadata
[0m[32m+        .push(("Color Description".to_string(), color_desc.to_string()));
[0m }
 
 fn calc_mash(app: &mut MazerionApp) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:444:
     let (target_c, grain_c) = if is_metric {
         (target_temp_val, grain_temp_val)
     } else {
[31m-        let target_c = (target_temp_val - Decimal::from(32)) * Decimal::new(5, 0) / Decimal::new(9, 0);
[0m[31m-        let grain_c = (grain_temp_val - Decimal::from(32)) * Decimal::new(5, 0) / Decimal::new(9, 0);
[0m[32m+        let target_c =
[0m[32m+            (target_temp_val - Decimal::from(32)) * Decimal::new(5, 0) / Decimal::new(9, 0);
[0m[32m+        let grain_c =
[0m[32m+            (grain_temp_val - Decimal::from(32)) * Decimal::new(5, 0) / Decimal::new(9, 0);
[0m         (target_c, grain_c)
     };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:469:
     let (strike_display, water_display) = if is_metric {
         (
             format!("{:.1}┬░C", strike_temp_c),
[31m-            format!("{:.2} L", water_volume_l)
[0m[32m+            format!("{:.2} L", water_volume_l),
[0m         )
     } else {
[31m-        let strike_f = (strike_temp_c * Decimal::new(9, 0) / Decimal::new(5, 0)) + Decimal::from(32);
[0m[32m+        let strike_f =
[0m[32m+            (strike_temp_c * Decimal::new(9, 0) / Decimal::new(5, 0)) + Decimal::from(32);
[0m         let water_gal = water_volume_l * Decimal::new(264172, 6);
         (
             format!("{:.1}┬░F", strike_f),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:479:
[31m-            format!("{:.2} gal", water_gal)
[0m[32m+            format!("{:.2} gal", water_gal),
[0m         )
     };
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:483:
     app.result = Some(format!("Strike Water: {}", strike_display));
     app.warnings.clear();
     app.metadata.clear();
[31m-    app.metadata.push(("Strike Temperature".to_string(), strike_display));
[0m[31m-    app.metadata.push(("Water Volume".to_string(), water_display));
[0m[31m-    app.metadata.push(("Mash Ratio".to_string(), if is_metric {
[0m[31m-        format!("{:.2} L/kg", ratio_l_kg)
[0m[31m-    } else {
[0m[31m-        format!("{:.2} qt/lb", ratio_val)
[0m[31m-    }));
[0m[32m+    app.metadata
[0m[32m+        .push(("Strike Temperature".to_string(), strike_display));
[0m[32m+    app.metadata
[0m[32m+        .push(("Water Volume".to_string(), water_display));
[0m[32m+    app.metadata.push((
[0m[32m+        "Mash Ratio".to_string(),
[0m[32m+        if is_metric {
[0m[32m+            format!("{:.2} L/kg", ratio_l_kg)
[0m[32m+        } else {
[0m[32m+            format!("{:.2} qt/lb", ratio_val)
[0m[32m+        },
[0m[32m+    ));
[0m 
     if strike_temp_c > Decimal::from(80) {
[31m-        app.warnings.push("Strike temp >80┬░C (176┬░F) may extract tannins".to_string());
[0m[32m+        app.warnings
[0m[32m+            .push("Strike temp >80┬░C (176┬░F) may extract tannins".to_string());
[0m     }
     if strike_temp_c < Decimal::from(50) {
[31m-        app.warnings.push("Strike temp <50┬░C (122┬░F) may be too cold".to_string());
[0m[32m+        app.warnings
[0m[32m+            .push("Strike temp <50┬░C (122┬░F) may be too cold".to_string());
[0m     }
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\beer.rs:560:
     app.result = Some(format!("Efficiency: {:.1}%", efficiency));
     app.warnings.clear();
     app.metadata.clear();
[31m-    app.metadata.push(("Brewhouse Efficiency".to_string(), format!("{:.1}%", efficiency)));
[0m[31m-    app.metadata.push(("Measured Points".to_string(), format!("{:.1}", measured_points)));
[0m[31m-    app.metadata.push(("Total Points".to_string(), format!("{:.1}", total_measured_points)));
[0m[31m-    app.metadata.push(("Potential Points".to_string(), format!("{:.1}", potential_points)));
[0m[32m+    app.metadata.push((
[0m[32m+        "Brewhouse Efficiency".to_string(),
[0m[32m+        format!("{:.1}%", efficiency),
[0m[32m+    ));
[0m[32m+    app.metadata.push((
[0m[32m+        "Measured Points".to_string(),
[0m[32m+        format!("{:.1}", measured_points),
[0m[32m+    ));
[0m[32m+    app.metadata.push((
[0m[32m+        "Total Points".to_string(),
[0m[32m+        format!("{:.1}", total_measured_points),
[0m[32m+    ));
[0m[32m+    app.metadata.push((
[0m[32m+        "Potential Points".to_string(),
[0m[32m+        format!("{:.1}", potential_points),
[0m[32m+    ));
[0m 
     if efficiency < Decimal::from(60) {
[31m-        app.warnings.push("Low efficiency (<60%) - check mash process".to_string());
[0m[32m+        app.warnings
[0m[32m+            .push("Low efficiency (<60%) - check mash process".to_string());
[0m     }
     if efficiency > Decimal::from(90) {
[31m-        app.warnings.push("Very high efficiency (>90%) - verify measurements".to_string());
[0m[32m+        app.warnings
[0m[32m+            .push("Very high efficiency (>90%) - verify measurements".to_string());
[0m     }
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:1:
 //! Brewing calculators tab with TOSNA protocol support
 
[31m-use crate::{MazerionApp, state::{BrewingCalculator, colors}};
[0m[31m-use eframe::egui::{self, RichText, CornerRadius, Color32};
[0m[32m+use crate::{
[0m[32m+    MazerionApp,
[0m[32m+    state::{BrewingCalculator, colors},
[0m[32m+};
[0m[32m+use eframe::egui::{self, Color32, CornerRadius, RichText};
[0m use mazerion_core::CalcInput;
[31m-use std::str::FromStr;
[0m use rust_decimal::Decimal;
[32m+use std::str::FromStr;
[0m 
 pub fn render(app: &mut MazerionApp, ui: &mut egui::Ui) {
     ui.horizontal(|ui| {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:12:
         egui::ComboBox::from_id_salt("brewing_calc")
             .selected_text(get_calc_name(app.state.brewing_calc))
             .show_ui(ui, |ui| {
[31m-                ui.selectable_value(&mut app.state.brewing_calc, BrewingCalculator::Nutrition, "TOSNA Nutrition Calculator");
[0m[31m-                ui.selectable_value(&mut app.state.brewing_calc, BrewingCalculator::Carbonation, "Carbonation Calculator");
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.brewing_calc,
[0m[32m+                    BrewingCalculator::Nutrition,
[0m[32m+                    "TOSNA Nutrition Calculator",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.brewing_calc,
[0m[32m+                    BrewingCalculator::Carbonation,
[0m[32m+                    "Carbonation Calculator",
[0m[32m+                );
[0m             });
     });
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:24:
         .stroke(egui::Stroke::new(1.5, colors::HONEY_GOLD))
         .corner_radius(CornerRadius::same(8))
         .inner_margin(15.0)
[31m-        .show(ui, |ui| {
[0m[31m-            match app.state.brewing_calc {
[0m[31m-                BrewingCalculator::Nutrition => render_nutrition(app, ui),
[0m[31m-                BrewingCalculator::Carbonation => render_carbonation(app, ui),
[0m[31m-            }
[0m[32m+        .show(ui, |ui| match app.state.brewing_calc {
[0m[32m+            BrewingCalculator::Nutrition => render_nutrition(app, ui),
[0m[32m+            BrewingCalculator::Carbonation => render_carbonation(app, ui),
[0m         });
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:44:
     ui.label("Calculate Fermaid-O schedule using TOSNA protocols");
     ui.add_space(10.0);
 
[31m-    let vol_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) { "L" } else { "gal" };
[0m[32m+    let vol_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) {
[0m[32m+        "L"
[0m[32m+    } else {
[0m[32m+        "gal"
[0m[32m+    };
[0m 
[31m-    crate::input_field(ui, &format!("Volume ({}):", vol_unit), &mut app.volume, "Total must volume");
[0m[31m-    crate::input_field(ui, "Target ABV (%):", &mut app.target_abv_brew, "Expected final ABV");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Volume ({}):", vol_unit),
[0m[32m+        &mut app.volume,
[0m[32m+        "Total must volume",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Target ABV (%):",
[0m[32m+        &mut app.target_abv_brew,
[0m[32m+        "Expected final ABV",
[0m[32m+    );
[0m 
     // TOSNA Protocol selector - using yn_requirement field temporarily as protocol selector
     ui.add_space(5.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:58:
         let current_protocol = match app.yn_requirement.chars().next() {
             Some('1') => "TOSNA 1.0",
             Some('3') => "TOSNA 3.0",
[31m-            _ => "TOSNA 2.0"
[0m[32m+            _ => "TOSNA 2.0",
[0m         };
 
         egui::ComboBox::from_id_salt("tosna_protocol")
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:65:
             .selected_text(current_protocol)
             .width(200.0)
             .show_ui(ui, |ui| {
[31m-                if ui.selectable_label(current_protocol == "TOSNA 1.0", "TOSNA 1.0 (Original)").clicked() {
[0m[32m+                if ui
[0m[32m+                    .selectable_label(current_protocol == "TOSNA 1.0", "TOSNA 1.0 (Original)")
[0m[32m+                    .clicked()
[0m[32m+                {
[0m                     app.yn_requirement = "1_medium".to_string();
                 }
[31m-                if ui.selectable_label(current_protocol == "TOSNA 2.0", "TOSNA 2.0 (Recommended)").clicked() {
[0m[32m+                if ui
[0m[32m+                    .selectable_label(current_protocol == "TOSNA 2.0", "TOSNA 2.0 (Recommended)")
[0m[32m+                    .clicked()
[0m[32m+                {
[0m                     app.yn_requirement = "medium".to_string();
                 }
[31m-                if ui.selectable_label(current_protocol == "TOSNA 3.0", "TOSNA 3.0 (High Gravity)").clicked() {
[0m[32m+                if ui
[0m[32m+                    .selectable_label(current_protocol == "TOSNA 3.0", "TOSNA 3.0 (High Gravity)")
[0m[32m+                    .clicked()
[0m[32m+                {
[0m                     app.yn_requirement = "3_medium".to_string();
                 }
             });
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:84:
         .stroke(egui::Stroke::new(1.0, colors::HONEY_GOLD))
         .corner_radius(CornerRadius::same(4))
         .inner_margin(8.0)
[31m-        .show(ui, |ui| {
[0m[31m-            match app.yn_requirement.chars().next() {
[0m[31m-                Some('1') => {
[0m[31m-                    ui.label(RichText::new("≡ƒô£ TOSNA 1.0 - Original Protocol").strong().color(colors::SADDLE_BROWN));
[0m[31m-                    ui.label("ΓÇó Schedule: 33% - 33% - 33% over 7 days");
[0m[31m-                    ui.label("ΓÇó Timing: Day 1, Day 3, Day 7");
[0m[31m-                    ui.label("ΓÇó When to use: Simple low-gravity meads (OG <1.100)");
[0m[31m-                    ui.label("ΓÇó Note: Older protocol - TOSNA 2.0 generally preferred");
[0m[31m-                },
[0m[31m-                Some('3') => {
[0m[31m-                    ui.label(RichText::new("≡ƒÜÇ TOSNA 3.0 - Advanced High-Gravity Protocol").strong().color(colors::SADDLE_BROWN));
[0m[31m-                    ui.label("ΓÇó Schedule: 5% - 20% - 50% - 25% (4 additions)");
[0m[31m-                    ui.label("ΓÇó Timing: 24hr, 48hr, 1/3 break (~1.070), 2/3 break (~1.040)");
[0m[31m-                    ui.label("ΓÇó When to use: HIGH GRAVITY meads (OG >1.100, ABV >14%)");
[0m[31m-                    ui.label("ΓÇó Why: More gradual feeding prevents stuck ferments");
[0m[31m-                    ui.label("ΓÇó Best for: Sack meads, dessert meads, high-ABV traditional");
[0m[31m-                },
[0m[31m-                _ => {
[0m[31m-                    ui.label(RichText::new("Γ¡É TOSNA 2.0 - Recommended Standard").strong().color(colors::SADDLE_BROWN));
[0m[31m-                    ui.label("ΓÇó Schedule: 25% - 50% - 25% (3 additions)");
[0m[31m-                    ui.label("ΓÇó Timing: 24hr, 1/3 break (~1.070), 2/3 break (~1.040)");
[0m[31m-                    ui.label("ΓÇó When to use: MOST MEADS (OG 1.080-1.120, ABV 10-14%)");
[0m[31m-                    ui.label("ΓÇó Why: Balanced nutrition matches yeast growth curve");
[0m[31m-                    ui.label("ΓÇó Best for: Traditional meads, melomels, session meads");
[0m[31m-                }
[0m[32m+        .show(ui, |ui| match app.yn_requirement.chars().next() {
[0m[32m+            Some('1') => {
[0m[32m+                ui.label(
[0m[32m+                    RichText::new("≡ƒô£ TOSNA 1.0 - Original Protocol")
[0m[32m+                        .strong()
[0m[32m+                        .color(colors::SADDLE_BROWN),
[0m[32m+                );
[0m[32m+                ui.label("ΓÇó Schedule: 33% - 33% - 33% over 7 days");
[0m[32m+                ui.label("ΓÇó Timing: Day 1, Day 3, Day 7");
[0m[32m+                ui.label("ΓÇó When to use: Simple low-gravity meads (OG <1.100)");
[0m[32m+                ui.label("ΓÇó Note: Older protocol - TOSNA 2.0 generally preferred");
[0m             }
[32m+            Some('3') => {
[0m[32m+                ui.label(
[0m[32m+                    RichText::new("≡ƒÜÇ TOSNA 3.0 - Advanced High-Gravity Protocol")
[0m[32m+                        .strong()
[0m[32m+                        .color(colors::SADDLE_BROWN),
[0m[32m+                );
[0m[32m+                ui.label("ΓÇó Schedule: 5% - 20% - 50% - 25% (4 additions)");
[0m[32m+                ui.label("ΓÇó Timing: 24hr, 48hr, 1/3 break (~1.070), 2/3 break (~1.040)");
[0m[32m+                ui.label("ΓÇó When to use: HIGH GRAVITY meads (OG >1.100, ABV >14%)");
[0m[32m+                ui.label("ΓÇó Why: More gradual feeding prevents stuck ferments");
[0m[32m+                ui.label("ΓÇó Best for: Sack meads, dessert meads, high-ABV traditional");
[0m[32m+            }
[0m[32m+            _ => {
[0m[32m+                ui.label(
[0m[32m+                    RichText::new("Γ¡É TOSNA 2.0 - Recommended Standard")
[0m[32m+                        .strong()
[0m[32m+                        .color(colors::SADDLE_BROWN),
[0m[32m+                );
[0m[32m+                ui.label("ΓÇó Schedule: 25% - 50% - 25% (3 additions)");
[0m[32m+                ui.label("ΓÇó Timing: 24hr, 1/3 break (~1.070), 2/3 break (~1.040)");
[0m[32m+                ui.label("ΓÇó When to use: MOST MEADS (OG 1.080-1.120, ABV 10-14%)");
[0m[32m+                ui.label("ΓÇó Why: Balanced nutrition matches yeast growth curve");
[0m[32m+                ui.label("ΓÇó Best for: Traditional meads, melomels, session meads");
[0m[32m+            }
[0m         });
 
     ui.add_space(10.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:118:
     ui.horizontal(|ui| {
         ui.label(RichText::new("Yeast Nitrogen Needs:").strong());
 
[31m-        let yeast_level = if app.yn_requirement.contains("low") { "low" }
[0m[31m-        else if app.yn_requirement.contains("high") { "high" }
[0m[31m-        else { "medium" };
[0m[32m+        let yeast_level = if app.yn_requirement.contains("low") {
[0m[32m+            "low"
[0m[32m+        } else if app.yn_requirement.contains("high") {
[0m[32m+            "high"
[0m[32m+        } else {
[0m[32m+            "medium"
[0m[32m+        };
[0m 
         egui::ComboBox::from_id_salt("yn_req")
             .selected_text(match yeast_level {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:127:
                 "low" => "Low (DV10, QA23, D254)",
                 "high" => "High (EC-1118, K1-V1116, RC212)",
[31m-                _ => "Medium (71B, D47, most yeasts)"
[0m[32m+                _ => "Medium (71B, D47, most yeasts)",
[0m             })
             .show_ui(ui, |ui| {
                 let protocol_prefix = match app.yn_requirement.chars().next() {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:133:
                     Some('1') => "1_",
                     Some('3') => "3_",
[31m-                    _ => ""
[0m[32m+                    _ => "",
[0m                 };
 
[31m-                if ui.selectable_label(yeast_level == "low", "Low (DV10, QA23, D254)").clicked() {
[0m[32m+                if ui
[0m[32m+                    .selectable_label(yeast_level == "low", "Low (DV10, QA23, D254)")
[0m[32m+                    .clicked()
[0m[32m+                {
[0m                     app.yn_requirement = format!("{}low", protocol_prefix);
                 }
[31m-                if ui.selectable_label(yeast_level == "medium", "Medium (71B, D47, most yeasts)").clicked() {
[0m[32m+                if ui
[0m[32m+                    .selectable_label(yeast_level == "medium", "Medium (71B, D47, most yeasts)")
[0m[32m+                    .clicked()
[0m[32m+                {
[0m                     app.yn_requirement = format!("{}medium", protocol_prefix);
                 }
[31m-                if ui.selectable_label(yeast_level == "high", "High (EC-1118, K1-V1116, RC212)").clicked() {
[0m[32m+                if ui
[0m[32m+                    .selectable_label(yeast_level == "high", "High (EC-1118, K1-V1116, RC212)")
[0m[32m+                    .clicked()
[0m[32m+                {
[0m                     app.yn_requirement = format!("{}high", protocol_prefix);
                 }
             });
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:181:
 
     // Parse protocol and yeast requirement from yn_requirement field
     let (protocol, yeast_req) = match app.yn_requirement.chars().next() {
[31m-        Some('1') => ("tosna_1", app.yn_requirement.strip_prefix("1_").unwrap_or("medium")),
[0m[31m-        Some('3') => ("tosna_3", app.yn_requirement.strip_prefix("3_").unwrap_or("medium")),
[0m[31m-        _ => ("tosna_2", app.yn_requirement.as_str())
[0m[32m+        Some('1') => (
[0m[32m+            "tosna_1",
[0m[32m+            app.yn_requirement.strip_prefix("1_").unwrap_or("medium"),
[0m[32m+        ),
[0m[32m+        Some('3') => (
[0m[32m+            "tosna_3",
[0m[32m+            app.yn_requirement.strip_prefix("3_").unwrap_or("medium"),
[0m[32m+        ),
[0m[32m+        _ => ("tosna_2", app.yn_requirement.as_str()),
[0m     };
 
     let input = CalcInput::new()
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:204:
                 (ounces, "oz")
             };
 
[31m-            app.result = Some(format!("Total Fermaid-O: {:.2} {}", display_amount, weight_unit));
[0m[32m+            app.result = Some(format!(
[0m[32m+                "Total Fermaid-O: {:.2} {}",
[0m[32m+                display_amount, weight_unit
[0m[32m+            ));
[0m             app.warnings = res.warnings;
 
             // Convert metadata weights if in Imperial
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:223:
 }
 
 fn convert_nutrition_metadata(metadata: &[(String, String)]) -> Vec<(String, String)> {
[31m-    metadata.iter().map(|(key, value)| {
[0m[31m-        // Convert grams in metadata to ounces
[0m[31m-        if key.starts_with("addition_") && value.contains(" g ") {
[0m[31m-            if let Some(g_pos) = value.find(" g ") {
[0m[31m-                if let Ok(grams) = Decimal::from_str(&value[..g_pos].trim()) {
[0m[31m-                    let ounces = grams * Decimal::new(35273962, 9);
[0m[31m-                    let rest = &value[g_pos+3..]; // Keep percentage and timing
[0m[31m-                    return (key.clone(), format!("{:.2} oz {}", ounces, rest));
[0m[32m+    metadata
[0m[32m+        .iter()
[0m[32m+        .map(|(key, value)| {
[0m[32m+            // Convert grams in metadata to ounces
[0m[32m+            if key.starts_with("addition_") && value.contains(" g ") {
[0m[32m+                if let Some(g_pos) = value.find(" g ") {
[0m[32m+                    if let Ok(grams) = Decimal::from_str(&value[..g_pos].trim()) {
[0m[32m+                        let ounces = grams * Decimal::new(35273962, 9);
[0m[32m+                        let rest = &value[g_pos + 3..]; // Keep percentage and timing
[0m[32m+                        return (key.clone(), format!("{:.2} oz {}", ounces, rest));
[0m[32m+                    }
[0m                 }
[31m-            }
[0m[31m-        } else if key == "total_fermaid_o" && value.ends_with(" g") {
[0m[31m-            if let Some(g_pos) = value.find(" g") {
[0m[31m-                if let Ok(grams) = Decimal::from_str(&value[..g_pos].trim()) {
[0m[31m-                    let ounces = grams * Decimal::new(35273962, 9);
[0m[31m-                    return (key.clone(), format!("{:.2} oz", ounces));
[0m[32m+            } else if key == "total_fermaid_o" && value.ends_with(" g") {
[0m[32m+                if let Some(g_pos) = value.find(" g") {
[0m[32m+                    if let Ok(grams) = Decimal::from_str(&value[..g_pos].trim()) {
[0m[32m+                        let ounces = grams * Decimal::new(35273962, 9);
[0m[32m+                        return (key.clone(), format!("{:.2} oz", ounces));
[0m[32m+                    }
[0m                 }
             }
[31m-        }
[0m[31m-        (key.clone(), value.clone())
[0m[31m-    }).collect()
[0m[32m+            (key.clone(), value.clone())
[0m[32m+        })
[0m[32m+        .collect()
[0m }
 
 fn render_carbonation(app: &mut MazerionApp, ui: &mut egui::Ui) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:250:
     ui.label("Calculate priming sugar or keg PSI for target carbonation");
     ui.add_space(10.0);
 
[31m-    let vol_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) { "L" } else { "gal" };
[0m[31m-    let temp_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) { "┬░C" } else { "┬░F" };
[0m[32m+    let vol_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) {
[0m[32m+        "L"
[0m[32m+    } else {
[0m[32m+        "gal"
[0m[32m+    };
[0m[32m+    let temp_unit = if matches!(app.state.unit_system, crate::state::UnitSystem::Metric) {
[0m[32m+        "┬░C"
[0m[32m+    } else {
[0m[32m+        "┬░F"
[0m[32m+    };
[0m 
[31m-    crate::input_field(ui, &format!("Volume ({}):", vol_unit), &mut app.volume, "Total volume to carbonate");
[0m[31m-    crate::input_field(ui, &format!("Temperature ({}):", temp_unit), &mut app.carb_temp, "Current temperature");
[0m[31m-    crate::input_field(ui, "Target COΓéé (volumes):", &mut app.target_co2, "Desired carbonation level (1.5-4.5)");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Volume ({}):", vol_unit),
[0m[32m+        &mut app.volume,
[0m[32m+        "Total volume to carbonate",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Temperature ({}):", temp_unit),
[0m[32m+        &mut app.carb_temp,
[0m[32m+        "Current temperature",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Target COΓéé (volumes):",
[0m[32m+        &mut app.target_co2,
[0m[32m+        "Desired carbonation level (1.5-4.5)",
[0m[32m+    );
[0m 
     ui.horizontal(|ui| {
         ui.label(RichText::new("Method:").strong());
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:262:
         egui::ComboBox::from_id_salt("carb_method")
             .selected_text(&app.carb_method)
             .show_ui(ui, |ui| {
[31m-                ui.selectable_value(&mut app.carb_method, "priming".to_string(), "Bottle Priming");
[0m[31m-                ui.selectable_value(&mut app.carb_method, "keg".to_string(), "Force Carbonation (Keg)");
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.carb_method,
[0m[32m+                    "priming".to_string(),
[0m[32m+                    "Bottle Priming",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.carb_method,
[0m[32m+                    "keg".to_string(),
[0m[32m+                    "Force Carbonation (Keg)",
[0m[32m+                );
[0m             });
     });
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:273:
             egui::ComboBox::from_id_salt("sugar_type")
                 .selected_text(&app.sugar_type)
                 .show_ui(ui, |ui| {
[31m-                    ui.selectable_value(&mut app.sugar_type, "table_sugar".to_string(), "Table Sugar (Sucrose)");
[0m[31m-                    ui.selectable_value(&mut app.sugar_type, "corn_sugar".to_string(), "Corn Sugar (Dextrose)");
[0m[32m+                    ui.selectable_value(
[0m[32m+                        &mut app.sugar_type,
[0m[32m+                        "table_sugar".to_string(),
[0m[32m+                        "Table Sugar (Sucrose)",
[0m[32m+                    );
[0m[32m+                    ui.selectable_value(
[0m[32m+                        &mut app.sugar_type,
[0m[32m+                        "corn_sugar".to_string(),
[0m[32m+                        "Corn Sugar (Dextrose)",
[0m[32m+                    );
[0m                     ui.selectable_value(&mut app.sugar_type, "honey".to_string(), "Honey");
                     ui.selectable_value(&mut app.sugar_type, "dme".to_string(), "Dry Malt Extract");
                 });
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:334:
     };
 
     let input = CalcInput::new()
[31m-        .add_param("volume", &volume_l)         // Always pass in liters
[0m[31m-        .add_param("temperature", &temp_c)      // Always pass in Celsius
[0m[32m+        .add_param("volume", &volume_l) // Always pass in liters
[0m[32m+        .add_param("temperature", &temp_c) // Always pass in Celsius
[0m         .add_param("target_co2", &app.target_co2)
         .add_param("method", &app.carb_method)
         .add_param("sugar_type", &app.sugar_type);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\brewing.rs:364:
         }
     }
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:1:
 use crate::MazerionApp;
 use crate::state::{FinishingCalculator, UnitSystem};
 use eframe::egui;
[32m+use eframe::epaint::Color32;
[0m use mazerion_calculators::*;
 use mazerion_core::{CalcInput, Calculator, Measurement};
 use rust_decimal::Decimal;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:7:
 use std::str::FromStr;
[31m-use eframe::epaint::Color32;
[0m 
 pub fn render(app: &mut MazerionApp, ui: &mut egui::Ui) {
     ui.heading("Γ£¿ Finishing & Stabilization");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:12:
     ui.add_space(10.0);
 
     ui.horizontal(|ui| {
[31m-        ui.selectable_value(&mut app.state.finishing_calc, FinishingCalculator::Backsweetening, "≡ƒì» Backsweetening");
[0m[31m-        ui.selectable_value(&mut app.state.finishing_calc, FinishingCalculator::Sulfite, "≡ƒº¬ Sulfite");
[0m[31m-        ui.selectable_value(&mut app.state.finishing_calc, FinishingCalculator::AcidAddition, "≡ƒìï Acid");
[0m[31m-        ui.selectable_value(&mut app.state.finishing_calc, FinishingCalculator::Pasteurization, "≡ƒöÑ Pasteurization");
[0m[31m-        ui.selectable_value(&mut app.state.finishing_calc, FinishingCalculator::Stabilization, "≡ƒöÆ Stabilization");
[0m[31m-        ui.selectable_value(&mut app.state.finishing_calc, FinishingCalculator::SweetnessChart, "≡ƒôè Sweetness");
[0m[32m+        ui.selectable_value(
[0m[32m+            &mut app.state.finishing_calc,
[0m[32m+            FinishingCalculator::Backsweetening,
[0m[32m+            "≡ƒì» Backsweetening",
[0m[32m+        );
[0m[32m+        ui.selectable_value(
[0m[32m+            &mut app.state.finishing_calc,
[0m[32m+            FinishingCalculator::Sulfite,
[0m[32m+            "≡ƒº¬ Sulfite",
[0m[32m+        );
[0m[32m+        ui.selectable_value(
[0m[32m+            &mut app.state.finishing_calc,
[0m[32m+            FinishingCalculator::AcidAddition,
[0m[32m+            "≡ƒìï Acid",
[0m[32m+        );
[0m[32m+        ui.selectable_value(
[0m[32m+            &mut app.state.finishing_calc,
[0m[32m+            FinishingCalculator::Pasteurization,
[0m[32m+            "≡ƒöÑ Pasteurization",
[0m[32m+        );
[0m[32m+        ui.selectable_value(
[0m[32m+            &mut app.state.finishing_calc,
[0m[32m+            FinishingCalculator::Stabilization,
[0m[32m+            "≡ƒöÆ Stabilization",
[0m[32m+        );
[0m[32m+        ui.selectable_value(
[0m[32m+            &mut app.state.finishing_calc,
[0m[32m+            FinishingCalculator::SweetnessChart,
[0m[32m+            "≡ƒôè Sweetness",
[0m[32m+        );
[0m     });
 
     ui.add_space(15.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:40:
     let is_metric = app.state.unit_system == UnitSystem::Metric;
     let vol_unit = if is_metric { "L" } else { "gal" };
 
[31m-    crate::input_field(ui, &format!("Volume ({}):", vol_unit), &mut app.sweet_vol, "Batch volume");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Volume ({}):", vol_unit),
[0m[32m+        &mut app.sweet_vol,
[0m[32m+        "Batch volume",
[0m[32m+    );
[0m     crate::input_field(ui, "Current SG:", &mut app.current_sg, "e.g., 1.000");
     crate::input_field(ui, "Target SG:", &mut app.target_sg, "e.g., 1.015");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:103:
     let is_metric = app.state.unit_system == UnitSystem::Metric;
     let vol_unit = if is_metric { "L" } else { "gal" };
 
[31m-    crate::input_field(ui, &format!("Volume ({}):", vol_unit), &mut app.sulfite_vol, "Batch volume");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Volume ({}):", vol_unit),
[0m[32m+        &mut app.sulfite_vol,
[0m[32m+        "Batch volume",
[0m[32m+    );
[0m     crate::input_field(ui, "pH:", &mut app.ph, "e.g., 3.5");
[31m-    crate::input_field(ui, "Target Free SOΓéé (ppm):", &mut app.target_so2, "e.g., 50");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Target Free SOΓéé (ppm):",
[0m[32m+        &mut app.target_so2,
[0m[32m+        "e.g., 50",
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:155:
     let is_metric = app.state.unit_system == UnitSystem::Metric;
     let vol_unit = if is_metric { "L" } else { "gal" };
 
[31m-    crate::input_field(ui, &format!("Volume ({}):", vol_unit), &mut app.acid_vol, "Batch volume");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Volume ({}):", vol_unit),
[0m[32m+        &mut app.acid_vol,
[0m[32m+        "Batch volume",
[0m[32m+    );
[0m     crate::input_field(ui, "Current pH:", &mut app.current_ph, "e.g., 3.8");
     crate::input_field(ui, "Target pH:", &mut app.target_ph_acid, "e.g., 3.4");
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:219:
     let is_metric = app.state.unit_system == UnitSystem::Metric;
     let temp_unit = if is_metric { "┬░C" } else { "┬░F" };
 
[31m-    crate::input_field(ui, &format!("Temperature ({}):", temp_unit), &mut app.pasteurization_temp,
[0m[31m-                       if is_metric { "e.g., 63" } else { "e.g., 145" });
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Temperature ({}):", temp_unit),
[0m[32m+        &mut app.pasteurization_temp,
[0m[32m+        if is_metric { "e.g., 63" } else { "e.g., 145" },
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:252:
         };
 
         let calc = PasteurizationCalculator::default();
[31m-        let input = CalcInput::new()
[0m[31m-            .add_param("temperature", &temp_celsius.to_string());
[0m[32m+        let input = CalcInput::new().add_param("temperature", &temp_celsius.to_string());
[0m 
         match calc.calculate(input) {
             Ok(res) => {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:261:
                 app.warnings = res.warnings;
 
                 // Override incorrect metadata with correct temperature values
[31m-                app.metadata = res.metadata.into_iter().map(|(k, v)| {
[0m[31m-                    if k == "temperature_c" {
[0m[31m-                        ("Temperature (┬░C)".to_string(), format!("{:.1}┬░C", temp_celsius))
[0m[31m-                    } else if k == "temperature_f" {
[0m[31m-                        ("Temperature (┬░F)".to_string(), format!("{:.1}┬░F", temp_fahrenheit))
[0m[31m-                    } else {
[0m[31m-                        (k, v)
[0m[31m-                    }
[0m[31m-                }).collect();
[0m[32m+                app.metadata = res
[0m[32m+                    .metadata
[0m[32m+                    .into_iter()
[0m[32m+                    .map(|(k, v)| {
[0m[32m+                        if k == "temperature_c" {
[0m[32m+                            (
[0m[32m+                                "Temperature (┬░C)".to_string(),
[0m[32m+                                format!("{:.1}┬░C", temp_celsius),
[0m[32m+                            )
[0m[32m+                        } else if k == "temperature_f" {
[0m[32m+                            (
[0m[32m+                                "Temperature (┬░F)".to_string(),
[0m[32m+                                format!("{:.1}┬░F", temp_fahrenheit),
[0m[32m+                            )
[0m[32m+                        } else {
[0m[32m+                            (k, v)
[0m[32m+                        }
[0m[32m+                    })
[0m[32m+                    .collect();
[0m             }
             Err(e) => {
                 app.result = Some(format!("Error: {}", e));
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:295:
     let is_metric = app.state.unit_system == UnitSystem::Metric;
     let vol_unit = if is_metric { "L" } else { "gal" };
 
[31m-    crate::input_field(ui, &format!("Volume ({}):", vol_unit), &mut app.stabilization_vol, "Batch volume");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Volume ({}):", vol_unit),
[0m[32m+        &mut app.stabilization_vol,
[0m[32m+        "Batch volume",
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:304:
         app.metadata.clear();
 
         let calc = StabilizationCalculator::default();
[31m-        let input = CalcInput::new()
[0m[31m-            .add_param("volume", &app.stabilization_vol);
[0m[32m+        let input = CalcInput::new().add_param("volume", &app.stabilization_vol);
[0m 
         match calc.calculate(input) {
             Ok(res) => {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:333:
 fn render_sweetness_chart(app: &mut MazerionApp, ui: &mut egui::Ui) {
     let c = &app.state.custom_colors;
 
[31m-    ui.heading(egui::RichText::new("≡ƒì» Mead Sweetness Guide")
[0m[31m-        .size(24.0)
[0m[31m-        .color(c.honey_gold));
[0m[32m+    ui.heading(
[0m[32m+        egui::RichText::new("≡ƒì» Mead Sweetness Guide")
[0m[32m+            .size(24.0)
[0m[32m+            .color(c.honey_gold),
[0m[32m+    );
[0m     ui.add_space(20.0);
 
[31m-    ui.label(egui::RichText::new("Understanding Final Gravity (FG) and Sweetness Perception")
[0m[31m-        .size(16.0)
[0m[31m-        .color(c.dark_text));
[0m[32m+    ui.label(
[0m[32m+        egui::RichText::new("Understanding Final Gravity (FG) and Sweetness Perception")
[0m[32m+            .size(16.0)
[0m[32m+            .color(c.dark_text),
[0m[32m+    );
[0m     ui.add_space(5.0);
     ui.label("Final Gravity determines residual sweetness. Use this guide to hit your target sweetness level.");
     ui.add_space(25.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:347:
 
     // Sweetness categories - each in its own result-style box
     let categories = [
[31m-        ("Bone Dry", "0.990 - 0.996", "Crisp, tart, wine-like finish. Zero residual sugar. Excellent for traditional meads aged on oak. Lets terroir shine through."),
[0m[31m-        ("Dry", "0.996 - 1.006", "Clean finish with very subtle sweetness. Honey character present but not sweet. Ideal for session meads and everyday drinking."),
[0m[31m-        ("Semi-Sweet", "1.006 - 1.015", "Noticeable honey sweetness, well-balanced. Most popular range. Perfect for traditional and fruit meads. Crowd-pleaser."),
[0m[31m-        ("Sweet", "1.015 - 1.025", "Dessert mead territory. Significant sweetness, honey-forward. Pairs excellently with spicy foods and strong cheeses."),
[0m[31m-        ("Very Sweet", "1.025 - 1.040", "Rich dessert mead, heavy sweetness. Best served in small portions. Excellent for sack mead or special occasions."),
[0m[32m+        (
[0m[32m+            "Bone Dry",
[0m[32m+            "0.990 - 0.996",
[0m[32m+            "Crisp, tart, wine-like finish. Zero residual sugar. Excellent for traditional meads aged on oak. Lets terroir shine through.",
[0m[32m+        ),
[0m[32m+        (
[0m[32m+            "Dry",
[0m[32m+            "0.996 - 1.006",
[0m[32m+            "Clean finish with very subtle sweetness. Honey character present but not sweet. Ideal for session meads and everyday drinking.",
[0m[32m+        ),
[0m[32m+        (
[0m[32m+            "Semi-Sweet",
[0m[32m+            "1.006 - 1.015",
[0m[32m+            "Noticeable honey sweetness, well-balanced. Most popular range. Perfect for traditional and fruit meads. Crowd-pleaser.",
[0m[32m+        ),
[0m[32m+        (
[0m[32m+            "Sweet",
[0m[32m+            "1.015 - 1.025",
[0m[32m+            "Dessert mead territory. Significant sweetness, honey-forward. Pairs excellently with spicy foods and strong cheeses.",
[0m[32m+        ),
[0m[32m+        (
[0m[32m+            "Very Sweet",
[0m[32m+            "1.025 - 1.040",
[0m[32m+            "Rich dessert mead, heavy sweetness. Best served in small portions. Excellent for sack mead or special occasions.",
[0m[32m+        ),
[0m     ];
 
     for (name, fg_range, desc) in categories {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:362:
             .inner_margin(15.0)
             .show(ui, |ui| {
                 ui.horizontal(|ui| {
[31m-                    ui.label(egui::RichText::new(name)
[0m[31m-                        .size(18.0)
[0m[31m-                        .strong()
[0m[31m-                        .color(c.honey_gold));
[0m[32m+                    ui.label(
[0m[32m+                        egui::RichText::new(name)
[0m[32m+                            .size(18.0)
[0m[32m+                            .strong()
[0m[32m+                            .color(c.honey_gold),
[0m[32m+                    );
[0m                     ui.with_layout(egui::Layout::right_to_left(egui::Align::Center), |ui| {
[31m-                        ui.label(egui::RichText::new(format!("FG: {}", fg_range))
[0m[31m-                            .size(16.0)
[0m[31m-                            .color(c.dark_text));
[0m[32m+                        ui.label(
[0m[32m+                            egui::RichText::new(format!("FG: {}", fg_range))
[0m[32m+                                .size(16.0)
[0m[32m+                                .color(c.dark_text),
[0m[32m+                        );
[0m                     });
                 });
                 ui.add_space(8.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:376:
[31m-                ui.label(egui::RichText::new(desc)
[0m[31m-                    .size(14.0)
[0m[31m-                    .color(c.dark_text));
[0m[32m+                ui.label(egui::RichText::new(desc).size(14.0).color(c.dark_text));
[0m             });
         ui.add_space(12.0);
     }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:389:
         .corner_radius(egui::CornerRadius::same(8))
         .inner_margin(15.0)
         .show(ui, |ui| {
[31m-            ui.label(egui::RichText::new("≡ƒôï Recommended FG by Mead Style")
[0m[31m-                .size(18.0)
[0m[31m-                .strong()
[0m[31m-                .color(c.forest_green));
[0m[32m+            ui.label(
[0m[32m+                egui::RichText::new("≡ƒôï Recommended FG by Mead Style")
[0m[32m+                    .size(18.0)
[0m[32m+                    .strong()
[0m[32m+                    .color(c.forest_green),
[0m[32m+            );
[0m             ui.add_space(12.0);
 
             let styles = [
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:399:
[31m-                ("Traditional (Show Mead)", "1.000 - 1.010", "Let honey character shine"),
[0m[31m-                ("Melomel (Fruit Mead)", "1.008 - 1.015", "Balance fruit acidity"),
[0m[31m-                ("Metheglin (Spice Mead)", "1.000 - 1.012", "Prevent overpowering spices"),
[0m[31m-                ("Cyser (Apple Mead)", "1.010 - 1.015", "Complement apple tartness"),
[0m[31m-                ("Bochet (Caramelized)", "1.015 - 1.025", "Match caramel richness"),
[0m[31m-                ("Pyment (Grape Mead)", "0.996 - 1.006", "Wine-like, honey notes"),
[0m[32m+                (
[0m[32m+                    "Traditional (Show Mead)",
[0m[32m+                    "1.000 - 1.010",
[0m[32m+                    "Let honey character shine",
[0m[32m+                ),
[0m[32m+                (
[0m[32m+                    "Melomel (Fruit Mead)",
[0m[32m+                    "1.008 - 1.015",
[0m[32m+                    "Balance fruit acidity",
[0m[32m+                ),
[0m[32m+                (
[0m[32m+                    "Metheglin (Spice Mead)",
[0m[32m+                    "1.000 - 1.012",
[0m[32m+                    "Prevent overpowering spices",
[0m[32m+                ),
[0m[32m+                (
[0m[32m+                    "Cyser (Apple Mead)",
[0m[32m+                    "1.010 - 1.015",
[0m[32m+                    "Complement apple tartness",
[0m[32m+                ),
[0m[32m+                (
[0m[32m+                    "Bochet (Caramelized)",
[0m[32m+                    "1.015 - 1.025",
[0m[32m+                    "Match caramel richness",
[0m[32m+                ),
[0m[32m+                (
[0m[32m+                    "Pyment (Grape Mead)",
[0m[32m+                    "0.996 - 1.006",
[0m[32m+                    "Wine-like, honey notes",
[0m[32m+                ),
[0m                 ("Braggot (Malt)", "1.008 - 1.018", "Balance malt sweetness"),
                 ("Acerglyn (Maple)", "1.010 - 1.020", "Highlight maple notes"),
             ];
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:408:
 
             for (style, target, reason) in styles {
                 ui.horizontal(|ui| {
[31m-                    ui.label(egui::RichText::new("Γû╕")
[0m[31m-                        .size(16.0)
[0m[31m-                        .color(c.honey_gold));
[0m[32m+                    ui.label(egui::RichText::new("Γû╕").size(16.0).color(c.honey_gold));
[0m                     ui.vertical(|ui| {
                         ui.horizontal(|ui| {
[31m-                            ui.label(egui::RichText::new(style)
[0m[31m-                                .size(15.0)
[0m[31m-                                .strong()
[0m[31m-                                .color(c.dark_text));
[0m[31m-                            ui.label(egui::RichText::new(format!("ΓåÆ {}", target))
[0m[31m-                                .size(14.0)
[0m[31m-                                .color(c.forest_green));
[0m[32m+                            ui.label(
[0m[32m+                                egui::RichText::new(style)
[0m[32m+                                    .size(15.0)
[0m[32m+                                    .strong()
[0m[32m+                                    .color(c.dark_text),
[0m[32m+                            );
[0m[32m+                            ui.label(
[0m[32m+                                egui::RichText::new(format!("ΓåÆ {}", target))
[0m[32m+                                    .size(14.0)
[0m[32m+                                    .color(c.forest_green),
[0m[32m+                            );
[0m                         });
[31m-                        ui.label(egui::RichText::new(reason)
[0m[31m-                            .size(13.0)
[0m[31m-                            .color(c.dark_text));
[0m[32m+                        ui.label(egui::RichText::new(reason).size(13.0).color(c.dark_text));
[0m                     });
                 });
                 ui.add_space(8.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\finishing.rs:530:
                 .color(c.sunset_orange));
         });
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:1:
 use crate::MazerionApp;
[31m-use eframe::egui::{self, RichText};
[0m use crate::state::CustomColors;
[32m+use eframe::egui::{self, RichText};
[0m 
 #[derive(Debug, Clone, Copy, PartialEq, Eq)]
 pub enum MeadCalculator {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:30:
 pub fn render(app: &mut MazerionApp, ui: &mut egui::Ui) {
     let c = &app.state.custom_colors;
 
[31m-    ui.heading(RichText::new("≡ƒì» Mead Styles & Calculators")
[0m[31m-        .size(26.0)
[0m[31m-        .color(c.honey_gold));
[0m[32m+    ui.heading(
[0m[32m+        RichText::new("≡ƒì» Mead Styles & Calculators")
[0m[32m+            .size(26.0)
[0m[32m+            .color(c.honey_gold),
[0m[32m+    );
[0m     ui.add_space(10.0);
 
     ui.horizontal(|ui| {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:56:
                 crate::state::MeadCalculator::Encyclopedia => "≡ƒôÜ Encyclopedia",
             })
             .show_ui(ui, |ui| {
[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Encyclopedia, "≡ƒôÜ Encyclopedia");
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Encyclopedia,
[0m[32m+                    "≡ƒôÜ Encyclopedia",
[0m[32m+                );
[0m                 ui.separator();
[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Traditional, "≡ƒì» Traditional");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Melomel, "≡ƒìô Melomel (Fruit)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Cyser, "≡ƒìÄ Cyser (Apple)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Pyment, "≡ƒì╖ Pyment (Grape)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Metheglin, "≡ƒî┐ Metheglin (Spice)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Braggot, "≡ƒì║ Braggot (Malt)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Bochet, "≡ƒöÑ Bochet (Caramel)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Acerglyn, "≡ƒìü Acerglyn (Maple)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Capsicumel, "≡ƒî╢∩╕Å Capsicumel (Pepper)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Rhodomel, "≡ƒî╣ Rhodomel (Rose)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Hippocras, "≡ƒÅ░ Hippocras (Medieval)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Morat, "≡ƒ½É Morat (Mulberry)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::Hydromel, "≡ƒÆº Hydromel (Session)");
[0m[31m-                ui.selectable_value(&mut app.state.mead_calc, crate::state::MeadCalculator::SackMead, "≡ƒì╖ Sack Mead (Dessert)");
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Traditional,
[0m[32m+                    "≡ƒì» Traditional",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Melomel,
[0m[32m+                    "≡ƒìô Melomel (Fruit)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Cyser,
[0m[32m+                    "≡ƒìÄ Cyser (Apple)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Pyment,
[0m[32m+                    "≡ƒì╖ Pyment (Grape)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Metheglin,
[0m[32m+                    "≡ƒî┐ Metheglin (Spice)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Braggot,
[0m[32m+                    "≡ƒì║ Braggot (Malt)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Bochet,
[0m[32m+                    "≡ƒöÑ Bochet (Caramel)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Acerglyn,
[0m[32m+                    "≡ƒìü Acerglyn (Maple)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Capsicumel,
[0m[32m+                    "≡ƒî╢∩╕Å Capsicumel (Pepper)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Rhodomel,
[0m[32m+                    "≡ƒî╣ Rhodomel (Rose)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Hippocras,
[0m[32m+                    "≡ƒÅ░ Hippocras (Medieval)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Morat,
[0m[32m+                    "≡ƒ½É Morat (Mulberry)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::Hydromel,
[0m[32m+                    "≡ƒÆº Hydromel (Session)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.state.mead_calc,
[0m[32m+                    crate::state::MeadCalculator::SackMead,
[0m[32m+                    "≡ƒì╖ Sack Mead (Dessert)",
[0m[32m+                );
[0m             });
     });
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:84:
 }
 
 fn render_calculator_placeholder(_app: &MazerionApp, ui: &mut egui::Ui, c: &CustomColors) {
[31m-    ui.label(RichText::new("Calculator functionality coming soon")
[0m[31m-        .size(16.0)
[0m[31m-        .color(c.dark_text));
[0m[32m+    ui.label(
[0m[32m+        RichText::new("Calculator functionality coming soon")
[0m[32m+            .size(16.0)
[0m[32m+            .color(c.dark_text),
[0m[32m+    );
[0m     ui.label("Use Encyclopedia for complete style information");
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:93:
 fn render_encyclopedia(_app: &MazerionApp, ui: &mut egui::Ui, c: &CustomColors) {
[31m-    ui.heading(RichText::new("≡ƒôÜ Complete Mead Styles Encyclopedia")
[0m[31m-        .size(24.0)
[0m[31m-        .strong()
[0m[31m-        .color(c.honey_gold));
[0m[31m-    ui.label(RichText::new("Sommelier & Chef-Grade Professional Reference")
[0m[31m-        .size(14.0)
[0m[31m-        .color(c.dark_text));
[0m[32m+    ui.heading(
[0m[32m+        RichText::new("≡ƒôÜ Complete Mead Styles Encyclopedia")
[0m[32m+            .size(24.0)
[0m[32m+            .strong()
[0m[32m+            .color(c.honey_gold),
[0m[32m+    );
[0m[32m+    ui.label(
[0m[32m+        RichText::new("Sommelier & Chef-Grade Professional Reference")
[0m[32m+            .size(14.0)
[0m[32m+            .color(c.dark_text),
[0m[32m+    );
[0m     ui.add_space(20.0);
 
     // TRADITIONAL MEADS
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:104:
[31m-    egui::CollapsingHeader::new(RichText::new("≡ƒì» TRADITIONAL MEADS (Show Meads)")
[0m[31m-        .size(20.0)
[0m[31m-        .strong()
[0m[31m-        .color(c.forest_green))
[0m[31m-        .default_open(true)
[0m[31m-        .show(ui, |ui| {
[0m[31m-            render_traditional_mead(ui, c);
[0m[31m-            render_hydromel(ui, c);
[0m[31m-            render_sack_mead(ui, c);
[0m[31m-            render_great_mead(ui, c);
[0m[31m-        });
[0m[32m+    egui::CollapsingHeader::new(
[0m[32m+        RichText::new("≡ƒì» TRADITIONAL MEADS (Show Meads)")
[0m[32m+            .size(20.0)
[0m[32m+            .strong()
[0m[32m+            .color(c.forest_green),
[0m[32m+    )
[0m[32m+    .default_open(true)
[0m[32m+    .show(ui, |ui| {
[0m[32m+        render_traditional_mead(ui, c);
[0m[32m+        render_hydromel(ui, c);
[0m[32m+        render_sack_mead(ui, c);
[0m[32m+        render_great_mead(ui, c);
[0m[32m+    });
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:118:
     // FRUIT MEADS
[31m-    egui::CollapsingHeader::new(RichText::new("≡ƒìô FRUIT MEADS (Melomels)")
[0m[31m-        .size(20.0)
[0m[31m-        .strong()
[0m[31m-        .color(c.forest_green))
[0m[31m-        .default_open(false)
[0m[31m-        .show(ui, |ui| {
[0m[31m-            render_melomel_overview(ui, c);
[0m[31m-            render_berry_melomels(ui, c);
[0m[31m-            render_stone_fruit_melomels(ui, c);
[0m[31m-            render_tropical_melomels(ui, c);
[0m[31m-            render_citrus_melomels(ui, c);
[0m[31m-        });
[0m[32m+    egui::CollapsingHeader::new(
[0m[32m+        RichText::new("≡ƒìô FRUIT MEADS (Melomels)")
[0m[32m+            .size(20.0)
[0m[32m+            .strong()
[0m[32m+            .color(c.forest_green),
[0m[32m+    )
[0m[32m+    .default_open(false)
[0m[32m+    .show(ui, |ui| {
[0m[32m+        render_melomel_overview(ui, c);
[0m[32m+        render_berry_melomels(ui, c);
[0m[32m+        render_stone_fruit_melomels(ui, c);
[0m[32m+        render_tropical_melomels(ui, c);
[0m[32m+        render_citrus_melomels(ui, c);
[0m[32m+    });
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:134:
     // SPECIAL FRUIT MEADS
[31m-    egui::CollapsingHeader::new(RichText::new("≡ƒìÄ SPECIAL FRUIT MEADS")
[0m[31m-        .size(20.0)
[0m[31m-        .strong()
[0m[31m-        .color(c.forest_green))
[0m[31m-        .default_open(false)
[0m[31m-        .show(ui, |ui| {
[0m[31m-            render_cyser(ui, c);
[0m[31m-            render_pyment(ui, c);
[0m[31m-            render_morat(ui, c);
[0m[31m-        });
[0m[32m+    egui::CollapsingHeader::new(
[0m[32m+        RichText::new("≡ƒìÄ SPECIAL FRUIT MEADS")
[0m[32m+            .size(20.0)
[0m[32m+            .strong()
[0m[32m+            .color(c.forest_green),
[0m[32m+    )
[0m[32m+    .default_open(false)
[0m[32m+    .show(ui, |ui| {
[0m[32m+        render_cyser(ui, c);
[0m[32m+        render_pyment(ui, c);
[0m[32m+        render_morat(ui, c);
[0m[32m+    });
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:148:
     // SPICED & HERBAL MEADS
[31m-    egui::CollapsingHeader::new(RichText::new("≡ƒî┐ SPICED & HERBAL MEADS")
[0m[31m-        .size(20.0)
[0m[31m-        .strong()
[0m[31m-        .color(c.forest_green))
[0m[31m-        .default_open(false)
[0m[31m-        .show(ui, |ui| {
[0m[31m-            render_metheglin_overview(ui, c);
[0m[31m-            render_warming_spice_metheglins(ui, c);
[0m[31m-            render_floral_herbal_metheglins(ui, c);
[0m[31m-            render_rhodomel(ui, c);
[0m[31m-            render_hippocras(ui, c);
[0m[31m-        });
[0m[32m+    egui::CollapsingHeader::new(
[0m[32m+        RichText::new("≡ƒî┐ SPICED & HERBAL MEADS")
[0m[32m+            .size(20.0)
[0m[32m+            .strong()
[0m[32m+            .color(c.forest_green),
[0m[32m+    )
[0m[32m+    .default_open(false)
[0m[32m+    .show(ui, |ui| {
[0m[32m+        render_metheglin_overview(ui, c);
[0m[32m+        render_warming_spice_metheglins(ui, c);
[0m[32m+        render_floral_herbal_metheglins(ui, c);
[0m[32m+        render_rhodomel(ui, c);
[0m[32m+        render_hippocras(ui, c);
[0m[32m+    });
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:164:
     // SPECIALTY MEADS
[31m-    egui::CollapsingHeader::new(RichText::new("≡ƒöÑ SPECIALTY & HYBRID MEADS")
[0m[31m-        .size(20.0)
[0m[31m-        .strong()
[0m[31m-        .color(c.forest_green))
[0m[31m-        .default_open(false)
[0m[31m-        .show(ui, |ui| {
[0m[31m-            render_bochet(ui, c);
[0m[31m-            render_braggot(ui, c);
[0m[31m-            render_acerglyn(ui, c);
[0m[31m-            render_capsicumel(ui, c);
[0m[31m-        });
[0m[32m+    egui::CollapsingHeader::new(
[0m[32m+        RichText::new("≡ƒöÑ SPECIALTY & HYBRID MEADS")
[0m[32m+            .size(20.0)
[0m[32m+            .strong()
[0m[32m+            .color(c.forest_green),
[0m[32m+    )
[0m[32m+    .default_open(false)
[0m[32m+    .show(ui, |ui| {
[0m[32m+        render_bochet(ui, c);
[0m[32m+        render_braggot(ui, c);
[0m[32m+        render_acerglyn(ui, c);
[0m[32m+        render_capsicumel(ui, c);
[0m[32m+    });
[0m }
 
 fn render_traditional_mead(ui: &mut egui::Ui, c: &CustomColors) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:1238:
     ui.add_space(10.0);
 
     // Title
[31m-    ui.label(RichText::new(title)
[0m[31m-        .size(18.0)
[0m[31m-        .strong()
[0m[31m-        .color(c.honey_gold));
[0m[32m+    ui.label(RichText::new(title).size(18.0).strong().color(c.honey_gold));
[0m 
     // Specs
[31m-    ui.label(RichText::new(specs)
[0m[31m-        .size(13.0)
[0m[31m-        .color(c.dark_text));
[0m[32m+    ui.label(RichText::new(specs).size(13.0).color(c.dark_text));
[0m     ui.add_space(8.0);
 
     // Overview
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:1253:
[31m-    ui.label(RichText::new(overview)
[0m[31m-        .size(14.0)
[0m[31m-        .color(c.dark_text));
[0m[32m+    ui.label(RichText::new(overview).size(14.0).color(c.dark_text));
[0m     ui.add_space(8.0);
 
     // Tasting Profile
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:1259:
[31m-    ui.label(RichText::new(tasting)
[0m[31m-        .size(13.0)
[0m[31m-        .color(c.dark_text));
[0m[32m+    ui.label(RichText::new(tasting).size(13.0).color(c.dark_text));
[0m     ui.add_space(8.0);
 
     // Serving
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:1265:
[31m-    ui.label(RichText::new(serving)
[0m[31m-        .size(13.0)
[0m[31m-        .color(c.dark_text));
[0m[32m+    ui.label(RichText::new(serving).size(13.0).color(c.dark_text));
[0m     ui.add_space(8.0);
 
     // Pairings
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:1271:
[31m-    ui.label(RichText::new("FOOD PAIRINGS:")
[0m[31m-        .size(14.0)
[0m[31m-        .strong()
[0m[31m-        .color(c.forest_green));
[0m[31m-    ui.label(RichText::new(pairings)
[0m[31m-        .size(13.0)
[0m[31m-        .color(c.dark_text));
[0m[32m+    ui.label(
[0m[32m+        RichText::new("FOOD PAIRINGS:")
[0m[32m+            .size(14.0)
[0m[32m+            .strong()
[0m[32m+            .color(c.forest_green),
[0m[32m+    );
[0m[32m+    ui.label(RichText::new(pairings).size(13.0).color(c.dark_text));
[0m     ui.add_space(8.0);
 
     // Principles
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:1281:
[31m-    ui.label(RichText::new(principles)
[0m[31m-        .size(13.0)
[0m[31m-        .color(c.dark_text));
[0m[32m+    ui.label(RichText::new(principles).size(13.0).color(c.dark_text));
[0m     ui.add_space(8.0);
 
     // Professional
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:1287:
[31m-    ui.label(RichText::new(professional)
[0m[31m-        .size(13.0)
[0m[31m-        .color(c.dark_text));
[0m[32m+    ui.label(RichText::new(professional).size(13.0).color(c.dark_text));
[0m 
     ui.add_space(15.0);
 }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:1302:
     notes: &str,
 ) {
     ui.add_space(5.0);
[31m-    ui.label(RichText::new(format!("ΓÇó {}", name))
[0m[31m-        .size(15.0)
[0m[31m-        .strong()
[0m[31m-        .color(c.saddle_brown));
[0m[32m+    ui.label(
[0m[32m+        RichText::new(format!("ΓÇó {}", name))
[0m[32m+            .size(15.0)
[0m[32m+            .strong()
[0m[32m+            .color(c.saddle_brown),
[0m[32m+    );
[0m     ui.label(RichText::new(tasting).size(13.0).color(c.dark_text));
     ui.label(RichText::new(comparable).size(12.0).color(c.dark_text));
     ui.add_space(3.0);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\meads.rs:1312:
     ui.label(RichText::new(pairings).size(12.0).color(c.dark_text));
     ui.add_space(3.0);
[31m-    ui.label(RichText::new(format!("NOTES: {}", notes)).size(12.0).color(c.dark_text));
[0m[32m+    ui.label(
[0m[32m+        RichText::new(format!("NOTES: {}", notes))
[0m[32m+            .size(12.0)
[0m[32m+            .color(c.dark_text),
[0m[32m+    );
[0m     ui.add_space(8.0);
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\mod.rs:1:
[31m-pub mod basic;
[0m pub mod advanced;
[31m-pub mod brewing;
[0m[32m+pub mod basic;
[0m pub mod beer;
[32m+pub mod brewing;
[0m pub mod finishing;
 pub mod meads;
[31m-pub mod utilities;
[0m pub mod settings;
[32m+pub mod utilities;
[0m[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\settings.rs:3:
 
 use crate::MazerionApp;
 use crate::state::{Theme, UnitSystem};
[31m-use eframe::egui::{self, RichText, CornerRadius};
[0m[32m+use eframe::egui::{self, CornerRadius, RichText};
[0m 
 pub fn render(app: &mut MazerionApp, ui: &mut egui::Ui) {
     egui::Frame::default()
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\settings.rs:20:
                 egui::ComboBox::from_id_salt("theme")
                     .selected_text(app.state.theme.name())
                     .show_ui(ui, |ui| {
[31m-                        ui.selectable_value(&mut app.state.theme, Theme::HoneyGold, "≡ƒì» Honey & Gold");
[0m[31m-                        ui.selectable_value(&mut app.state.theme, Theme::ForestGreen, "≡ƒî▓ Forest Green");
[0m[31m-                        ui.selectable_value(&mut app.state.theme, Theme::OceanBlue, "≡ƒîè Ocean Blue");
[0m[31m-                        ui.selectable_value(&mut app.state.theme, Theme::SunsetOrange, "≡ƒîà Sunset Orange");
[0m[31m-                        ui.selectable_value(&mut app.state.theme, Theme::LavenderPurple, "≡ƒÆ£ Lavender Purple");
[0m[32m+                        ui.selectable_value(
[0m[32m+                            &mut app.state.theme,
[0m[32m+                            Theme::HoneyGold,
[0m[32m+                            "≡ƒì» Honey & Gold",
[0m[32m+                        );
[0m[32m+                        ui.selectable_value(
[0m[32m+                            &mut app.state.theme,
[0m[32m+                            Theme::ForestGreen,
[0m[32m+                            "≡ƒî▓ Forest Green",
[0m[32m+                        );
[0m[32m+                        ui.selectable_value(
[0m[32m+                            &mut app.state.theme,
[0m[32m+                            Theme::OceanBlue,
[0m[32m+                            "≡ƒîè Ocean Blue",
[0m[32m+                        );
[0m[32m+                        ui.selectable_value(
[0m[32m+                            &mut app.state.theme,
[0m[32m+                            Theme::SunsetOrange,
[0m[32m+                            "≡ƒîà Sunset Orange",
[0m[32m+                        );
[0m[32m+                        ui.selectable_value(
[0m[32m+                            &mut app.state.theme,
[0m[32m+                            Theme::LavenderPurple,
[0m[32m+                            "≡ƒÆ£ Lavender Purple",
[0m[32m+                        );
[0m                     });
             });
             app.state.custom_colors = app.state.get_theme_colors();
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\settings.rs:36:
                 egui::ComboBox::from_id_salt("units")
                     .selected_text(app.state.unit_system.name())
                     .show_ui(ui, |ui| {
[31m-                        ui.selectable_value(&mut app.state.unit_system, UnitSystem::Metric, "Metric");
[0m[31m-                        ui.selectable_value(&mut app.state.unit_system, UnitSystem::Imperial, "Imperial/US");
[0m[32m+                        ui.selectable_value(
[0m[32m+                            &mut app.state.unit_system,
[0m[32m+                            UnitSystem::Metric,
[0m[32m+                            "Metric",
[0m[32m+                        );
[0m[32m+                        ui.selectable_value(
[0m[32m+                            &mut app.state.unit_system,
[0m[32m+                            UnitSystem::Imperial,
[0m[32m+                            "Imperial/US",
[0m[32m+                        );
[0m                     });
             });
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\settings.rs:81:
             });
         });
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:1:
 //! Utility Calculators
 
[31m-use crate::state::UnitSystem;
[0m use crate::MazerionApp;
[32m+use crate::state::UnitSystem;
[0m use eframe::egui;
 use rust_decimal::Decimal;
 use std::str::FromStr;
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:32:
                 UtilityCalculator::BottlesWithLosses => "≡ƒì╛ Bottles (with Losses)",
             })
             .show_ui(ui, |ui| {
[31m-                ui.selectable_value(&mut app.utility_calc, UtilityCalculator::BenchTrials, "≡ƒº¬ Bench Trials");
[0m[31m-                ui.selectable_value(&mut app.utility_calc, UtilityCalculator::RecipeUpscaling, "≡ƒôê Recipe Upscaling");
[0m[31m-                ui.selectable_value(&mut app.utility_calc, UtilityCalculator::BottlesWithLosses, "≡ƒì╛ Bottles (with Losses)");
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.utility_calc,
[0m[32m+                    UtilityCalculator::BenchTrials,
[0m[32m+                    "≡ƒº¬ Bench Trials",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.utility_calc,
[0m[32m+                    UtilityCalculator::RecipeUpscaling,
[0m[32m+                    "≡ƒôê Recipe Upscaling",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.utility_calc,
[0m[32m+                    UtilityCalculator::BottlesWithLosses,
[0m[32m+                    "≡ƒì╛ Bottles (with Losses)",
[0m[32m+                );
[0m             });
     });
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:54:
     let is_metric = app.state.unit_system == UnitSystem::Metric;
     let vol_unit = if is_metric { "L" } else { "gal" };
 
[31m-    crate::input_field(ui, &format!("Original Size ({}):", vol_unit), &mut app.original_recipe_size, "Original batch size");
[0m[31m-    crate::input_field(ui, &format!("Target Size ({}):", vol_unit), &mut app.target_batch_size, "Desired batch size");
[0m[31m-    crate::input_field(ui, "Original Amount:", &mut app.original_amount, "Amount of ingredient in original recipe");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Original Size ({}):", vol_unit),
[0m[32m+        &mut app.original_recipe_size,
[0m[32m+        "Original batch size",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Target Size ({}):", vol_unit),
[0m[32m+        &mut app.target_batch_size,
[0m[32m+        "Desired batch size",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Original Amount:",
[0m[32m+        &mut app.original_amount,
[0m[32m+        "Amount of ingredient in original recipe",
[0m[32m+    );
[0m 
     ui.horizontal(|ui| {
         ui.label("Unit:");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:102:
             }
         };
 
[31m-        if original_size <= Decimal::ZERO || target_size <= Decimal::ZERO || original_amount < Decimal::ZERO {
[0m[32m+        if original_size <= Decimal::ZERO
[0m[32m+            || target_size <= Decimal::ZERO
[0m[32m+            || original_amount < Decimal::ZERO
[0m[32m+        {
[0m             app.result = Some("Error: Values must be positive".to_string());
             return;
         }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:112:
 
         app.result = Some(format!("{:.2} {}", scaled_amount, app.upscale_unit));
 
[31m-        app.metadata.push(("Scaling Factor".to_string(), format!("{}x", scaling_factor.round_dp(2))));
[0m[31m-        app.metadata.push(("Original".to_string(), format!("{:.2} {} in {} {}", original_amount, app.upscale_unit, original_size, vol_unit)));
[0m[31m-        app.metadata.push(("Scaled".to_string(), format!("{:.2} {} in {} {}", scaled_amount, app.upscale_unit, target_size, vol_unit)));
[0m[32m+        app.metadata.push((
[0m[32m+            "Scaling Factor".to_string(),
[0m[32m+            format!("{}x", scaling_factor.round_dp(2)),
[0m[32m+        ));
[0m[32m+        app.metadata.push((
[0m[32m+            "Original".to_string(),
[0m[32m+            format!(
[0m[32m+                "{:.2} {} in {} {}",
[0m[32m+                original_amount, app.upscale_unit, original_size, vol_unit
[0m[32m+            ),
[0m[32m+        ));
[0m[32m+        app.metadata.push((
[0m[32m+            "Scaled".to_string(),
[0m[32m+            format!(
[0m[32m+                "{:.2} {} in {} {}",
[0m[32m+                scaled_amount, app.upscale_unit, target_size, vol_unit
[0m[32m+            ),
[0m[32m+        ));
[0m     }
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:125:
     let is_metric = app.state.unit_system == UnitSystem::Metric;
     let vol_unit = if is_metric { "L" } else { "gal" };
 
[31m-    crate::input_field(ui, &format!("Trial Volume ({}):", vol_unit), &mut app.trial_volume, "Small test batch volume");
[0m[31m-    crate::input_field(ui, "Addition Amount:", &mut app.trial_addition, "Amount added in trial");
[0m[31m-    crate::input_field(ui, &format!("Target Batch ({}):", vol_unit), &mut app.batch_volume_bench, "Full batch size");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Trial Volume ({}):", vol_unit),
[0m[32m+        &mut app.trial_volume,
[0m[32m+        "Small test batch volume",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Addition Amount:",
[0m[32m+        &mut app.trial_addition,
[0m[32m+        "Amount added in trial",
[0m[32m+    );
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Target Batch ({}):", vol_unit),
[0m[32m+        &mut app.batch_volume_bench,
[0m[32m+        "Full batch size",
[0m[32m+    );
[0m 
     ui.add_space(10.0);
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:167:
         let scaled_addition = addition * (batch_vol / trial_vol);
 
         app.result = Some(format!("{:.2} g", scaled_addition));
[31m-        app.metadata.push(("Trial".to_string(), format!("{:.2} g in {} {}", addition, trial_vol, vol_unit)));
[0m[31m-        app.metadata.push(("Full Batch".to_string(), format!("{:.2} g in {} {}", scaled_addition, batch_vol, vol_unit)));
[0m[32m+        app.metadata.push((
[0m[32m+            "Trial".to_string(),
[0m[32m+            format!("{:.2} g in {} {}", addition, trial_vol, vol_unit),
[0m[32m+        ));
[0m[32m+        app.metadata.push((
[0m[32m+            "Full Batch".to_string(),
[0m[32m+            format!("{:.2} g in {} {}", scaled_addition, batch_vol, vol_unit),
[0m[32m+        ));
[0m     }
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:179:
     let is_metric = app.state.unit_system == UnitSystem::Metric;
     let vol_unit = if is_metric { "L" } else { "gal" };
 
[31m-    crate::input_field(ui, &format!("Initial Volume ({}):", vol_unit), &mut app.waste_initial_volume, "Starting volume");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        &format!("Initial Volume ({}):", vol_unit),
[0m[32m+        &mut app.waste_initial_volume,
[0m[32m+        "Starting volume",
[0m[32m+    );
[0m 
     ui.horizontal(|ui| {
         ui.label("Vessel:");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:191:
                 _ => "Carboy",
             })
             .show_ui(ui, |ui| {
[31m-                ui.selectable_value(&mut app.waste_vessel_type, "carboy".to_string(), "Carboy (standard)");
[0m[31m-                ui.selectable_value(&mut app.waste_vessel_type, "bucket".to_string(), "Bucket (wider)");
[0m[31m-                ui.selectable_value(&mut app.waste_vessel_type, "keg".to_string(), "Keg (minimal)");
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.waste_vessel_type,
[0m[32m+                    "carboy".to_string(),
[0m[32m+                    "Carboy (standard)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.waste_vessel_type,
[0m[32m+                    "bucket".to_string(),
[0m[32m+                    "Bucket (wider)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.waste_vessel_type,
[0m[32m+                    "keg".to_string(),
[0m[32m+                    "Keg (minimal)",
[0m[32m+                );
[0m             });
     });
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:200:
[31m-    crate::input_field(ui, "Number of Rackings:", &mut app.waste_num_rackings, "Number of times racked");
[0m[32m+    crate::input_field(
[0m[32m+        ui,
[0m[32m+        "Number of Rackings:",
[0m[32m+        &mut app.waste_num_rackings,
[0m[32m+        "Number of times racked",
[0m[32m+    );
[0m 
     ui.horizontal(|ui| {
         ui.label("Process:");
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:209:
                 _ => "Standard",
             })
             .show_ui(ui, |ui| {
[31m-                ui.selectable_value(&mut app.waste_process_type, "standard".to_string(), "Standard (normal)");
[0m[31m-                ui.selectable_value(&mut app.waste_process_type, "careful".to_string(), "Careful (minimal loss)");
[0m[31m-                ui.selectable_value(&mut app.waste_process_type, "fruit".to_string(), "With Fruit (high loss)");
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.waste_process_type,
[0m[32m+                    "standard".to_string(),
[0m[32m+                    "Standard (normal)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.waste_process_type,
[0m[32m+                    "careful".to_string(),
[0m[32m+                    "Careful (minimal loss)",
[0m[32m+                );
[0m[32m+                ui.selectable_value(
[0m[32m+                    &mut app.waste_process_type,
[0m[32m+                    "fruit".to_string(),
[0m[32m+                    "With Fruit (high loss)",
[0m[32m+                );
[0m             });
     });
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:242:
             return;
         }
 
[31m-        let base_loss = match (app.waste_vessel_type.as_str(), app.waste_process_type.as_str()) {
[0m[32m+        let base_loss = match (
[0m[32m+            app.waste_vessel_type.as_str(),
[0m[32m+            app.waste_process_type.as_str(),
[0m[32m+        ) {
[0m             ("carboy", "careful") => Decimal::new(3, 2),
             ("carboy", "standard") => Decimal::new(5, 2),
             ("carboy", "fruit") => Decimal::new(10, 2),
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:280:
             format!("{:.2} gal", remaining_volume)
         };
 
[31m-        app.metadata.push(("Initial Volume".to_string(), format!("{:.2} {}", initial_vol, vol_unit)));
[0m[32m+        app.metadata.push((
[0m[32m+            "Initial Volume".to_string(),
[0m[32m+            format!("{:.2} {}", initial_vol, vol_unit),
[0m[32m+        ));
[0m         app.metadata.push(("Final Volume".to_string(), vol_label));
[31m-        app.metadata.push(("Total Loss".to_string(), format!("{:.2} gal ({:.1}%)", initial_vol - remaining_volume, total_loss)));
[0m[31m-        app.metadata.push(("Loss Per Racking".to_string(), format!("~{:.1}%", base_loss * Decimal::from(100))));
[0m[32m+        app.metadata.push((
[0m[32m+            "Total Loss".to_string(),
[0m[32m+            format!(
[0m[32m+                "{:.2} gal ({:.1}%)",
[0m[32m+                initial_vol - remaining_volume,
[0m[32m+                total_loss
[0m[32m+            ),
[0m[32m+        ));
[0m[32m+        app.metadata.push((
[0m[32m+            "Loss Per Racking".to_string(),
[0m[32m+            format!("~{:.1}%", base_loss * Decimal::from(100)),
[0m[32m+        ));
[0m 
         if total_loss > Decimal::from(25) {
[31m-            app.warnings.push("ΓÜá∩╕Å High total loss - consider reducing rackings or using conical fermenter".to_string());
[0m[32m+            app.warnings.push(
[0m[32m+                "ΓÜá∩╕Å High total loss - consider reducing rackings or using conical fermenter"
[0m[32m+                    .to_string(),
[0m[32m+            );
[0m         }
     }
 }
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\gui\src\tabs\utilities.rs:293:
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\tui\src\lib.rs:1:
 //! Production TUI with MCL organization
 
[31m-use crossterm::{event::{self, Event, KeyCode}, execute,
[0m[31m-                terminal::{disable_raw_mode, enable_raw_mode, EnterAlternateScreen, LeaveAlternateScreen}};
[0m[31m-use ratatui::{backend::CrosstermBackend, layout::{Constraint, Direction, Layout},
[0m[31m-              style::{Color, Modifier, Style}, text::{Line, Span},
[0m[31m-              widgets::{Block, Borders, List, ListItem, Paragraph}, Terminal};
[0m[32m+use crossterm::{
[0m[32m+    event::{self, Event, KeyCode},
[0m[32m+    execute,
[0m[32m+    terminal::{EnterAlternateScreen, LeaveAlternateScreen, disable_raw_mode, enable_raw_mode},
[0m[32m+};
[0m[32m+use mazerion_core::{VALID_CATEGORIES, get_calculators_by_category};
[0m[32m+use ratatui::{
[0m[32m+    Terminal,
[0m[32m+    backend::CrosstermBackend,
[0m[32m+    layout::{Constraint, Direction, Layout},
[0m[32m+    style::{Color, Modifier, Style},
[0m[32m+    text::{Line, Span},
[0m[32m+    widgets::{Block, Borders, List, ListItem, Paragraph},
[0m[32m+};
[0m use std::io;
[31m-use mazerion_core::{get_calculators_by_category, VALID_CATEGORIES};
[0m 
 pub fn run() -> io::Result<()> {
     if let Err(e) = mazerion_calculators::init() {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\tui\src\lib.rs:33:
 impl AppState {
     fn new() -> Self {
         let by_category = get_calculators_by_category();
[31m-        let categories: Vec<String> = VALID_CATEGORIES.iter()
[0m[32m+        let categories: Vec<String> = VALID_CATEGORIES
[0m[32m+            .iter()
[0m             .filter(|cat| by_category.contains_key(*cat as &str))
[31m-            .map(|s| s.to_string()).collect();
[0m[31m-        Self { current_category_index: 0, selected_calc_index: 0, categories }
[0m[32m+            .map(|s| s.to_string())
[0m[32m+            .collect();
[0m[32m+        Self {
[0m[32m+            current_category_index: 0,
[0m[32m+            selected_calc_index: 0,
[0m[32m+            categories,
[0m[32m+        }
[0m     }
[31m-    fn current_category(&self) -> &str { &self.categories[self.current_category_index] }
[0m[32m+    fn current_category(&self) -> &str {
[0m[32m+        &self.categories[self.current_category_index]
[0m[32m+    }
[0m     fn next_category(&mut self) {
         if self.current_category_index < self.categories.len() - 1 {
[31m-            self.current_category_index += 1; self.selected_calc_index = 0;
[0m[32m+            self.current_category_index += 1;
[0m[32m+            self.selected_calc_index = 0;
[0m         }
     }
     fn prev_category(&mut self) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\tui\src\lib.rs:48:
         if self.current_category_index > 0 {
[31m-            self.current_category_index -= 1; self.selected_calc_index = 0;
[0m[32m+            self.current_category_index -= 1;
[0m[32m+            self.selected_calc_index = 0;
[0m         }
     }
     fn next_calculator(&mut self, max: usize) {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\tui\src\lib.rs:53:
[31m-        if self.selected_calc_index < max - 1 { self.selected_calc_index += 1; }
[0m[32m+        if self.selected_calc_index < max - 1 {
[0m[32m+            self.selected_calc_index += 1;
[0m[32m+        }
[0m     }
     fn prev_calculator(&mut self) {
[31m-        if self.selected_calc_index > 0 { self.selected_calc_index -= 1; }
[0m[32m+        if self.selected_calc_index > 0 {
[0m[32m+            self.selected_calc_index -= 1;
[0m[32m+        }
[0m     }
 }
 
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\tui\src\lib.rs:60:
 fn run_app<B: ratatui::backend::Backend>(terminal: &mut Terminal<B>) -> io::Result<()>
[31m-where io::Error: From<<B as ratatui::backend::Backend>::Error> {
[0m[32m+where
[0m[32m+    io::Error: From<<B as ratatui::backend::Backend>::Error>,
[0m[32m+{
[0m     let mut state = AppState::new();
     let by_category = get_calculators_by_category();
     loop {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\tui\src\lib.rs:65:
         terminal.draw(|f| {
[31m-            let chunks = Layout::default().direction(Direction::Vertical)
[0m[31m-                .constraints([Constraint::Length(3), Constraint::Length(3),
[0m[31m-                    Constraint::Min(0), Constraint::Length(4)])
[0m[32m+            let chunks = Layout::default()
[0m[32m+                .direction(Direction::Vertical)
[0m[32m+                .constraints([
[0m[32m+                    Constraint::Length(3),
[0m[32m+                    Constraint::Length(3),
[0m[32m+                    Constraint::Min(0),
[0m[32m+                    Constraint::Length(4),
[0m[32m+                ])
[0m                 .split(f.area());
             let title = Paragraph::new("≡ƒì» Mazerion MCL")
                 .block(Block::default().borders(Borders::ALL))
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\tui\src\lib.rs:72:
                 .style(Style::default().fg(Color::Cyan));
             f.render_widget(title, chunks[0]);
[31m-            let category_tabs: Vec<Span> = state.categories.iter().enumerate()
[0m[32m+            let category_tabs: Vec<Span> = state
[0m[32m+                .categories
[0m[32m+                .iter()
[0m[32m+                .enumerate()
[0m                 .map(|(i, cat)| {
                     let count = by_category.get(cat.as_str()).map(|v| v.len()).unwrap_or(0);
                     let text = format!(" {} ({}) ", cat, count);
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\tui\src\lib.rs:78:
                     if i == state.current_category_index {
                         Span::styled(text, Style::default().bg(Color::Blue).fg(Color::White))
[31m-                    } else { Span::styled(text, Style::default().fg(Color::Gray)) }
[0m[31m-                }).collect();
[0m[31m-            let tabs = Paragraph::new(Line::from(category_tabs))
[0m[31m-                .block(Block::default().borders(Borders::ALL).title("Categories [ΓåÉ/ΓåÆ]"));
[0m[32m+                    } else {
[0m[32m+                        Span::styled(text, Style::default().fg(Color::Gray))
[0m[32m+                    }
[0m[32m+                })
[0m[32m+                .collect();
[0m[32m+            let tabs = Paragraph::new(Line::from(category_tabs)).block(
[0m[32m+                Block::default()
[0m[32m+                    .borders(Borders::ALL)
[0m[32m+                    .title("Categories [ΓåÉ/ΓåÆ]"),
[0m[32m+            );
[0m             f.render_widget(tabs, chunks[1]);
             let current_category = state.current_category();
[31m-            let calcs = by_category.get(current_category).map(|v| v.as_slice()).unwrap_or(&[]);
[0m[31m-            let items: Vec<ListItem> = calcs.iter().enumerate().map(|(i, calc)| {
[0m[31m-                let style = if i == state.selected_calc_index {
[0m[31m-                    Style::default().bg(Color::Blue).fg(Color::White).add_modifier(Modifier::BOLD)
[0m[31m-                } else { Style::default() };
[0m[31m-                ListItem::new(vec![
[0m[31m-                    Line::from(vec![Span::styled("≡ƒö╣ ", Style::default().fg(Color::Yellow)),
[0m[31m-                                    Span::styled(calc.name(), style.add_modifier(Modifier::BOLD))]),
[0m[31m-                    Line::from(vec![Span::raw("   "),
[0m[31m-                                    Span::styled(calc.description(), Style::default().fg(Color::Gray))]),
[0m[31m-                    Line::from(vec![Span::raw("   ID: "),
[0m[31m-                                    Span::styled(calc.id(), Style::default().fg(Color::Cyan))]),
[0m[31m-                ]).style(style)
[0m[31m-            }).collect();
[0m[31m-            let list = List::new(items)
[0m[31m-                .block(Block::default()
[0m[32m+            let calcs = by_category
[0m[32m+                .get(current_category)
[0m[32m+                .map(|v| v.as_slice())
[0m[32m+                .unwrap_or(&[]);
[0m[32m+            let items: Vec<ListItem> = calcs
[0m[32m+                .iter()
[0m[32m+                .enumerate()
[0m[32m+                .map(|(i, calc)| {
[0m[32m+                    let style = if i == state.selected_calc_index {
[0m[32m+                        Style::default()
[0m[32m+                            .bg(Color::Blue)
[0m[32m+                            .fg(Color::White)
[0m[32m+                            .add_modifier(Modifier::BOLD)
[0m[32m+                    } else {
[0m[32m+                        Style::default()
[0m[32m+                    };
[0m[32m+                    ListItem::new(vec![
[0m[32m+                        Line::from(vec![
[0m[32m+                            Span::styled("≡ƒö╣ ", Style::default().fg(Color::Yellow)),
[0m[32m+                            Span::styled(calc.name(), style.add_modifier(Modifier::BOLD)),
[0m[32m+                        ]),
[0m[32m+                        Line::from(vec![
[0m[32m+                            Span::raw("   "),
[0m[32m+                            Span::styled(calc.description(), Style::default().fg(Color::Gray)),
[0m[32m+                        ]),
[0m[32m+                        Line::from(vec![
[0m[32m+                            Span::raw("   ID: "),
[0m[32m+                            Span::styled(calc.id(), Style::default().fg(Color::Cyan)),
[0m[32m+                        ]),
[0m[32m+                    ])
[0m[32m+                    .style(style)
[0m[32m+                })
[0m[32m+                .collect();
[0m[32m+            let list = List::new(items).block(
[0m[32m+                Block::default()
[0m                     .title(format!("Calculators in {} [Γåæ/Γåô]", current_category))
[31m-                    .borders(Borders::ALL));
[0m[32m+                    .borders(Borders::ALL),
[0m[32m+            );
[0m             f.render_widget(list, chunks[2]);
             let help = Paragraph::new(vec![Line::from(vec![
[31m-                Span::styled("ΓåÉ/ΓåÆ", Style::default().fg(Color::Cyan).add_modifier(Modifier::BOLD)),
[0m[32m+                Span::styled(
[0m[32m+                    "ΓåÉ/ΓåÆ",
[0m[32m+                    Style::default()
[0m[32m+                        .fg(Color::Cyan)
[0m[32m+                        .add_modifier(Modifier::BOLD),
[0m[32m+                ),
[0m                 Span::raw(": Category  "),
[31m-                Span::styled("Γåæ/Γåô", Style::default().fg(Color::Cyan).add_modifier(Modifier::BOLD)),
[0m[32m+                Span::styled(
[0m[32m+                    "Γåæ/Γåô",
[0m[32m+                    Style::default()
[0m[32m+                        .fg(Color::Cyan)
[0m[32m+                        .add_modifier(Modifier::BOLD),
[0m[32m+                ),
[0m                 Span::raw(": Select  "),
[31m-                Span::styled("q", Style::default().fg(Color::Cyan).add_modifier(Modifier::BOLD)),
[0m[32m+                Span::styled(
[0m[32m+                    "q",
[0m[32m+                    Style::default()
[0m[32m+                        .fg(Color::Cyan)
[0m[32m+                        .add_modifier(Modifier::BOLD),
[0m[32m+                ),
[0m                 Span::raw(": Quit"),
[31m-            ])]).block(Block::default().borders(Borders::ALL));
[0m[32m+            ])])
[0m[32m+            .block(Block::default().borders(Borders::ALL));
[0m             f.render_widget(help, chunks[3]);
         })?;
         if let Event::Key(key) = event::read()? {
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\tui\src\lib.rs:119:
                 KeyCode::Right => state.next_category(),
                 KeyCode::Up => state.prev_calculator(),
                 KeyCode::Down => {
[31m-                    let max = by_category.get(state.current_category())
[0m[31m-                        .map(|v| v.len()).unwrap_or(0);
[0m[32m+                    let max = by_category
[0m[32m+                        .get(state.current_category())
[0m[32m+                        .map(|v| v.len())
[0m[32m+                        .unwrap_or(0);
[0m                     state.next_calculator(max);
                 }
                 _ => {}
Diff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\crates\tui\src\lib.rs:128:
         }
     }
 }
[32m+
[0mDiff in \\?\C:\Users\DrTom\RustroverProjects\Mazerion\tools\line-guard\src\main.rs:51:
     let args: Vec<String> = env::args().collect();
     let root = args.get(1).map(String::as_str).unwrap_or(".");
 
[31m-    println!("≡ƒöì Checking Rust files in {} (max {} lines per file)", root, MAX_LINES);
[0m[32m+    println!(
[0m[32m+        "≡ƒöì Checking Rust files in {} (max {} lines per file)",
[0m[32m+        root, MAX_LINES
[0m[32m+    );
[0m 
     let results = walk_dir(Path::new(root), "rs");
 

